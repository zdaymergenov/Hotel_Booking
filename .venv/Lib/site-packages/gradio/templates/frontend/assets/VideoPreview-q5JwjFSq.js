import{z as fe,a as Ze,x as vt,A as Tt,G as Vt,j as St,H as Dt,B as qt,V as pt,u as Rt,E as Lt,I as Ct,D as Mt,S as Pt,b as At}from"./FullscreenButton-BoNylw4k.js";import"./init-CYs0NWnS.js";import{b as Bt,t as It,V as Ht}from"./Video-NpeJCQXG.js";import{M as Nt}from"./ModifyUpload-C1BBLG7J.js";import{p as Xt}from"./index-sqki5BVz.js";const{SvelteComponent:zt,append:se,attr:B,destroy_block:Ut,detach:Ie,element:re,ensure_array_like:et,flush:pe,init:jt,insert:He,listen:ue,noop:Ke,run_all:Ft,safe_not_equal:Ot,set_style:Z,space:We,src_url_equal:tt,update_keyed_each:$t}=window.__gradio__svelte__internal,{onMount:nt,onDestroy:Wt}=window.__gradio__svelte__internal;function lt(l,e,n){const t=l.slice();return t[20]=e[n],t[22]=n,t}function Gt(l){let e,n,t,i,o,r=[],a=new Map,f,g,_,u,d=et(l[1]);const c=w=>w[22];for(let w=0;w<d.length;w+=1){let v=lt(l,d,w),k=c(v);a.set(k,r[w]=it(k,v))}return{c(){e=re("div"),n=re("button"),t=We(),i=re("div"),o=We();for(let w=0;w<r.length;w+=1)r[w].c();f=We(),g=re("button"),B(n,"aria-label","start drag handle for trimming video"),B(n,"class","handle left svelte-10c4beq"),Z(n,"left",l[2]+"%"),B(i,"class","opaque-layer svelte-10c4beq"),Z(i,"left",l[2]+"%"),Z(i,"right",100-l[3]+"%"),B(g,"aria-label","end drag handle for trimming video"),B(g,"class","handle right svelte-10c4beq"),Z(g,"left",l[3]+"%"),B(e,"id","timeline"),B(e,"class","thumbnail-wrapper svelte-10c4beq")},m(w,v){He(w,e,v),se(e,n),se(e,t),se(e,i),se(e,o);for(let k=0;k<r.length;k+=1)r[k]&&r[k].m(e,null);se(e,f),se(e,g),_||(u=[ue(n,"mousedown",l[10]),ue(n,"blur",l[5]),ue(n,"keydown",l[11]),ue(g,"mousedown",l[12]),ue(g,"blur",l[5]),ue(g,"keydown",l[13])],_=!0)},p(w,v){v&4&&Z(n,"left",w[2]+"%"),v&4&&Z(i,"left",w[2]+"%"),v&8&&Z(i,"right",100-w[3]+"%"),v&2&&(d=et(w[1]),r=$t(r,v,c,1,w,d,a,e,Ut,it,f,lt)),v&8&&Z(g,"left",w[3]+"%")},d(w){w&&Ie(e);for(let v=0;v<r.length;v+=1)r[v].d();_=!1,Ft(u)}}}function Jt(l){let e;return{c(){e=re("div"),e.innerHTML='<span aria-label="loading timeline" class="loader svelte-10c4beq"></span>',B(e,"class","load-wrap svelte-10c4beq")},m(n,t){He(n,e,t)},p:Ke,d(n){n&&Ie(e)}}}function it(l,e){let n,t,i;return{key:l,first:null,c(){n=re("img"),tt(n.src,t=e[20])||B(n,"src",t),B(n,"alt",i=`frame-${e[22]}`),B(n,"draggable","false"),B(n,"class","svelte-10c4beq"),this.first=n},m(o,r){He(o,n,r)},p(o,r){e=o,r&2&&!tt(n.src,t=e[20])&&B(n,"src",t),r&2&&i!==(i=`frame-${e[22]}`)&&B(n,"alt",i)},d(o){o&&Ie(n)}}}function Kt(l){let e;function n(o,r){return o[0]?Jt:Gt}let t=n(l),i=t(l);return{c(){e=re("div"),i.c(),B(e,"class","container svelte-10c4beq")},m(o,r){He(o,e,r),i.m(e,null)},p(o,[r]){t===(t=n(o))&&i?i.p(o,r):(i.d(1),i=t(o),i&&(i.c(),i.m(e,null)))},i:Ke,o:Ke,d(o){o&&Ie(e),i.d()}}}let Ge=10;function Qt(l,e,n){let{videoElement:t}=e,{trimmedDuration:i}=e,{dragStart:o}=e,{dragEnd:r}=e,{loadingTimeline:a}=e,f=[],g,_=0,u=100,d=null;const c=h=>{d=h},w=()=>{d=null},v=(h,T)=>{if(d){const y=document.getElementById("timeline");if(!y)return;const m=y.getBoundingClientRect();let S=(h.clientX-m.left)/m.width*100;if(T?S=d==="left"?_+T:u+T:S=(h.clientX-m.left)/m.width*100,S=Math.max(0,Math.min(S,100)),d==="left"){n(2,_=Math.min(S,u));const C=_/100*g;n(6,t.currentTime=C,t),n(8,o=C)}else if(d==="right"){n(3,u=Math.max(S,_));const C=u/100*g;n(6,t.currentTime=C,t),n(9,r=C)}const G=_/100*g,p=u/100*g;n(7,i=p-G),n(2,_),n(3,u)}},k=h=>{if(d){const T=1/g*100;h.key==="ArrowLeft"?v({clientX:0},-T):h.key==="ArrowRight"&&v({clientX:0},T)}},P=()=>{const h=document.createElement("canvas"),T=h.getContext("2d");if(!T)return;h.width=t.videoWidth,h.height=t.videoHeight,T.drawImage(t,0,0,h.width,h.height);const y=h.toDataURL("image/jpeg",.7);n(1,f=[...f,y])};nt(()=>{const h=()=>{g=t.duration;const T=g/Ge;let y=0;const m=()=>{P(),y++,y<Ge?n(6,t.currentTime+=T,t):t.removeEventListener("seeked",m)};t.addEventListener("seeked",m),n(6,t.currentTime=0,t)};t.readyState>=1?h():t.addEventListener("loadedmetadata",h)}),Wt(()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",w),window.removeEventListener("keydown",k)}),nt(()=>{window.addEventListener("mousemove",v),window.addEventListener("mouseup",w),window.addEventListener("keydown",k)});const I=()=>c("left"),A=h=>{(h.key==="ArrowLeft"||h.key=="ArrowRight")&&c("left")},X=()=>c("right"),L=h=>{(h.key==="ArrowLeft"||h.key=="ArrowRight")&&c("right")};return l.$$set=h=>{"videoElement"in h&&n(6,t=h.videoElement),"trimmedDuration"in h&&n(7,i=h.trimmedDuration),"dragStart"in h&&n(8,o=h.dragStart),"dragEnd"in h&&n(9,r=h.dragEnd),"loadingTimeline"in h&&n(0,a=h.loadingTimeline)},l.$$.update=()=>{l.$$.dirty&2&&n(0,a=f.length!==Ge)},[a,f,_,u,c,w,t,i,o,r,I,A,X,L]}class Yt extends zt{constructor(e){super(),jt(this,e,Qt,Kt,Ot,{videoElement:6,trimmedDuration:7,dragStart:8,dragEnd:9,loadingTimeline:0})}get videoElement(){return this.$$.ctx[6]}set videoElement(e){this.$$set({videoElement:e}),pe()}get trimmedDuration(){return this.$$.ctx[7]}set trimmedDuration(e){this.$$set({trimmedDuration:e}),pe()}get dragStart(){return this.$$.ctx[8]}set dragStart(e){this.$$set({dragStart:e}),pe()}get dragEnd(){return this.$$.ctx[9]}set dragEnd(e){this.$$set({dragEnd:e}),pe()}get loadingTimeline(){return this.$$.ctx[0]}set loadingTimeline(e){this.$$set({loadingTimeline:e}),pe()}}const{SvelteComponent:Zt,add_flush_callback:Re,append:ce,attr:$,bind:Le,binding_callbacks:Ce,check_outros:Qe,create_component:Ne,destroy_component:Xe,detach:Q,element:ee,empty:xt,flush:z,group_outros:Ye,init:en,insert:Y,listen:ot,mount_component:ze,noop:tn,run_all:nn,safe_not_equal:ln,set_data:on,space:Ve,text:rn,toggle_class:x,transition_in:N,transition_out:W}=window.__gradio__svelte__internal,{onMount:an}=window.__gradio__svelte__internal;function rt(l){let e,n,t,i,o,r,a;function f(c){l[18](c)}function g(c){l[19](c)}function _(c){l[20](c)}function u(c){l[21](c)}let d={videoElement:l[2]};return l[14]!==void 0&&(d.dragStart=l[14]),l[15]!==void 0&&(d.dragEnd=l[15]),l[12]!==void 0&&(d.trimmedDuration=l[12]),l[16]!==void 0&&(d.loadingTimeline=l[16]),n=new Yt({props:d}),Ce.push(()=>Le(n,"dragStart",f)),Ce.push(()=>Le(n,"dragEnd",g)),Ce.push(()=>Le(n,"trimmedDuration",_)),Ce.push(()=>Le(n,"loadingTimeline",u)),{c(){e=ee("div"),Ne(n.$$.fragment),$(e,"class","timeline-wrapper svelte-7yrr5f")},m(c,w){Y(c,e,w),ze(n,e,null),a=!0},p(c,w){const v={};w&4&&(v.videoElement=c[2]),!t&&w&16384&&(t=!0,v.dragStart=c[14],Re(()=>t=!1)),!i&&w&32768&&(i=!0,v.dragEnd=c[15],Re(()=>i=!1)),!o&&w&4096&&(o=!0,v.trimmedDuration=c[12],Re(()=>o=!1)),!r&&w&65536&&(r=!0,v.loadingTimeline=c[16],Re(()=>r=!1)),n.$set(v)},i(c){a||(N(n.$$.fragment,c),a=!0)},o(c){W(n.$$.fragment,c),a=!1},d(c){c&&Q(e),Xe(n)}}}function sn(l){let e;return{c(){e=ee("div"),$(e,"class","svelte-7yrr5f")},m(n,t){Y(n,e,t)},p:tn,d(n){n&&Q(e)}}}function un(l){let e,n=fe(l[12])+"",t,i,o,r,a,f,g,_;return{c(){e=ee("time"),t=rn(n),i=Ve(),o=ee("div"),r=ee("button"),r.textContent="Trim",a=Ve(),f=ee("button"),f.textContent="Cancel",$(e,"aria-label","duration of selected region in seconds"),$(e,"class","svelte-7yrr5f"),x(e,"hidden",l[16]),$(r,"class","text-button svelte-7yrr5f"),x(r,"hidden",l[16]),$(f,"class","text-button svelte-7yrr5f"),x(f,"hidden",l[16]),$(o,"class","edit-buttons svelte-7yrr5f")},m(u,d){Y(u,e,d),ce(e,t),Y(u,i,d),Y(u,o,d),ce(o,r),ce(o,a),ce(o,f),g||(_=[ot(r,"click",l[22]),ot(f,"click",l[17])],g=!0)},p(u,d){d&4096&&n!==(n=fe(u[12])+"")&&on(t,n),d&65536&&x(e,"hidden",u[16]),d&65536&&x(r,"hidden",u[16]),d&65536&&x(f,"hidden",u[16])},d(u){u&&(Q(e),Q(i),Q(o)),g=!1,nn(_)}}}function at(l){let e,n;return e=new Ze({props:{Icon:vt,label:"Reset video to initial value",disabled:l[1]||!l[11]}}),e.$on("click",l[23]),{c(){Ne(e.$$.fragment)},m(t,i){ze(e,t,i),n=!0},p(t,i){const o={};i&2050&&(o.disabled=t[1]||!t[11]),e.$set(o)},i(t){n||(N(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Xe(e,t)}}}function st(l){let e,n;return e=new Ze({props:{Icon:Tt,label:"Trim video to selection",disabled:l[1]}}),e.$on("click",l[17]),{c(){Ne(e.$$.fragment)},m(t,i){ze(e,t,i),n=!0},p(t,i){const o={};i&2&&(o.disabled=t[1]),e.$set(o)},i(t){n||(N(e.$$.fragment,t),n=!0)},o(t){W(e.$$.fragment,t),n=!1},d(t){Xe(e,t)}}}function _n(l){let e,n,t,i=l[3]&&l[0]===""&&at(l),o=l[4]&&l[0]===""&&st(l);return{c(){i&&i.c(),e=Ve(),o&&o.c(),n=xt()},m(r,a){i&&i.m(r,a),Y(r,e,a),o&&o.m(r,a),Y(r,n,a),t=!0},p(r,a){r[3]&&r[0]===""?i?(i.p(r,a),a&9&&N(i,1)):(i=at(r),i.c(),N(i,1),i.m(e.parentNode,e)):i&&(Ye(),W(i,1,1,()=>{i=null}),Qe()),r[4]&&r[0]===""?o?(o.p(r,a),a&17&&N(o,1)):(o=st(r),o.c(),N(o,1),o.m(n.parentNode,n)):o&&(Ye(),W(o,1,1,()=>{o=null}),Qe())},i(r){t||(N(i),N(o),t=!0)},o(r){W(i),W(o),t=!1},d(r){r&&(Q(e),Q(n)),i&&i.d(r),o&&o.d(r)}}}function dn(l){let e,n,t,i,o,r,a=l[0]==="edit"&&rt(l);function f(u,d){return u[0]==="edit"&&u[12]!==null?un:sn}let g=f(l),_=g(l);return o=new Nt({props:{i18n:l[7],download:l[9]?l[8]?.url:null,$$slots:{default:[_n]},$$scope:{ctx:l}}}),o.$on("clear",l[24]),{c(){e=ee("div"),a&&a.c(),n=Ve(),t=ee("div"),_.c(),i=Ve(),Ne(o.$$.fragment),$(t,"class","controls svelte-7yrr5f"),$(t,"data-testid","waveform-controls"),$(e,"class","container svelte-7yrr5f"),x(e,"hidden",l[0]!=="edit")},m(u,d){Y(u,e,d),a&&a.m(e,null),ce(e,n),ce(e,t),_.m(t,null),Y(u,i,d),ze(o,u,d),r=!0},p(u,[d]){u[0]==="edit"?a?(a.p(u,d),d&1&&N(a,1)):(a=rt(u),a.c(),N(a,1),a.m(e,n)):a&&(Ye(),W(a,1,1,()=>{a=null}),Qe()),g===(g=f(u))&&_?_.p(u,d):(_.d(1),_=g(u),_&&(_.c(),_.m(t,null))),(!r||d&1)&&x(e,"hidden",u[0]!=="edit");const c={};d&128&&(c.i18n=u[7]),d&768&&(c.download=u[9]?u[8]?.url:null),d&33556539&&(c.$$scope={dirty:d,ctx:u}),o.$set(c)},i(u){r||(N(a),N(o.$$.fragment,u),r=!0)},o(u){W(a),W(o.$$.fragment,u),r=!1},d(u){u&&(Q(e),Q(i)),a&&a.d(),_.d(),Xe(o,u)}}}function fn(l,e,n){let{videoElement:t}=e,{showRedo:i=!1}=e,{interactive:o=!0}=e,{mode:r=""}=e,{handle_reset_value:a}=e,{handle_trim_video:f}=e,{processingVideo:g=!1}=e,{i18n:_}=e,{value:u=null}=e,{show_download_button:d=!1}=e,{handle_clear:c=()=>{}}=e,{has_change_history:w=!1}=e,v;an(async()=>{n(13,v=await Bt())});let k=null,P=0,I=0,A=!1;const X=()=>{r==="edit"?(n(0,r=""),n(12,k=t.duration)):n(0,r="edit")};function L(p){P=p,n(14,P)}function h(p){I=p,n(15,I)}function T(p){k=p,n(12,k),n(0,r),n(2,t)}function y(p){A=p,n(16,A)}const m=()=>{n(0,r=""),n(1,g=!0),It(v,P,I,t).then(p=>{f(p)}).then(()=>{n(1,g=!1)})},S=()=>{a(),n(0,r="")},G=()=>c();return l.$$set=p=>{"videoElement"in p&&n(2,t=p.videoElement),"showRedo"in p&&n(3,i=p.showRedo),"interactive"in p&&n(4,o=p.interactive),"mode"in p&&n(0,r=p.mode),"handle_reset_value"in p&&n(5,a=p.handle_reset_value),"handle_trim_video"in p&&n(6,f=p.handle_trim_video),"processingVideo"in p&&n(1,g=p.processingVideo),"i18n"in p&&n(7,_=p.i18n),"value"in p&&n(8,u=p.value),"show_download_button"in p&&n(9,d=p.show_download_button),"handle_clear"in p&&n(10,c=p.handle_clear),"has_change_history"in p&&n(11,w=p.has_change_history)},l.$$.update=()=>{l.$$.dirty&4101&&r==="edit"&&k===null&&t&&n(12,k=t.duration)},[r,g,t,i,o,a,f,_,u,d,c,w,k,v,P,I,A,X,L,h,T,y,m,S,G]}class cn extends Zt{constructor(e){super(),en(this,e,fn,dn,ln,{videoElement:2,showRedo:3,interactive:4,mode:0,handle_reset_value:5,handle_trim_video:6,processingVideo:1,i18n:7,value:8,show_download_button:9,handle_clear:10,has_change_history:11})}get videoElement(){return this.$$.ctx[2]}set videoElement(e){this.$$set({videoElement:e}),z()}get showRedo(){return this.$$.ctx[3]}set showRedo(e){this.$$set({showRedo:e}),z()}get interactive(){return this.$$.ctx[4]}set interactive(e){this.$$set({interactive:e}),z()}get mode(){return this.$$.ctx[0]}set mode(e){this.$$set({mode:e}),z()}get handle_reset_value(){return this.$$.ctx[5]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),z()}get handle_trim_video(){return this.$$.ctx[6]}set handle_trim_video(e){this.$$set({handle_trim_video:e}),z()}get processingVideo(){return this.$$.ctx[1]}set processingVideo(e){this.$$set({processingVideo:e}),z()}get i18n(){return this.$$.ctx[7]}set i18n(e){this.$$set({i18n:e}),z()}get value(){return this.$$.ctx[8]}set value(e){this.$$set({value:e}),z()}get show_download_button(){return this.$$.ctx[9]}set show_download_button(e){this.$$set({show_download_button:e}),z()}get handle_clear(){return this.$$.ctx[10]}set handle_clear(e){this.$$set({handle_clear:e}),z()}get has_change_history(){return this.$$.ctx[11]}set has_change_history(e){this.$$set({has_change_history:e}),z()}}const{SvelteComponent:mn,add_flush_callback:ye,append:H,attr:R,bind:Ee,binding_callbacks:Te,bubble:_e,check_outros:ut,create_component:me,destroy_component:he,detach:Me,element:K,empty:hn,flush:q,group_outros:_t,init:gn,insert:Pe,listen:oe,mount_component:ge,prevent_default:dt,run_all:bn,safe_not_equal:wn,set_data:ft,space:ke,src_url_equal:ct,stop_propagation:vn,text:Je,toggle_class:mt,transition_in:j,transition_out:O}=window.__gradio__svelte__internal,{createEventDispatcher:pn}=window.__gradio__svelte__internal;function kn(l){let e,n;return{c(){e=K("track"),R(e,"kind","captions"),ct(e.src,n=l[1])||R(e,"src",n),e.default=!0},m(t,i){Pe(t,e,i)},p(t,i){i[0]&2&&!ct(e.src,n=t[1])&&R(e,"src",n)},d(t){t&&Me(e)}}}function yn(l){let e,n;return e=new Dt({}),{c(){me(e.$$.fragment)},m(t,i){ge(e,t,i),n=!0},i(t){n||(j(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){he(e,t)}}}function En(l){let e,n;return e=new St({}),{c(){me(e.$$.fragment)},m(t,i){ge(e,t,i),n=!0},i(t){n||(j(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){he(e,t)}}}function Tn(l){let e,n;return e=new vt({}),{c(){me(e.$$.fragment)},m(t,i){ge(e,t,i),n=!0},i(t){n||(j(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){he(e,t)}}}function ht(l){let e,n,t;function i(r){l[38](r)}let o={videoElement:l[17],showRedo:!0,handle_trim_video:l[23],handle_reset_value:l[7],value:l[11],i18n:l[9],show_download_button:l[10],handle_clear:l[12],has_change_history:l[13]};return l[18]!==void 0&&(o.processingVideo=l[18]),e=new cn({props:o}),Te.push(()=>Ee(e,"processingVideo",i)),{c(){me(e.$$.fragment)},m(r,a){ge(e,r,a),t=!0},p(r,a){const f={};a[0]&131072&&(f.videoElement=r[17]),a[0]&128&&(f.handle_reset_value=r[7]),a[0]&2048&&(f.value=r[11]),a[0]&512&&(f.i18n=r[9]),a[0]&1024&&(f.show_download_button=r[10]),a[0]&4096&&(f.handle_clear=r[12]),a[0]&8192&&(f.has_change_history=r[13]),!n&&a[0]&262144&&(n=!0,f.processingVideo=r[18],ye(()=>n=!1)),e.$set(f)},i(r){t||(j(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){he(e,r)}}}function Vn(l){let e,n,t,i,o,r,a,f,g,_,u,d,c,w,v,k=fe(l[14])+"",P,I,A=fe(l[15])+"",X,L,h,T,y,m,S,G,p,C,ve,Se;function Ue(b){l[28](b)}function je(b){l[29](b)}function Fe(b){l[30](b)}function Oe(b){l[31](b)}let ie={src:l[0],preload:"auto",autoplay:l[3],loop:l[4],is_stream:l[8],"data-testid":`${l[5]}-player`,processingVideo:l[18],$$slots:{default:[kn]},$$scope:{ctx:l}};l[14]!==void 0&&(ie.currentTime=l[14]),l[15]!==void 0&&(ie.duration=l[15]),l[16]!==void 0&&(ie.paused=l[16]),l[17]!==void 0&&(ie.node=l[17]),t=new Ht({props:ie}),Te.push(()=>Ee(t,"currentTime",Ue)),Te.push(()=>Ee(t,"duration",je)),Te.push(()=>Ee(t,"paused",Fe)),Te.push(()=>Ee(t,"node",Oe)),t.$on("click",l[20]),t.$on("play",l[32]),t.$on("pause",l[33]),t.$on("error",l[34]),t.$on("ended",l[22]),t.$on("loadstart",l[35]),t.$on("loadeddata",l[36]),t.$on("loadedmetadata",l[37]);const De=[Tn,En,yn],J=[];function qe(b,E){return b[14]===b[15]?0:b[16]?1:2}d=qe(l),c=J[d]=De[d](l),S=new Vt({});let V=l[6]&&ht(l);return{c(){e=K("div"),n=K("div"),me(t.$$.fragment),f=ke(),g=K("div"),_=K("div"),u=K("span"),c.c(),w=ke(),v=K("span"),P=Je(k),I=Je(" / "),X=Je(A),L=ke(),h=K("progress"),y=ke(),m=K("div"),me(S.$$.fragment),G=ke(),V&&V.c(),p=hn(),R(n,"class","mirror-wrap svelte-euo1cw"),mt(n,"mirror",l[2]),R(u,"role","button"),R(u,"tabindex","0"),R(u,"class","icon svelte-euo1cw"),R(u,"aria-label","play-pause-replay-button"),R(v,"class","time svelte-euo1cw"),h.value=T=l[14]/l[15]||0,R(h,"class","svelte-euo1cw"),R(m,"role","button"),R(m,"tabindex","0"),R(m,"class","icon svelte-euo1cw"),R(m,"aria-label","full-screen"),R(_,"class","inner svelte-euo1cw"),R(g,"class","controls svelte-euo1cw"),R(e,"class","wrap svelte-euo1cw")},m(b,E){Pe(b,e,E),H(e,n),ge(t,n,null),H(e,f),H(e,g),H(g,_),H(_,u),J[d].m(u,null),H(_,w),H(_,v),H(v,P),H(v,I),H(v,X),H(_,L),H(_,h),H(_,y),H(_,m),ge(S,m,null),Pe(b,G,E),V&&V.m(b,E),Pe(b,p,E),C=!0,ve||(Se=[oe(u,"click",l[20]),oe(u,"keydown",l[20]),oe(h,"mousemove",l[19]),oe(h,"touchmove",dt(l[19])),oe(h,"click",vn(dt(l[21]))),oe(m,"click",l[24]),oe(m,"keypress",l[24])],ve=!0)},p(b,E){const s={};E[0]&1&&(s.src=b[0]),E[0]&8&&(s.autoplay=b[3]),E[0]&16&&(s.loop=b[4]),E[0]&256&&(s.is_stream=b[8]),E[0]&32&&(s["data-testid"]=`${b[5]}-player`),E[0]&262144&&(s.processingVideo=b[18]),E[0]&2|E[1]&512&&(s.$$scope={dirty:E,ctx:b}),!i&&E[0]&16384&&(i=!0,s.currentTime=b[14],ye(()=>i=!1)),!o&&E[0]&32768&&(o=!0,s.duration=b[15],ye(()=>o=!1)),!r&&E[0]&65536&&(r=!0,s.paused=b[16],ye(()=>r=!1)),!a&&E[0]&131072&&(a=!0,s.node=b[17],ye(()=>a=!1)),t.$set(s),(!C||E[0]&4)&&mt(n,"mirror",b[2]);let F=d;d=qe(b),d!==F&&(_t(),O(J[F],1,1,()=>{J[F]=null}),ut(),c=J[d],c||(c=J[d]=De[d](b),c.c()),j(c,1),c.m(u,null)),(!C||E[0]&16384)&&k!==(k=fe(b[14])+"")&&ft(P,k),(!C||E[0]&32768)&&A!==(A=fe(b[15])+"")&&ft(X,A),(!C||E[0]&49152&&T!==(T=b[14]/b[15]||0))&&(h.value=T),b[6]?V?(V.p(b,E),E[0]&64&&j(V,1)):(V=ht(b),V.c(),j(V,1),V.m(p.parentNode,p)):V&&(_t(),O(V,1,1,()=>{V=null}),ut())},i(b){C||(j(t.$$.fragment,b),j(c),j(S.$$.fragment,b),j(V),C=!0)},o(b){O(t.$$.fragment,b),O(c),O(S.$$.fragment,b),O(V),C=!1},d(b){b&&(Me(e),Me(G),Me(p)),he(t),J[d].d(),he(S),V&&V.d(b),ve=!1,bn(Se)}}}function Sn(l,e,n){let{root:t=""}=e,{src:i}=e,{subtitle:o=null}=e,{mirror:r}=e,{autoplay:a}=e,{loop:f}=e,{label:g="test"}=e,{interactive:_=!1}=e,{handle_change:u=()=>{}}=e,{handle_reset_value:d=()=>{}}=e,{upload:c}=e,{is_stream:w}=e,{i18n:v}=e,{show_download_button:k=!1}=e,{value:P=null}=e,{handle_clear:I=()=>{}}=e,{has_change_history:A=!1}=e;const X=pn();let L=0,h,T=!0,y,m=!1;function S(s){if(!h)return;if(s.type==="click"){p(s);return}if(s.type!=="touchmove"&&!(s.buttons&1))return;const F=s.type==="touchmove"?s.touches[0].clientX:s.clientX,{left:ae,right:$e}=s.currentTarget.getBoundingClientRect();n(14,L=h*(F-ae)/($e-ae))}async function G(){document.fullscreenElement!=y&&(y.currentTime>0&&!y.paused&&!y.ended&&y.readyState>y.HAVE_CURRENT_DATA?y.pause():await y.play())}function p(s){const{left:F,right:ae}=s.currentTarget.getBoundingClientRect();n(14,L=h*(s.clientX-F)/(ae-F))}function C(){X("stop"),X("end")}const ve=async s=>{let F=new File([s],"video.mp4");const ae=await Xt([F]);let $e=(await c(ae,t))?.filter(Boolean)[0];u($e)};function Se(){y.requestFullscreen()}function Ue(s){L=s,n(14,L)}function je(s){h=s,n(15,h)}function Fe(s){T=s,n(16,T)}function Oe(s){y=s,n(17,y)}function ie(s){_e.call(this,l,s)}function De(s){_e.call(this,l,s)}function J(s){_e.call(this,l,s)}function qe(s){_e.call(this,l,s)}function V(s){_e.call(this,l,s)}function b(s){_e.call(this,l,s)}function E(s){m=s,n(18,m)}return l.$$set=s=>{"root"in s&&n(25,t=s.root),"src"in s&&n(0,i=s.src),"subtitle"in s&&n(1,o=s.subtitle),"mirror"in s&&n(2,r=s.mirror),"autoplay"in s&&n(3,a=s.autoplay),"loop"in s&&n(4,f=s.loop),"label"in s&&n(5,g=s.label),"interactive"in s&&n(6,_=s.interactive),"handle_change"in s&&n(26,u=s.handle_change),"handle_reset_value"in s&&n(7,d=s.handle_reset_value),"upload"in s&&n(27,c=s.upload),"is_stream"in s&&n(8,w=s.is_stream),"i18n"in s&&n(9,v=s.i18n),"show_download_button"in s&&n(10,k=s.show_download_button),"value"in s&&n(11,P=s.value),"handle_clear"in s&&n(12,I=s.handle_clear),"has_change_history"in s&&n(13,A=s.has_change_history)},l.$$.update=()=>{l.$$.dirty[0]&16384&&n(14,L=L||0),l.$$.dirty[0]&32768&&n(15,h=h||0)},[i,o,r,a,f,g,_,d,w,v,k,P,I,A,L,h,T,y,m,S,G,p,C,ve,Se,t,u,c,Ue,je,Fe,Oe,ie,De,J,qe,V,b,E]}class Dn extends mn{constructor(e){super(),gn(this,e,Sn,Vn,wn,{root:25,src:0,subtitle:1,mirror:2,autoplay:3,loop:4,label:5,interactive:6,handle_change:26,handle_reset_value:7,upload:27,is_stream:8,i18n:9,show_download_button:10,value:11,handle_clear:12,has_change_history:13},null,[-1,-1])}get root(){return this.$$.ctx[25]}set root(e){this.$$set({root:e}),q()}get src(){return this.$$.ctx[0]}set src(e){this.$$set({src:e}),q()}get subtitle(){return this.$$.ctx[1]}set subtitle(e){this.$$set({subtitle:e}),q()}get mirror(){return this.$$.ctx[2]}set mirror(e){this.$$set({mirror:e}),q()}get autoplay(){return this.$$.ctx[3]}set autoplay(e){this.$$set({autoplay:e}),q()}get loop(){return this.$$.ctx[4]}set loop(e){this.$$set({loop:e}),q()}get label(){return this.$$.ctx[5]}set label(e){this.$$set({label:e}),q()}get interactive(){return this.$$.ctx[6]}set interactive(e){this.$$set({interactive:e}),q()}get handle_change(){return this.$$.ctx[26]}set handle_change(e){this.$$set({handle_change:e}),q()}get handle_reset_value(){return this.$$.ctx[7]}set handle_reset_value(e){this.$$set({handle_reset_value:e}),q()}get upload(){return this.$$.ctx[27]}set upload(e){this.$$set({upload:e}),q()}get is_stream(){return this.$$.ctx[8]}set is_stream(e){this.$$set({is_stream:e}),q()}get i18n(){return this.$$.ctx[9]}set i18n(e){this.$$set({i18n:e}),q()}get show_download_button(){return this.$$.ctx[10]}set show_download_button(e){this.$$set({show_download_button:e}),q()}get value(){return this.$$.ctx[11]}set value(e){this.$$set({value:e}),q()}get handle_clear(){return this.$$.ctx[12]}set handle_clear(e){this.$$set({handle_clear:e}),q()}get has_change_history(){return this.$$.ctx[13]}set has_change_history(e){this.$$set({has_change_history:e}),q()}}const{SvelteComponent:qn,attr:Rn,bubble:de,check_outros:Ae,create_component:te,destroy_component:ne,detach:be,element:Ln,empty:kt,flush:U,group_outros:Be,init:Cn,insert:we,mount_component:le,noop:yt,safe_not_equal:Et,space:xe,transition_in:D,transition_out:M}=window.__gradio__svelte__internal,{createEventDispatcher:Mn,afterUpdate:Pn,tick:An}=window.__gradio__svelte__internal;function Bn(l){let e=l[0].url,n,t,i,o,r=gt(l);return i=new Ct({props:{display_top_corner:l[10],$$slots:{default:[Nn]},$$scope:{ctx:l}}}),{c(){r.c(),n=xe(),t=Ln("div"),te(i.$$.fragment),Rn(t,"data-testid","download-div")},m(a,f){r.m(a,f),we(a,n,f),we(a,t,f),le(i,t,null),o=!0},p(a,f){f&1&&Et(e,e=a[0].url)?(Be(),M(r,1,1,yt),Ae(),r=gt(a),r.c(),D(r,1),r.m(n.parentNode,n)):r.p(a,f);const g={};f&1024&&(g.display_top_corner=a[10]),f&4194657&&(g.$$scope={dirty:f,ctx:a}),i.$set(g)},i(a){o||(D(r),D(i.$$.fragment,a),o=!0)},o(a){M(r),M(i.$$.fragment,a),o=!1},d(a){a&&(be(n),be(t)),r.d(a),ne(i)}}}function In(l){let e,n;return e=new Lt({props:{unpadded_box:!0,size:"large",$$slots:{default:[Xn]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p(t,i){const o={};i&4194304&&(o.$$scope={dirty:i,ctx:t}),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function gt(l){let e,n;return e=new Dn({props:{src:l[0].url,subtitle:l[1]?.url,is_stream:l[0].is_stream,autoplay:l[4],mirror:!1,label:l[2],loop:l[7],interactive:!1,upload:l[9],i18n:l[8]}}),e.$on("play",l[12]),e.$on("pause",l[13]),e.$on("stop",l[14]),e.$on("end",l[15]),e.$on("loadedmetadata",l[16]),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p(t,i){const o={};i&1&&(o.src=t[0].url),i&2&&(o.subtitle=t[1]?.url),i&1&&(o.is_stream=t[0].is_stream),i&16&&(o.autoplay=t[4]),i&4&&(o.label=t[2]),i&128&&(o.loop=t[7]),i&512&&(o.upload=t[9]),i&256&&(o.i18n=t[8]),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function bt(l){let e,n;return e=new Mt({props:{href:l[0].is_stream?l[0].url?.replace("playlist.m3u8","playlist-file"):l[0].url,download:l[0].orig_name||l[0].path,$$slots:{default:[Hn]},$$scope:{ctx:l}}}),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p(t,i){const o={};i&1&&(o.href=t[0].is_stream?t[0].url?.replace("playlist.m3u8","playlist-file"):t[0].url),i&1&&(o.download=t[0].orig_name||t[0].path),i&4194304&&(o.$$scope={dirty:i,ctx:t}),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Hn(l){let e,n;return e=new Ze({props:{Icon:At,label:"Download"}}),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p:yt,i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function wt(l){let e,n;return e=new Pt({props:{i18n:l[8],value:l[0],formatter:l[17]}}),e.$on("error",l[18]),e.$on("share",l[19]),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},p(t,i){const o={};i&256&&(o.i18n=t[8]),i&1&&(o.value=t[0]),e.$set(o)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Nn(l){let e,n,t,i=l[6]&&bt(l),o=l[5]&&wt(l);return{c(){i&&i.c(),e=xe(),o&&o.c(),n=kt()},m(r,a){i&&i.m(r,a),we(r,e,a),o&&o.m(r,a),we(r,n,a),t=!0},p(r,a){r[6]?i?(i.p(r,a),a&64&&D(i,1)):(i=bt(r),i.c(),D(i,1),i.m(e.parentNode,e)):i&&(Be(),M(i,1,1,()=>{i=null}),Ae()),r[5]?o?(o.p(r,a),a&32&&D(o,1)):(o=wt(r),o.c(),D(o,1),o.m(n.parentNode,n)):o&&(Be(),M(o,1,1,()=>{o=null}),Ae())},i(r){t||(D(i),D(o),t=!0)},o(r){M(i),M(o),t=!1},d(r){r&&(be(e),be(n)),i&&i.d(r),o&&o.d(r)}}}function Xn(l){let e,n;return e=new pt({}),{c(){te(e.$$.fragment)},m(t,i){le(e,t,i),n=!0},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function zn(l){let e,n,t,i,o,r;e=new qt({props:{show_label:l[3],Icon:pt,label:l[2]||"Video"}});const a=[In,Bn],f=[];function g(_,u){return!_[0]||_[0].url===void 0?0:1}return t=g(l),i=f[t]=a[t](l),{c(){te(e.$$.fragment),n=xe(),i.c(),o=kt()},m(_,u){le(e,_,u),we(_,n,u),f[t].m(_,u),we(_,o,u),r=!0},p(_,[u]){const d={};u&8&&(d.show_label=_[3]),u&4&&(d.label=_[2]||"Video"),e.$set(d);let c=t;t=g(_),t===c?f[t].p(_,u):(Be(),M(f[c],1,1,()=>{f[c]=null}),Ae(),i=f[t],i?i.p(_,u):(i=f[t]=a[t](_),i.c()),D(i,1),i.m(o.parentNode,o))},i(_){r||(D(e.$$.fragment,_),D(i),r=!0)},o(_){M(e.$$.fragment,_),M(i),r=!1},d(_){_&&(be(n),be(o)),ne(e,_),f[t].d(_)}}}function Un(l,e,n){let{value:t=null}=e,{subtitle:i=null}=e,{label:o=void 0}=e,{show_label:r=!0}=e,{autoplay:a}=e,{show_share_button:f=!0}=e,{show_download_button:g=!0}=e,{loop:_}=e,{i18n:u}=e,{upload:d}=e,{display_icon_button_wrapper_top_corner:c=!1}=e,w=null,v=null;const k=Mn();Pn(async()=>{t!==w&&i!==v&&v!==null&&(w=t,n(0,t=null),await An(),n(0,t=w)),w=t,v=i});function P(m){de.call(this,l,m)}function I(m){de.call(this,l,m)}function A(m){de.call(this,l,m)}function X(m){de.call(this,l,m)}const L=()=>{k("load")},h=async m=>m?await Rt(m.data):"";function T(m){de.call(this,l,m)}function y(m){de.call(this,l,m)}return l.$$set=m=>{"value"in m&&n(0,t=m.value),"subtitle"in m&&n(1,i=m.subtitle),"label"in m&&n(2,o=m.label),"show_label"in m&&n(3,r=m.show_label),"autoplay"in m&&n(4,a=m.autoplay),"show_share_button"in m&&n(5,f=m.show_share_button),"show_download_button"in m&&n(6,g=m.show_download_button),"loop"in m&&n(7,_=m.loop),"i18n"in m&&n(8,u=m.i18n),"upload"in m&&n(9,d=m.upload),"display_icon_button_wrapper_top_corner"in m&&n(10,c=m.display_icon_button_wrapper_top_corner)},l.$$.update=()=>{l.$$.dirty&1&&t&&k("change",t)},[t,i,o,r,a,f,g,_,u,d,c,k,P,I,A,X,L,h,T,y]}class jn extends qn{constructor(e){super(),Cn(this,e,Un,zn,Et,{value:0,subtitle:1,label:2,show_label:3,autoplay:4,show_share_button:5,show_download_button:6,loop:7,i18n:8,upload:9,display_icon_button_wrapper_top_corner:10})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),U()}get subtitle(){return this.$$.ctx[1]}set subtitle(e){this.$$set({subtitle:e}),U()}get label(){return this.$$.ctx[2]}set label(e){this.$$set({label:e}),U()}get show_label(){return this.$$.ctx[3]}set show_label(e){this.$$set({show_label:e}),U()}get autoplay(){return this.$$.ctx[4]}set autoplay(e){this.$$set({autoplay:e}),U()}get show_share_button(){return this.$$.ctx[5]}set show_share_button(e){this.$$set({show_share_button:e}),U()}get show_download_button(){return this.$$.ctx[6]}set show_download_button(e){this.$$set({show_download_button:e}),U()}get loop(){return this.$$.ctx[7]}set loop(e){this.$$set({loop:e}),U()}get i18n(){return this.$$.ctx[8]}set i18n(e){this.$$set({i18n:e}),U()}get upload(){return this.$$.ctx[9]}set upload(e){this.$$set({upload:e}),U()}get display_icon_button_wrapper_top_corner(){return this.$$.ctx[10]}set display_icon_button_wrapper_top_corner(e){this.$$set({display_icon_button_wrapper_top_corner:e}),U()}}const Jn=Object.freeze(Object.defineProperty({__proto__:null,default:jn},Symbol.toStringTag,{value:"Module"}));export{Dn as P,jn as V,Jn as a};
//# sourceMappingURL=VideoPreview-q5JwjFSq.js.map
