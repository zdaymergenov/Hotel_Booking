const __vite__fileDeps=["./module.P_aKkXCo.js","./module.C-VadMaF.js","./2.BPD7TSJN.js","./preload-helper.D6kgxu3v.js","./stores.DJzfeW5j.js","./client.DLLVamsL.js","../assets/2.CWMm6HsE.css","./module.niXGEr8P.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as Ue}from"./preload-helper.D6kgxu3v.js";import{SvelteComponent as De,init as Re,safe_not_equal as Te,element as M,claim_element as A,children as B,detach as w,attr as T,insert_hydration as z,noop as be,createEventDispatcher as Se,ensure_array_like as Ne,empty as pe,destroy_each as vt,text as te,claim_text as ie,set_input_value as Pe,append_hydration as p,set_data as ne,binding_callbacks as j,bind as se,space as U,create_component as J,claim_space as N,claim_component as K,mount_component as Q,listen as de,add_flush_callback as le,transition_in as P,transition_out as S,destroy_component as X,run_all as wt,group_outros as ke,check_outros as ye,onMount as We,get_svelte_dataset as Me,set_style as ze,null_to_empty as Ve,onDestroy as pt,bubble as ge,create_slot as kt,update_slot_base as yt,get_all_dirty_from_scope as Et,get_slot_changes as Dt}from"../../../svelte/svelte.js";import"../../../svelte/svelte-submodules.js";import{a as Rt}from"./Upload.DYS5R487.js";import{M as xe}from"./ModifyUpload.ZjEjKsCN.js";import{R as _e,z as Tt}from"./2.BPD7TSJN.js";import{B as It}from"./BlockLabel.B6sjuoOP.js";import{M as Mt}from"./Music.BVFRDHso.js";import{a as At,S as Pt}from"./SelectSource.BAYRyk3o.js";import{S as Lt}from"./StreamingBar.DqrTU_oA.js";import{s as je,W as St,p as He,a as Le,A as Bt}from"./AudioPlayer.Dm9zAm0U.js";import{P as Ct}from"./Trim.CWFkmJwA.js";function Ae(n,e,t,i){return new(t||(t=Promise))(function(r,s){function l(a){try{f(i.next(a))}catch(o){s(o)}}function u(a){try{f(i.throw(a))}catch(o){s(o)}}function f(a){var o;a.done?r(a.value):(o=a.value,o instanceof t?o:new t(function(d){d(o)})).then(l,u)}f((i=i.apply(n,[])).next())})}class Ot{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener}addEventListener(e,t,i){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),i==null?void 0:i.once){const r=()=>{this.removeEventListener(e,r),this.removeEventListener(e,t)};return this.addEventListener(e,r),r}return()=>this.removeEventListener(e,t)}removeEventListener(e,t){var i;(i=this.listeners[e])===null||i===void 0||i.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}}class Ut extends Ot{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}}const Nt=["audio/webm","audio/wav","audio/mpeg","audio/mp4","audio/mp3"];class Ie extends Ut{constructor(e){var t;super(Object.assign(Object.assign({},e),{audioBitsPerSecond:(t=e.audioBitsPerSecond)!==null&&t!==void 0?t:128e3})),this.stream=null,this.mediaRecorder=null}static create(e){return new Ie(e||{})}renderMicStream(e){const t=new AudioContext,i=t.createMediaStreamSource(e),r=t.createAnalyser();i.connect(r);const s=r.frequencyBinCount,l=new Float32Array(s),u=s/t.sampleRate;let f;const a=()=>{r.getFloatTimeDomainData(l),this.wavesurfer&&(this.wavesurfer.options.cursorWidth=0,this.wavesurfer.options.interact=!1,this.wavesurfer.load("",[l],u)),f=requestAnimationFrame(a)};return a(),()=>{cancelAnimationFrame(f),i==null||i.disconnect(),t==null||t.close()}}startMic(e){return Ae(this,void 0,void 0,function*(){let t;try{t=yield navigator.mediaDevices.getUserMedia({audio:!(e!=null&&e.deviceId)||{deviceId:e.deviceId}})}catch(r){throw new Error("Error accessing the microphone: "+r.message)}const i=this.renderMicStream(t);return this.subscriptions.push(this.once("destroy",i)),this.stream=t,t})}stopMic(){this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null,this.mediaRecorder=null)}startRecording(e){return Ae(this,void 0,void 0,function*(){const t=this.stream||(yield this.startMic(e)),i=this.mediaRecorder||new MediaRecorder(t,{mimeType:this.options.mimeType||Nt.find(s=>MediaRecorder.isTypeSupported(s)),audioBitsPerSecond:this.options.audioBitsPerSecond});this.mediaRecorder=i,this.stopRecording();const r=[];i.ondataavailable=s=>{s.data.size>0&&r.push(s.data)},i.onstop=()=>{var s;const l=new Blob(r,{type:i.mimeType});this.emit("record-end",l),this.options.renderRecordedAudio!==!1&&((s=this.wavesurfer)===null||s===void 0||s.load(URL.createObjectURL(l)))},i.start(),this.emit("record-start")})}isRecording(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="recording"}isPaused(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="paused"}stopRecording(){var e;this.isRecording()&&((e=this.mediaRecorder)===null||e===void 0||e.stop())}pauseRecording(){var e;this.isRecording()&&((e=this.mediaRecorder)===null||e===void 0||e.pause(),this.emit("record-pause"))}resumeRecording(){var e;this.isPaused()&&((e=this.mediaRecorder)===null||e===void 0||e.resume(),this.emit("record-resume"))}static getAvailableAudioDevices(){return Ae(this,void 0,void 0,function*(){return navigator.mediaDevices.enumerateDevices().then(e=>e.filter(t=>t.kind==="audioinput"))})}destroy(){super.destroy(),this.stopRecording(),this.stopMic()}}function qe(n,e,t){const i=n.slice();return i[3]=e[t],i}function zt(n){let e,t=Ne(n[0]),i=[];for(let r=0;r<t.length;r+=1)i[r]=Fe(qe(n,t,r));return{c(){for(let r=0;r<i.length;r+=1)i[r].c();e=pe()},l(r){for(let s=0;s<i.length;s+=1)i[s].l(r);e=pe()},m(r,s){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(r,s);z(r,e,s)},p(r,s){if(s&1){t=Ne(r[0]);let l;for(l=0;l<t.length;l+=1){const u=qe(r,t,l);i[l]?i[l].p(u,s):(i[l]=Fe(u),i[l].c(),i[l].m(e.parentNode,e))}for(;l<i.length;l+=1)i[l].d(1);i.length=t.length}},d(r){r&&w(e),vt(i,r)}}}function Vt(n){let e,t=n[1]("audio.no_microphone")+"",i;return{c(){e=M("option"),i=te(t),this.h()},l(r){e=A(r,"OPTION",{});var s=B(e);i=ie(s,t),s.forEach(w),this.h()},h(){e.__value="",Pe(e,e.__value)},m(r,s){z(r,e,s),p(e,i)},p(r,s){s&2&&t!==(t=r[1]("audio.no_microphone")+"")&&ne(i,t)},d(r){r&&w(e)}}}function Fe(n){let e,t=n[3].label+"",i,r;return{c(){e=M("option"),i=te(t),this.h()},l(s){e=A(s,"OPTION",{});var l=B(e);i=ie(l,t),l.forEach(w),this.h()},h(){e.__value=r=n[3].deviceId,Pe(e,e.__value)},m(s,l){z(s,e,l),p(e,i)},p(s,l){l&1&&t!==(t=s[3].label+"")&&ne(i,t),l&1&&r!==(r=s[3].deviceId)&&(e.__value=r,Pe(e,e.__value))},d(s){s&&w(e)}}}function jt(n){let e,t;function i(l,u){return l[0].length===0?Vt:zt}let r=i(n),s=r(n);return{c(){e=M("select"),s.c(),this.h()},l(l){e=A(l,"SELECT",{class:!0,"aria-label":!0});var u=B(e);s.l(u),u.forEach(w),this.h()},h(){T(e,"class","mic-select svelte-1ya9x7a"),T(e,"aria-label","Select input device"),e.disabled=t=n[0].length===0},m(l,u){z(l,e,u),s.m(e,null)},p(l,[u]){r===(r=i(l))&&s?s.p(l,u):(s.d(1),s=r(l),s&&(s.c(),s.m(e,null))),u&1&&t!==(t=l[0].length===0)&&(e.disabled=t)},i:be,o:be,d(l){l&&w(e),s.d()}}}function Ht(n,e,t){let{i18n:i}=e,{micDevices:r=[]}=e;const s=Se();return n.$$set=l=>{"i18n"in l&&t(1,i=l.i18n),"micDevices"in l&&t(0,r=l.micDevices)},n.$$.update=()=>{if(n.$$.dirty&2&&typeof window<"u")try{let l=[];Ie.getAvailableAudioDevices().then(u=>{t(0,r=u),u.forEach(f=>{f.deviceId&&l.push(f)}),t(0,r=l)})}catch(l){throw l instanceof DOMException&&l.name=="NotAllowedError"&&s("error",i("audio.allow_recording_access")),l}},[r,i]}class $e extends De{constructor(e){super(),Re(this,e,Ht,jt,Te,{i18n:1,micDevices:0})}}function Ye(n){let e,t;return{c(){e=M("time"),t=te(n[2]),this.h()},l(i){e=A(i,"TIME",{class:!0});var r=B(e);t=ie(r,n[2]),r.forEach(w),this.h()},h(){T(e,"class","duration-button duration svelte-1oiuk2f")},m(i,r){z(i,e,r),p(e,t)},p(i,r){r&4&&ne(t,i[2])},d(i){i&&w(e)}}}function qt(n){let e,t,i,r=n[1]("audio.record")+"",s,l,u,f=n[1]("audio.stop")+"",a,o,d,c,g=n[1]("audio.stop")+"",D,I,m,E,h,v,C=n[1]("audio.resume")+"",y,F,Y,H,oe,O,k,Z;E=new Ct({});let V=n[4]&&!n[3]&&Ye(n);function fe(L){n[23](L)}let ae={i18n:n[1]};return n[5]!==void 0&&(ae.micDevices=n[5]),H=new $e({props:ae}),j.push(()=>se(H,"micDevices",fe)),{c(){e=M("div"),t=M("div"),i=M("button"),s=te(r),l=U(),u=M("button"),a=te(f),d=U(),c=M("button"),D=te(g),I=U(),m=M("button"),J(E.$$.fragment),h=U(),v=M("button"),y=te(C),F=U(),V&&V.c(),Y=U(),J(H.$$.fragment),this.h()},l(L){e=A(L,"DIV",{class:!0});var q=B(e);t=A(q,"DIV",{class:!0});var R=B(t);i=A(R,"BUTTON",{class:!0});var x=B(i);s=ie(x,r),x.forEach(w),l=N(R),u=A(R,"BUTTON",{class:!0});var $=B(u);a=ie($,f),$.forEach(w),d=N(R),c=A(R,"BUTTON",{id:!0,class:!0});var ee=B(c);D=ie(ee,g),ee.forEach(w),I=N(R),m=A(R,"BUTTON",{"aria-label":!0,class:!0});var ue=B(m);K(E.$$.fragment,ue),ue.forEach(w),h=N(R),v=A(R,"BUTTON",{class:!0});var me=B(v);y=ie(me,C),me.forEach(w),F=N(R),V&&V.l(R),R.forEach(w),Y=N(q),K(H.$$.fragment,q),q.forEach(w),this.h()},h(){T(i,"class","record record-button svelte-1oiuk2f"),T(u,"class",o="stop-button "+(n[0].isPaused()?"stop-button-paused":"")+" svelte-1oiuk2f"),T(c,"id","stop-paused"),T(c,"class","stop-button-paused svelte-1oiuk2f"),T(m,"aria-label","pause"),T(m,"class","pause-button svelte-1oiuk2f"),T(v,"class","resume-button svelte-1oiuk2f"),T(t,"class","wrapper svelte-1oiuk2f"),T(e,"class","controls svelte-1oiuk2f")},m(L,q){z(L,e,q),p(e,t),p(t,i),p(i,s),n[13](i),p(t,l),p(t,u),p(u,a),n[15](u),p(t,d),p(t,c),p(c,D),n[17](c),p(t,I),p(t,m),Q(E,m,null),n[19](m),p(t,h),p(t,v),p(v,y),n[21](v),p(t,F),V&&V.m(t,null),p(e,Y),Q(H,e,null),O=!0,k||(Z=[de(i,"click",n[14]),de(u,"click",n[16]),de(c,"click",n[18]),de(m,"click",n[20]),de(v,"click",n[22])],k=!0)},p(L,[q]){(!O||q&2)&&r!==(r=L[1]("audio.record")+"")&&ne(s,r),(!O||q&2)&&f!==(f=L[1]("audio.stop")+"")&&ne(a,f),(!O||q&1&&o!==(o="stop-button "+(L[0].isPaused()?"stop-button-paused":"")+" svelte-1oiuk2f"))&&T(u,"class",o),(!O||q&2)&&g!==(g=L[1]("audio.stop")+"")&&ne(D,g),(!O||q&2)&&C!==(C=L[1]("audio.resume")+"")&&ne(y,C),L[4]&&!L[3]?V?V.p(L,q):(V=Ye(L),V.c(),V.m(t,null)):V&&(V.d(1),V=null);const R={};q&2&&(R.i18n=L[1]),!oe&&q&32&&(oe=!0,R.micDevices=L[5],le(()=>oe=!1)),H.$set(R)},i(L){O||(P(E.$$.fragment,L),P(H.$$.fragment,L),O=!0)},o(L){S(E.$$.fragment,L),S(H.$$.fragment,L),O=!1},d(L){L&&w(e),n[13](null),n[15](null),n[17](null),X(E),n[19](null),n[21](null),V&&V.d(),X(H),k=!1,wt(Z)}}}function Ft(n,e,t){let{record:i}=e,{i18n:r}=e,{recording:s=!1}=e,l=[],u,f,a,o,d,c=!1,{record_time:g}=e,{show_recording_waveform:D}=e,{timing:I=!1}=e;function m(k){j[k?"unshift":"push"](()=>{u=k,t(6,u),t(0,i)})}const E=()=>i.startRecording();function h(k){j[k?"unshift":"push"](()=>{o=k,t(9,o),t(0,i)})}const v=()=>{i.isPaused()&&(i.resumeRecording(),i.stopRecording()),i.stopRecording()};function C(k){j[k?"unshift":"push"](()=>{d=k,t(10,d),t(0,i)})}const y=()=>{i.isPaused()&&(i.resumeRecording(),i.stopRecording()),i.stopRecording()};function F(k){j[k?"unshift":"push"](()=>{f=k,t(7,f),t(0,i)})}const Y=()=>i.pauseRecording();function H(k){j[k?"unshift":"push"](()=>{a=k,t(8,a),t(0,i)})}const oe=()=>i.resumeRecording();function O(k){l=k,t(5,l)}return n.$$set=k=>{"record"in k&&t(0,i=k.record),"i18n"in k&&t(1,r=k.i18n),"recording"in k&&t(11,s=k.recording),"record_time"in k&&t(2,g=k.record_time),"show_recording_waveform"in k&&t(3,D=k.show_recording_waveform),"timing"in k&&t(4,I=k.timing)},n.$$.update=()=>{n.$$.dirty&1&&i.on("record-start",()=>{i.startMic(),t(6,u.style.display="none",u),t(9,o.style.display="flex",o),t(7,f.style.display="block",f)}),n.$$.dirty&1&&i.on("record-end",()=>{i.isPaused()&&(i.resumeRecording(),i.stopRecording()),i.stopMic(),t(6,u.style.display="flex",u),t(9,o.style.display="none",o),t(7,f.style.display="none",f),t(6,u.disabled=!1,u)}),n.$$.dirty&1&&i.on("record-pause",()=>{t(7,f.style.display="none",f),t(8,a.style.display="block",a),t(9,o.style.display="none",o),t(10,d.style.display="flex",d)}),n.$$.dirty&1&&i.on("record-resume",()=>{t(7,f.style.display="block",f),t(8,a.style.display="none",a),t(6,u.style.display="none",u),t(9,o.style.display="flex",o),t(10,d.style.display="none",d)}),n.$$.dirty&6145&&(s&&!c?(i.startRecording(),t(12,c=!0)):(i.stopRecording(),t(12,c=!1)))},[i,r,g,D,I,l,u,f,a,o,d,s,c,m,E,h,v,C,y,F,Y,H,oe,O]}class Yt extends De{constructor(e){super(),Re(this,e,Ft,qt,Te,{record:0,i18n:1,recording:11,record_time:2,show_recording_waveform:3,timing:4})}}function Ge(n){let e,t,i="0:00",r,s,l,u=n[0]==="edit"&&n[17]>0&&Je(n);function f(d,c){return d[16]?Jt:Gt}let a=f(n),o=a(n);return{c(){e=M("div"),t=M("time"),t.textContent=i,r=U(),s=M("div"),u&&u.c(),l=U(),o.c(),this.h()},l(d){e=A(d,"DIV",{class:!0});var c=B(e);t=A(c,"TIME",{class:!0,"data-svelte-h":!0}),Me(t)!=="svelte-1rda9am"&&(t.textContent=i),r=N(c),s=A(c,"DIV",{});var g=B(s);u&&u.l(g),l=N(g),o.l(g),g.forEach(w),c.forEach(w),this.h()},h(){T(t,"class","time svelte-9n45fh"),T(e,"class","timestamps svelte-9n45fh")},m(d,c){z(d,e,c),p(e,t),n[23](t),p(e,r),p(e,s),u&&u.m(s,null),p(s,l),o.m(s,null)},p(d,c){d[0]==="edit"&&d[17]>0?u?u.p(d,c):(u=Je(d),u.c(),u.m(s,l)):u&&(u.d(1),u=null),a===(a=f(d))&&o?o.p(d,c):(o.d(1),o=a(d),o&&(o.c(),o.m(s,null)))},d(d){d&&w(e),n[23](null),u&&u.d(),o.d()}}}function Je(n){let e,t=_e(n[17])+"",i;return{c(){e=M("time"),i=te(t),this.h()},l(r){e=A(r,"TIME",{class:!0});var s=B(e);i=ie(s,t),s.forEach(w),this.h()},h(){T(e,"class","trim-duration svelte-9n45fh")},m(r,s){z(r,e,s),p(e,i)},p(r,s){s[0]&131072&&t!==(t=_e(r[17])+"")&&ne(i,t)},d(r){r&&w(e)}}}function Gt(n){let e,t="0:00";return{c(){e=M("time"),e.textContent=t,this.h()},l(i){e=A(i,"TIME",{class:!0,"data-svelte-h":!0}),Me(e)!=="svelte-1llsiqq"&&(e.textContent=t),this.h()},h(){T(e,"class","duration svelte-9n45fh")},m(i,r){z(i,e,r),n[24](e)},p:be,d(i){i&&w(e),n[24](null)}}}function Jt(n){let e,t=_e(n[15])+"",i;return{c(){e=M("time"),i=te(t),this.h()},l(r){e=A(r,"TIME",{class:!0});var s=B(e);i=ie(s,t),s.forEach(w),this.h()},h(){T(e,"class","duration svelte-9n45fh")},m(r,s){z(r,e,s),p(e,i)},p(r,s){s[0]&32768&&t!==(t=_e(r[15])+"")&&ne(i,t)},d(r){r&&w(e)}}}function Ke(n){let e,t,i;function r(l){n[25](l)}let s={i18n:n[1],timing:n[16],recording:n[5],show_recording_waveform:n[2].show_recording_waveform,record_time:_e(n[15])};return n[7]!==void 0&&(s.record=n[7]),e=new Yt({props:s}),j.push(()=>se(e,"record",r)),{c(){J(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,u){Q(e,l,u),i=!0},p(l,u){const f={};u[0]&2&&(f.i18n=l[1]),u[0]&65536&&(f.timing=l[16]),u[0]&32&&(f.recording=l[5]),u[0]&4&&(f.show_recording_waveform=l[2].show_recording_waveform),u[0]&32768&&(f.record_time=_e(l[15])),!t&&u[0]&128&&(t=!0,f.record=l[7],le(()=>t=!1)),e.$set(f)},i(l){i||(P(e.$$.fragment,l),i=!0)},o(l){S(e.$$.fragment,l),i=!1},d(l){X(e,l)}}}function Qe(n){let e,t,i,r,s;function l(o){n[26](o)}function u(o){n[27](o)}function f(o){n[28](o)}let a={container:n[11],playing:n[10],audio_duration:n[14],i18n:n[1],editable:n[4],interactive:!0,handle_trim_audio:n[18],show_redo:!0,handle_reset_value:n[3],waveform_options:n[2]};return n[6]!==void 0&&(a.waveform=n[6]),n[17]!==void 0&&(a.trimDuration=n[17]),n[0]!==void 0&&(a.mode=n[0]),e=new St({props:a}),j.push(()=>se(e,"waveform",l)),j.push(()=>se(e,"trimDuration",u)),j.push(()=>se(e,"mode",f)),{c(){J(e.$$.fragment)},l(o){K(e.$$.fragment,o)},m(o,d){Q(e,o,d),s=!0},p(o,d){const c={};d[0]&2048&&(c.container=o[11]),d[0]&1024&&(c.playing=o[10]),d[0]&16384&&(c.audio_duration=o[14]),d[0]&2&&(c.i18n=o[1]),d[0]&16&&(c.editable=o[4]),d[0]&8&&(c.handle_reset_value=o[3]),d[0]&4&&(c.waveform_options=o[2]),!t&&d[0]&64&&(t=!0,c.waveform=o[6],le(()=>t=!1)),!i&&d[0]&131072&&(i=!0,c.trimDuration=o[17],le(()=>i=!1)),!r&&d[0]&1&&(r=!0,c.mode=o[0],le(()=>r=!1)),e.$set(c)},i(o){s||(P(e.$$.fragment,o),s=!0)},o(o){S(e.$$.fragment,o),s=!1},d(o){X(e,o)}}}function Kt(n){let e,t,i,r,s,l,u,f,a=(n[16]||n[13])&&n[2].show_recording_waveform&&Ge(n),o=n[12]&&!n[13]&&Ke(n),d=n[6]&&n[13]&&Qe(n);return{c(){e=M("div"),t=M("div"),i=U(),r=M("div"),s=U(),a&&a.c(),l=U(),o&&o.c(),u=U(),d&&d.c(),this.h()},l(c){e=A(c,"DIV",{class:!0});var g=B(e);t=A(g,"DIV",{class:!0,"data-testid":!0}),B(t).forEach(w),i=N(g),r=A(g,"DIV",{"data-testid":!0}),B(r).forEach(w),s=N(g),a&&a.l(g),l=N(g),o&&o.l(g),u=N(g),d&&d.l(g),g.forEach(w),this.h()},h(){T(t,"class","microphone svelte-9n45fh"),T(t,"data-testid","microphone-waveform"),T(r,"data-testid","recording-waveform"),T(e,"class","component-wrapper svelte-9n45fh")},m(c,g){z(c,e,g),p(e,t),n[21](t),p(e,i),p(e,r),n[22](r),p(e,s),a&&a.m(e,null),p(e,l),o&&o.m(e,null),p(e,u),d&&d.m(e,null),f=!0},p(c,g){(c[16]||c[13])&&c[2].show_recording_waveform?a?a.p(c,g):(a=Ge(c),a.c(),a.m(e,l)):a&&(a.d(1),a=null),c[12]&&!c[13]?o?(o.p(c,g),g[0]&12288&&P(o,1)):(o=Ke(c),o.c(),P(o,1),o.m(e,u)):o&&(ke(),S(o,1,1,()=>{o=null}),ye()),c[6]&&c[13]?d?(d.p(c,g),g[0]&8256&&P(d,1)):(d=Qe(c),d.c(),P(d,1),d.m(e,null)):d&&(ke(),S(d,1,1,()=>{d=null}),ye())},i(c){f||(P(o),P(d),f=!0)},o(c){S(o),S(d),f=!1},d(c){c&&w(e),n[21](null),n[22](null),a&&a.d(),o&&o.d(),d&&d.d()}}}function Qt(n,e,t){let{mode:i}=e,{i18n:r}=e,{dispatch_blob:s}=e,{waveform_settings:l}=e,{waveform_options:u={show_recording_waveform:!0}}=e,{handle_reset_value:f}=e,{editable:a=!0}=e,{recording:o=!1}=e,d,c,g=!1,D,I,m,E=null,h,v,C,y=0,F,Y=!1,H=0;const oe=()=>{clearInterval(F),F=setInterval(()=>{t(15,y++,y)},1e3)},O=Se();function k(){if(oe(),t(16,Y=!0),O("start_recording"),u.show_recording_waveform){let b=I;b&&(b.style.display="block")}}async function Z(b){t(15,y=0),t(16,Y=!1),clearInterval(F);try{const re=await b.arrayBuffer(),ve=await new AudioContext({sampleRate:l.sampleRate}).decodeAudioData(re);ve&&await He(ve).then(async G=>{await s([G],"change"),await s([G],"stop_recording")})}catch(re){console.error(re)}}const V=()=>{I&&t(12,I.innerHTML="",I),d!==void 0&&d.destroy(),I&&(d=Le.create({...l,normalize:!1,container:I}),t(7,m=d.registerPlugin(Ie.create())),m==null||m.on("record-end",Z),m==null||m.on("record-start",k),m==null||m.on("record-pause",()=>{O("pause_recording"),clearInterval(F)}),m==null||m.on("record-end",b=>{t(13,E=URL.createObjectURL(b));const re=I,ce=D;re&&(re.style.display="none"),ce&&E&&(ce.innerHTML="",fe())}))},fe=()=>{let b=D;!E||!b||t(6,c=Le.create({container:b,url:E,...l}))},ae=async(b,re)=>{t(0,i="edit");const ce=c.getDecodedData();ce&&await He(ce,b,re).then(async ve=>{await s([ve],"change"),await s([ve],"stop_recording"),c.destroy(),fe()}),O("edit")};We(()=>{V(),window.addEventListener("keydown",b=>{b.key==="ArrowRight"?je(c,.1):b.key==="ArrowLeft"&&je(c,-.1)})});function L(b){j[b?"unshift":"push"](()=>{I=b,t(12,I)})}function q(b){j[b?"unshift":"push"](()=>{D=b,t(11,D)})}function R(b){j[b?"unshift":"push"](()=>{h=b,t(8,h),t(6,c)})}function x(b){j[b?"unshift":"push"](()=>{v=b,t(9,v),t(6,c)})}function $(b){m=b,t(7,m)}function ee(b){c=b,t(6,c)}function ue(b){H=b,t(17,H)}function me(b){i=b,t(0,i)}return n.$$set=b=>{"mode"in b&&t(0,i=b.mode),"i18n"in b&&t(1,r=b.i18n),"dispatch_blob"in b&&t(19,s=b.dispatch_blob),"waveform_settings"in b&&t(20,l=b.waveform_settings),"waveform_options"in b&&t(2,u=b.waveform_options),"handle_reset_value"in b&&t(3,f=b.handle_reset_value),"editable"in b&&t(4,a=b.editable),"recording"in b&&t(5,o=b.recording)},n.$$.update=()=>{n.$$.dirty[0]&128&&(m==null||m.on("record-resume",()=>{oe()})),n.$$.dirty[0]&576&&(c==null||c.on("decode",b=>{t(14,C=b),v&&t(9,v.textContent=_e(b),v)})),n.$$.dirty[0]&320&&(c==null||c.on("timeupdate",b=>h&&t(8,h.textContent=_e(b),h))),n.$$.dirty[0]&64&&(c==null||c.on("pause",()=>{O("pause"),t(10,g=!1)})),n.$$.dirty[0]&64&&(c==null||c.on("play",()=>{O("play"),t(10,g=!0)})),n.$$.dirty[0]&64&&(c==null||c.on("finish",()=>{O("stop"),t(10,g=!1)}))},[i,r,u,f,a,o,c,m,h,v,g,D,I,E,C,y,Y,H,ae,s,l,L,q,R,x,$,ee,ue,me]}class Xt extends De{constructor(e){super(),Re(this,e,Qt,Kt,Te,{mode:0,i18n:1,dispatch_blob:19,waveform_settings:20,waveform_options:2,handle_reset_value:3,editable:4,recording:5},null,[-1,-1])}}function Xe(n){let e;return{c(){e=M("div"),this.h()},l(t){e=A(t,"DIV",{}),B(e).forEach(w),this.h()},h(){ze(e,"display",n[0]?"block":"none")},m(t,i){z(t,e,i),n[11](e)},p(t,i){i&1&&ze(e,"display",t[0]?"block":"none")},d(t){t&&w(e),n[11](null)}}}function Zt(n){let e,t,i='<span class="dot"></span>',r,s=n[4]("audio.record")+"",l,u,f;return{c(){e=M("button"),t=M("span"),t.innerHTML=i,r=U(),l=te(s),this.h()},l(a){e=A(a,"BUTTON",{class:!0});var o=B(e);t=A(o,"SPAN",{class:!0,"data-svelte-h":!0}),Me(t)!=="svelte-1dwz2xe"&&(t.innerHTML=i),r=N(o),l=ie(o,s),o.forEach(w),this.h()},h(){T(t,"class","record-icon"),T(e,"class","record-button svelte-1fz19cj")},m(a,o){z(a,e,o),p(e,t),p(e,r),p(e,l),u||(f=de(e,"click",n[14]),u=!0)},p(a,o){o&16&&s!==(s=a[4]("audio.record")+"")&&ne(l,s)},i:be,o:be,d(a){a&&w(e),u=!1,f()}}}function Wt(n){let e,t,i,r,s=n[4]("audio.waiting")+"",l,u,f,a;return i=new At({}),{c(){e=M("button"),t=M("div"),J(i.$$.fragment),r=U(),l=te(s),this.h()},l(o){e=A(o,"BUTTON",{class:!0});var d=B(e);t=A(d,"DIV",{class:!0});var c=B(t);K(i.$$.fragment,c),c.forEach(w),r=N(d),l=ie(d,s),d.forEach(w),this.h()},h(){T(t,"class","icon svelte-1fz19cj"),T(e,"class","spinner-button svelte-1fz19cj")},m(o,d){z(o,e,d),p(e,t),Q(i,t,null),p(e,r),p(e,l),u=!0,f||(a=de(e,"click",n[13]),f=!0)},p(o,d){(!u||d&16)&&s!==(s=o[4]("audio.waiting")+"")&&ne(l,s)},i(o){u||(P(i.$$.fragment,o),u=!0)},o(o){S(i.$$.fragment,o),u=!1},d(o){o&&w(e),X(i),f=!1,a()}}}function xt(n){let e,t,i='<span class="pinger"></span> <span class="dot"></span>',r,s=(n[1]?n[4]("audio.pause"):n[4]("audio.stop"))+"",l,u,f,a;return{c(){e=M("button"),t=M("span"),t.innerHTML=i,r=U(),l=te(s),this.h()},l(o){e=A(o,"BUTTON",{class:!0});var d=B(e);t=A(d,"SPAN",{class:!0,"data-svelte-h":!0}),Me(t)!=="svelte-bla7qm"&&(t.innerHTML=i),r=N(d),l=ie(d,s),d.forEach(w),this.h()},h(){T(t,"class","record-icon"),T(e,"class",u=Ve(n[1]?"stop-button-paused":"stop-button")+" svelte-1fz19cj")},m(o,d){z(o,e,d),p(e,t),p(e,r),p(e,l),f||(a=de(e,"click",n[12]),f=!0)},p(o,d){d&18&&s!==(s=(o[1]?o[4]("audio.pause"):o[4]("audio.stop"))+"")&&ne(l,s),d&2&&u!==(u=Ve(o[1]?"stop-button-paused":"stop-button")+" svelte-1fz19cj")&&T(e,"class",u)},i:be,o:be,d(o){o&&w(e),f=!1,a()}}}function $t(n){let e,t,i,r,s,l,u,f,a,o=n[5].show_recording_waveform&&Xe(n);const d=[xt,Wt,Zt],c=[];function g(m,E){return m[0]&&!m[6]?0:m[0]&&m[6]?1:2}r=g(n),s=c[r]=d[r](n);function D(m){n[15](m)}let I={i18n:n[4]};return n[9]!==void 0&&(I.micDevices=n[9]),u=new $e({props:I}),j.push(()=>se(u,"micDevices",D)),{c(){e=M("div"),o&&o.c(),t=U(),i=M("div"),s.c(),l=U(),J(u.$$.fragment),this.h()},l(m){e=A(m,"DIV",{class:!0});var E=B(e);o&&o.l(E),t=N(E),i=A(E,"DIV",{class:!0});var h=B(i);s.l(h),l=N(h),K(u.$$.fragment,h),h.forEach(w),E.forEach(w),this.h()},h(){T(i,"class","controls svelte-1fz19cj"),T(e,"class","mic-wrap svelte-1fz19cj")},m(m,E){z(m,e,E),o&&o.m(e,null),p(e,t),p(e,i),c[r].m(i,null),p(i,l),Q(u,i,null),a=!0},p(m,[E]){m[5].show_recording_waveform?o?o.p(m,E):(o=Xe(m),o.c(),o.m(e,t)):o&&(o.d(1),o=null);let h=r;r=g(m),r===h?c[r].p(m,E):(ke(),S(c[h],1,1,()=>{c[h]=null}),ye(),s=c[r],s?s.p(m,E):(s=c[r]=d[r](m),s.c()),P(s,1),s.m(i,l));const v={};E&16&&(v.i18n=m[4]),!f&&E&512&&(f=!0,v.micDevices=m[9],le(()=>f=!1)),u.$set(v)},i(m){a||(P(s),P(u.$$.fragment,m),a=!0)},o(m){S(s),S(u.$$.fragment,m),a=!1},d(m){m&&w(e),o&&o.d(),c[r].d(),X(u)}}}function ei(n,e,t){let{recording:i=!1}=e,{paused_recording:r=!1}=e,{stop:s}=e,{record:l}=e,{i18n:u}=e,{waveform_settings:f}=e,{waveform_options:a={show_recording_waveform:!0}}=e,{waiting:o=!1}=e,d,c,g,D=[];We(()=>{I()});const I=()=>{d!==void 0&&d.destroy(),g&&(d=Le.create({...f,height:100,container:g}),t(7,c=d.registerPlugin(Ie.create())))};function m(y){j[y?"unshift":"push"](()=>{g=y,t(8,g)})}const E=()=>{c==null||c.stopMic(),s()},h=()=>{s()},v=()=>{c==null||c.startMic(),l()};function C(y){D=y,t(9,D)}return n.$$set=y=>{"recording"in y&&t(0,i=y.recording),"paused_recording"in y&&t(1,r=y.paused_recording),"stop"in y&&t(2,s=y.stop),"record"in y&&t(3,l=y.record),"i18n"in y&&t(4,u=y.i18n),"waveform_settings"in y&&t(10,f=y.waveform_settings),"waveform_options"in y&&t(5,a=y.waveform_options),"waiting"in y&&t(6,o=y.waiting)},[i,r,s,l,u,a,o,c,g,D,f,m,E,h,v,C]}class ti extends De{constructor(e){super(),Re(this,e,ei,$t,Te,{recording:0,paused_recording:1,stop:2,record:3,i18n:4,waveform_settings:10,waveform_options:5,waiting:6})}}function ii(n){var f;let e,t,i,r,s;e=new xe({props:{i18n:n[13],download:n[10]?n[2].url:null}}),e.$on("clear",n[29]),e.$on("edit",n[48]);function l(a){n[49](a)}let u={value:n[2],subtitles:Array.isArray(n[5])?n[5]:(f=n[5])==null?void 0:f.url,label:n[6],i18n:n[13],dispatch_blob:n[27],waveform_settings:n[14],waveform_options:n[16],trim_region_settings:n[15],handle_reset_value:n[17],editable:n[18],loop:n[8],interactive:!0};return n[25]!==void 0&&(u.mode=n[25]),i=new Bt({props:u}),j.push(()=>se(i,"mode",l)),i.$on("stop",n[50]),i.$on("play",n[51]),i.$on("pause",n[52]),i.$on("edit",n[53]),{c(){J(e.$$.fragment),t=U(),J(i.$$.fragment)},l(a){K(e.$$.fragment,a),t=N(a),K(i.$$.fragment,a)},m(a,o){Q(e,a,o),z(a,t,o),Q(i,a,o),s=!0},p(a,o){var g;const d={};o[0]&8192&&(d.i18n=a[13]),o[0]&1028&&(d.download=a[10]?a[2].url:null),e.$set(d);const c={};o[0]&4&&(c.value=a[2]),o[0]&32&&(c.subtitles=Array.isArray(a[5])?a[5]:(g=a[5])==null?void 0:g.url),o[0]&64&&(c.label=a[6]),o[0]&8192&&(c.i18n=a[13]),o[0]&16384&&(c.waveform_settings=a[14]),o[0]&65536&&(c.waveform_options=a[16]),o[0]&32768&&(c.trim_region_settings=a[15]),o[0]&131072&&(c.handle_reset_value=a[17]),o[0]&262144&&(c.editable=a[18]),o[0]&256&&(c.loop=a[8]),!r&&o[0]&33554432&&(r=!0,c.mode=a[25],le(()=>r=!1)),i.$set(c)},i(a){s||(P(e.$$.fragment,a),P(i.$$.fragment,a),s=!0)},o(a){S(e.$$.fragment,a),S(i.$$.fragment,a),s=!1},d(a){a&&w(t),X(e,a),X(i,a)}}}function ni(n){let e,t,i,r;const s=[ri,oi],l=[];function u(f,a){return f[3]==="microphone"?0:f[3]==="upload"?1:-1}return~(e=u(n))&&(t=l[e]=s[e](n)),{c(){t&&t.c(),i=pe()},l(f){t&&t.l(f),i=pe()},m(f,a){~e&&l[e].m(f,a),z(f,i,a),r=!0},p(f,a){let o=e;e=u(f),e===o?~e&&l[e].p(f,a):(t&&(ke(),S(l[o],1,1,()=>{l[o]=null}),ye()),~e?(t=l[e],t?t.p(f,a):(t=l[e]=s[e](f),t.c()),P(t,1),t.m(i.parentNode,i)):t=null)},i(f){r||(P(t),r=!0)},o(f){S(t),r=!1},d(f){f&&w(i),~e&&l[e].d(f)}}}function oi(n){let e,t,i,r;function s(f){n[45](f)}function l(f){n[46](f)}let u={filetype:"audio/aac,audio/midi,audio/mpeg,audio/ogg,audio/wav,audio/x-wav,audio/opus,audio/webm,audio/flac,audio/vnd.rn-realaudio,audio/x-ms-wma,audio/x-aiff,audio/amr,audio/*",root:n[7],max_file_size:n[19],upload:n[20],stream_handler:n[21],aria_label:n[13]("audio.drop_to_upload"),$$slots:{default:[si]},$$scope:{ctx:n}};return n[0]!==void 0&&(u.dragging=n[0]),n[4]!==void 0&&(u.uploading=n[4]),e=new Rt({props:u}),j.push(()=>se(e,"dragging",s)),j.push(()=>se(e,"uploading",l)),e.$on("load",n[30]),e.$on("error",n[47]),{c(){J(e.$$.fragment)},l(f){K(e.$$.fragment,f)},m(f,a){Q(e,f,a),r=!0},p(f,a){const o={};a[0]&128&&(o.root=f[7]),a[0]&524288&&(o.max_file_size=f[19]),a[0]&1048576&&(o.upload=f[20]),a[0]&2097152&&(o.stream_handler=f[21]),a[0]&8192&&(o.aria_label=f[13]("audio.drop_to_upload")),a[1]&16777216&&(o.$$scope={dirty:a,ctx:f}),!t&&a[0]&1&&(t=!0,o.dragging=f[0],le(()=>t=!1)),!i&&a[0]&16&&(i=!0,o.uploading=f[4],le(()=>i=!1)),e.$set(o)},i(f){r||(P(e.$$.fragment,f),r=!0)},o(f){S(e.$$.fragment,f),r=!1},d(f){X(e,f)}}}function ri(n){let e,t,i,r,s,l;e=new xe({props:{i18n:n[13]}}),e.$on("clear",n[29]);const u=[ai,li],f=[];function a(o,d){return o[12]?0:1}return i=a(n),r=f[i]=u[i](n),{c(){J(e.$$.fragment),t=U(),r.c(),s=pe()},l(o){K(e.$$.fragment,o),t=N(o),r.l(o),s=pe()},m(o,d){Q(e,o,d),z(o,t,d),f[i].m(o,d),z(o,s,d),l=!0},p(o,d){const c={};d[0]&8192&&(c.i18n=o[13]),e.$set(c);let g=i;i=a(o),i===g?f[i].p(o,d):(ke(),S(f[g],1,1,()=>{f[g]=null}),ye(),r=f[i],r?r.p(o,d):(r=f[i]=u[i](o),r.c()),P(r,1),r.m(s.parentNode,s))},i(o){l||(P(e.$$.fragment,o),P(r),l=!0)},o(o){S(e.$$.fragment,o),S(r),l=!1},d(o){o&&(w(t),w(s)),X(e,o),f[i].d(o)}}}function si(n){let e;const t=n[40].default,i=kt(t,n,n[55],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,s){i&&i.m(r,s),e=!0},p(r,s){i&&i.p&&(!e||s[1]&16777216)&&yt(i,t,r,r[55],e?Dt(t,r[55],s,null):Et(r[55]),null)},i(r){e||(P(i,r),e=!0)},o(r){S(i,r),e=!1},d(r){i&&i.d(r)}}}function li(n){let e,t,i;function r(l){n[41](l)}let s={i18n:n[13],editable:n[18],recording:n[1],dispatch_blob:n[27],waveform_settings:n[14],waveform_options:n[16],handle_reset_value:n[17]};return n[25]!==void 0&&(s.mode=n[25]),e=new Xt({props:s}),j.push(()=>se(e,"mode",r)),e.$on("start_recording",n[42]),e.$on("pause_recording",n[43]),e.$on("stop_recording",n[44]),{c(){J(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,u){Q(e,l,u),i=!0},p(l,u){const f={};u[0]&8192&&(f.i18n=l[13]),u[0]&262144&&(f.editable=l[18]),u[0]&2&&(f.recording=l[1]),u[0]&16384&&(f.waveform_settings=l[14]),u[0]&65536&&(f.waveform_options=l[16]),u[0]&131072&&(f.handle_reset_value=l[17]),!t&&u[0]&33554432&&(t=!0,f.mode=l[25],le(()=>t=!1)),e.$set(f)},i(l){i||(P(e.$$.fragment,l),i=!0)},o(l){S(e.$$.fragment,l),i=!1},d(l){X(e,l)}}}function ai(n){let e,t;return e=new ti({props:{record:n[28],recording:n[1],stop:n[31],i18n:n[13],waveform_settings:n[14],waveform_options:n[16],waiting:n[24]==="waiting"}}),{c(){J(e.$$.fragment)},l(i){K(e.$$.fragment,i)},m(i,r){Q(e,i,r),t=!0},p(i,r){const s={};r[0]&2&&(s.recording=i[1]),r[0]&8192&&(s.i18n=i[13]),r[0]&16384&&(s.waveform_settings=i[14]),r[0]&65536&&(s.waveform_options=i[16]),r[0]&16777216&&(s.waiting=i[24]==="waiting"),e.$set(s)},i(i){t||(P(e.$$.fragment,i),t=!0)},o(i){S(e.$$.fragment,i),t=!1},d(i){X(e,i)}}}function ui(n){let e,t,i,r,s,l,u,f,a,o,d,c;e=new It({props:{show_label:n[9],Icon:Mt,float:n[3]==="upload"&&n[2]===null,label:n[6]||n[13]("audio.audio")}}),r=new Lt({props:{time_limit:n[23]}});const g=[ni,ii],D=[];function I(h,v){return h[2]===null||h[12]?0:1}l=I(n),u=D[l]=g[l](n);function m(h){n[54](h)}let E={sources:n[11],handle_clear:n[29]};return n[3]!==void 0&&(E.active_source=n[3]),a=new Pt({props:E}),j.push(()=>se(a,"active_source",m)),{c(){J(e.$$.fragment),t=U(),i=M("div"),J(r.$$.fragment),s=U(),u.c(),f=U(),J(a.$$.fragment),this.h()},l(h){K(e.$$.fragment,h),t=N(h),i=A(h,"DIV",{class:!0});var v=B(i);K(r.$$.fragment,v),s=N(v),u.l(v),f=N(v),K(a.$$.fragment,v),v.forEach(w),this.h()},h(){T(i,"class",d="audio-container "+n[22]+" svelte-1ud6e7m")},m(h,v){Q(e,h,v),z(h,t,v),z(h,i,v),Q(r,i,null),p(i,s),D[l].m(i,null),p(i,f),Q(a,i,null),c=!0},p(h,v){const C={};v[0]&512&&(C.show_label=h[9]),v[0]&12&&(C.float=h[3]==="upload"&&h[2]===null),v[0]&8256&&(C.label=h[6]||h[13]("audio.audio")),e.$set(C);const y={};v[0]&8388608&&(y.time_limit=h[23]),r.$set(y);let F=l;l=I(h),l===F?D[l].p(h,v):(ke(),S(D[F],1,1,()=>{D[F]=null}),ye(),u=D[l],u?u.p(h,v):(u=D[l]=g[l](h),u.c()),P(u,1),u.m(i,f));const Y={};v[0]&2048&&(Y.sources=h[11]),!o&&v[0]&8&&(o=!0,Y.active_source=h[3],le(()=>o=!1)),a.$set(Y),(!c||v[0]&4194304&&d!==(d="audio-container "+h[22]+" svelte-1ud6e7m"))&&T(i,"class",d)},i(h){c||(P(e.$$.fragment,h),P(r.$$.fragment,h),P(u),P(a.$$.fragment,h),c=!0)},o(h){S(e.$$.fragment,h),S(r.$$.fragment,h),S(u),S(a.$$.fragment,h),c=!1},d(h){h&&(w(t),w(i)),X(e,h),X(r),D[l].d(),X(a)}}}const Ze=44;function fi(n,e,t){let{$$slots:i={},$$scope:r}=e,{value:s=null}=e,{subtitles:l=null}=e,{label:u}=e,{root:f}=e,{loop:a}=e,{show_label:o=!0}=e,{show_download_button:d=!1}=e,{sources:c=["microphone","upload"]}=e,{pending:g=!1}=e,{streaming:D=!1}=e,{i18n:I}=e,{waveform_settings:m}=e,{trim_region_settings:E={}}=e,{waveform_options:h={}}=e,{dragging:v}=e,{active_source:C}=e,{handle_reset_value:y=()=>{}}=e,{editable:F=!0}=e,{max_file_size:Y=null}=e,{upload:H}=e,{stream_handler:oe}=e,{stream_every:O}=e,{uploading:k=!1}=e,{recording:Z=!1}=e,{class_name:V=""}=e,fe=null,ae="closed";const L=_=>{_==="closed"?(t(23,fe=null),t(24,ae="closed")):_==="waiting"?t(24,ae="waiting"):t(24,ae="open")},q=_=>{Z&&t(23,fe=_)};let R,x="",$,ee=[],ue=!1,me=!1,b=[],re;function ce(){re=[Ue(()=>import("./module.P_aKkXCo.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url),Ue(()=>import("./module.niXGEr8P.js"),__vite__mapDeps([7,1]),import.meta.url)]}typeof window<"u"&&D&&ce();const G=Se(),we=async(_,W)=>{var Oe;let he=new File(_,"audio.wav");const Ee=await Tt([he],W==="stream");t(2,s=(Oe=await H(Ee,f,void 0,Y||void 0))==null?void 0:Oe.filter(Boolean)[0]),G(W,s)};pt(()=>{D&&R&&R.state!=="inactive"&&R.stop()});async function et(){let _;try{_=await navigator.mediaDevices.getUserMedia({audio:!0})}catch(W){if(!navigator.mediaDevices){G("error",I("audio.no_device_support"));return}if(W instanceof DOMException&&W.name=="NotAllowedError"){G("error",I("audio.allow_recording_access"));return}throw W}if(_!=null){if(D){const[{MediaRecorder:W,register:he},{connect:Ee}]=await Promise.all(re);await he(await Ee()),t(36,R=new W(_,{mimeType:"audio/wav"})),R.addEventListener("dataavailable",tt)}else t(36,R=new MediaRecorder(_)),R.addEventListener("dataavailable",W=>{b.push(W.data)});R.addEventListener("stop",async()=>{t(1,Z=!1),await we(b,"change"),await we(b,"stop_recording"),b=[]}),me=!0}}async function tt(_){let W=await _.data.arrayBuffer(),he=new Uint8Array(W);if($||(t(37,$=new Uint8Array(W.slice(0,Ze))),he=new Uint8Array(W.slice(Ze))),g)ee.push(he);else{let Ee=[$].concat(ee,[he]);if(!Z||ae==="waiting")return;we(Ee,"stream"),t(38,ee=[])}}async function Be(){t(1,Z=!0),G("start_recording"),me||await et(),t(37,$=void 0),D&&R.state!="recording"&&R.start(O*1e3)}function it(){G("change",null),G("clear"),t(25,x=""),t(2,s=null)}function nt({detail:_}){t(2,s=_),G("change",_),G("upload",_)}async function Ce(){t(1,Z=!1),D&&(G("close_stream"),G("stop_recording"),R.stop(),g&&t(39,ue=!0),we(b,"stop_recording"),G("clear"),t(25,x=""))}function ot(_){x=_,t(25,x)}function rt(_){ge.call(this,n,_)}function st(_){ge.call(this,n,_)}function lt(_){ge.call(this,n,_)}function at(_){v=_,t(0,v)}function ut(_){k=_,t(4,k)}const ft=({detail:_})=>G("error",_),ct=()=>t(25,x="edit");function dt(_){x=_,t(25,x)}function _t(_){ge.call(this,n,_)}function mt(_){ge.call(this,n,_)}function ht(_){ge.call(this,n,_)}function gt(_){ge.call(this,n,_)}function bt(_){C=_,t(3,C)}return n.$$set=_=>{"value"in _&&t(2,s=_.value),"subtitles"in _&&t(5,l=_.subtitles),"label"in _&&t(6,u=_.label),"root"in _&&t(7,f=_.root),"loop"in _&&t(8,a=_.loop),"show_label"in _&&t(9,o=_.show_label),"show_download_button"in _&&t(10,d=_.show_download_button),"sources"in _&&t(11,c=_.sources),"pending"in _&&t(32,g=_.pending),"streaming"in _&&t(12,D=_.streaming),"i18n"in _&&t(13,I=_.i18n),"waveform_settings"in _&&t(14,m=_.waveform_settings),"trim_region_settings"in _&&t(15,E=_.trim_region_settings),"waveform_options"in _&&t(16,h=_.waveform_options),"dragging"in _&&t(0,v=_.dragging),"active_source"in _&&t(3,C=_.active_source),"handle_reset_value"in _&&t(17,y=_.handle_reset_value),"editable"in _&&t(18,F=_.editable),"max_file_size"in _&&t(19,Y=_.max_file_size),"upload"in _&&t(20,H=_.upload),"stream_handler"in _&&t(21,oe=_.stream_handler),"stream_every"in _&&t(33,O=_.stream_every),"uploading"in _&&t(4,k=_.uploading),"recording"in _&&t(1,Z=_.recording),"class_name"in _&&t(22,V=_.class_name),"$$scope"in _&&t(55,r=_.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&1&&G("drag",v),n.$$.dirty[1]&450&&ue&&g===!1&&(t(39,ue=!1),$&&ee)){let _=[$].concat(ee);t(38,ee=[]),we(_,"stream")}n.$$.dirty[0]&2|n.$$.dirty[1]&32&&!Z&&R&&Ce(),n.$$.dirty[0]&2|n.$$.dirty[1]&32&&Z&&R&&Be()},[v,Z,s,C,k,l,u,f,a,o,d,c,D,I,m,E,h,y,F,Y,H,oe,V,fe,ae,x,G,we,Be,it,nt,Ce,g,O,L,q,R,$,ee,ue,i,ot,rt,st,lt,at,ut,ft,ct,dt,_t,mt,ht,gt,bt,r]}class ci extends De{constructor(e){super(),Re(this,e,fi,ui,Te,{value:2,subtitles:5,label:6,root:7,loop:8,show_label:9,show_download_button:10,sources:11,pending:32,streaming:12,i18n:13,waveform_settings:14,trim_region_settings:15,waveform_options:16,dragging:0,active_source:3,handle_reset_value:17,editable:18,max_file_size:19,upload:20,stream_handler:21,stream_every:33,uploading:4,recording:1,class_name:22,modify_stream:34,set_time_limit:35},null,[-1,-1,-1])}get modify_stream(){return this.$$.ctx[34]}get set_time_limit(){return this.$$.ctx[35]}}const Di=ci;export{Di as I};
//# sourceMappingURL=InteractiveAudio.BnccbLEr.js.map
