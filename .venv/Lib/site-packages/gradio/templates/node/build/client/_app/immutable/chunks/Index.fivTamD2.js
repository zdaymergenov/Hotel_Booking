import{SvelteComponent as he,init as _e,safe_not_equal as ve,element as b,space as P,text as R,claim_element as g,children as y,detach as _,claim_space as S,get_svelte_dataset as Q,claim_text as A,attr as m,toggle_class as L,set_style as te,insert_hydration as z,append_hydration as f,set_input_value as se,listen as U,group_outros as me,transition_out as Z,check_outros as pe,transition_in as x,run_all as be,onMount as ge,set_data as $,binding_callbacks as fe,bind as qe,create_component as ke,claim_component as Ee,mount_component as ye,add_flush_callback as we,destroy_component as Ce,ensure_array_like as le,noop as ne,destroy_each as Te}from"../../../svelte/svelte.js";import"../../../svelte/svelte-submodules.js";import"./2.BPD7TSJN.js";import{C as Be}from"./Code.3zyYjZs4.js";/* empty css                                              */function oe(i,e,o){const t=i.slice();return t[24]=e[o],t[26]=o,t}function ie(i){let e,o,t=i[5].lines_added>0&&ae(i),s=i[5].lines_removed>0&&re(i);return{c(){e=b("span"),t&&t.c(),o=P(),s&&s.c(),this.h()},l(l){e=g(l,"SPAN",{class:!0});var n=y(e);t&&t.l(n),o=S(n),s&&s.l(n),n.forEach(_),this.h()},h(){m(e,"class","diff-stats svelte-fv4qq0")},m(l,n){z(l,e,n),t&&t.m(e,null),f(e,o),s&&s.m(e,null)},p(l,n){l[5].lines_added>0?t?t.p(l,n):(t=ae(l),t.c(),t.m(e,o)):t&&(t.d(1),t=null),l[5].lines_removed>0?s?s.p(l,n):(s=re(l),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(l){l&&_(e),t&&t.d(),s&&s.d()}}}function ae(i){let e,o,t=i[5].lines_added+"",s;return{c(){e=b("span"),o=R("+"),s=R(t),this.h()},l(l){e=g(l,"SPAN",{class:!0});var n=y(e);o=A(n,"+"),s=A(n,t),n.forEach(_),this.h()},h(){m(e,"class","added svelte-fv4qq0")},m(l,n){z(l,e,n),f(e,o),f(e,s)},p(l,n){n&32&&t!==(t=l[5].lines_added+"")&&$(s,t)},d(l){l&&_(e)}}}function re(i){let e,o,t=i[5].lines_removed+"",s;return{c(){e=b("span"),o=R("-"),s=R(t),this.h()},l(l){e=g(l,"SPAN",{class:!0});var n=y(e);o=A(n,"-"),s=A(n,t),n.forEach(_),this.h()},h(){m(e,"class","removed svelte-fv4qq0")},m(l,n){z(l,e,n),f(e,o),f(e,s)},p(l,n){n&32&&t!==(t=l[5].lines_removed+"")&&$(s,t)},d(l){l&&_(e)}}}function De(i){let e,o,t,s,l,n,c="Update Code",a,p,k;function E(u){i[16](u)}let d={language:"python",lines:10,dark_mode:!1,basic:!0,readonly:!1,placeholder:"Enter your code here...",wrap_lines:!0,show_line_numbers:!0,autocomplete:!1};return i[4]!==void 0&&(d.value=i[4]),t=new Be({props:d}),fe.push(()=>qe(t,"value",E)),{c(){e=b("div"),o=b("div"),ke(t.$$.fragment),l=P(),n=b("button"),n.textContent=c,this.h()},l(u){e=g(u,"DIV",{class:!0});var T=y(e);o=g(T,"DIV",{class:!0});var q=y(o);Ee(t.$$.fragment,q),q.forEach(_),l=S(T),n=g(T,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(n)!=="svelte-19j074w"&&(n.textContent=c),T.forEach(_),this.h()},h(){m(o,"class","code-editor-container svelte-fv4qq0"),m(n,"class","update-code-button svelte-fv4qq0"),m(e,"class","code-content svelte-fv4qq0")},m(u,T){z(u,e,T),f(e,o),ye(t,o,null),f(e,l),f(e,n),a=!0,p||(k=U(n,"click",i[10]),p=!0)},p(u,T){const q={};!s&&T&16&&(s=!0,q.value=u[4],we(()=>s=!1)),t.$set(q)},i(u){a||(x(t.$$.fragment,u),a=!0)},o(u){Z(t.$$.fragment,u),a=!1},d(u){u&&_(e),Ce(t),p=!1,k()}}}function Ie(i){let e,o,t=le(i[6]),s=[];for(let n=0;n<t.length;n+=1)s[n]=de(oe(i,t,n));let l=i[6].length===0&&ue();return{c(){e=b("div");for(let n=0;n<s.length;n+=1)s[n].c();o=P(),l&&l.c(),this.h()},l(n){e=g(n,"DIV",{class:!0});var c=y(e);for(let a=0;a<s.length;a+=1)s[a].l(c);o=S(c),l&&l.l(c),c.forEach(_),this.h()},h(){m(e,"class","message-history svelte-fv4qq0")},m(n,c){z(n,e,c);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);f(e,o),l&&l.m(e,null)},p(n,c){if(c&320){t=le(n[6]);let a;for(a=0;a<t.length;a+=1){const p=oe(n,t,a);s[a]?s[a].p(p,c):(s[a]=de(p),s[a].c(),s[a].m(e,o))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}n[6].length===0?l||(l=ue(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:ne,o:ne,d(n){n&&_(e),Te(s,n),l&&l.d()}}}function ce(i){let e,o="Undo",t,s;function l(){return i[15](i[24],i[26])}return{c(){e=b("button"),e.textContent=o,this.h()},l(n){e=g(n,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1hv8emy"&&(e.textContent=o),this.h()},h(){m(e,"class","undo-button svelte-fv4qq0"),m(e,"title","Undo this change")},m(n,c){z(n,e,c),t||(s=U(e,"click",l),t=!0)},p(n,c){i=n},d(n){n&&_(e),t=!1,s()}}}function de(i){let e,o,t,s=i[24].text+"",l,n,c=!i[24].isBot&&i[24].hash&&!i[24].isPending&&ce(i);return{c(){e=b("div"),o=b("div"),t=b("span"),l=R(s),n=P(),c&&c.c(),this.h()},l(a){e=g(a,"DIV",{class:!0});var p=y(e);o=g(p,"DIV",{class:!0});var k=y(o);t=g(k,"SPAN",{class:!0});var E=y(t);l=A(E,s),E.forEach(_),n=S(k),c&&c.l(k),k.forEach(_),p.forEach(_),this.h()},h(){m(t,"class","message-text svelte-fv4qq0"),m(o,"class","message-content svelte-fv4qq0"),m(e,"class","message-item svelte-fv4qq0"),L(e,"bot-message",i[24].isBot),L(e,"user-message",!i[24].isBot)},m(a,p){z(a,e,p),f(e,o),f(o,t),f(t,l),f(o,n),c&&c.m(o,null)},p(a,p){p&64&&s!==(s=a[24].text+"")&&$(l,s),!a[24].isBot&&a[24].hash&&!a[24].isPending?c?c.p(a,p):(c=ce(a),c.c(),c.m(o,null)):c&&(c.d(1),c=null),p&64&&L(e,"bot-message",a[24].isBot),p&64&&L(e,"user-message",!a[24].isBot)},d(a){a&&_(e),c&&c.d()}}}function ue(i){let e,o="No messages yet";return{c(){e=b("div"),e.textContent=o,this.h()},l(t){e=g(t,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1lmz9va"&&(e.textContent=o),this.h()},h(){m(e,"class","no-messages svelte-fv4qq0")},m(t,s){z(t,e,s)},d(t){t&&_(e)}}}function Ve(i){let e,o,t,s,l,n="Chat",c,a,p,k,E,d,u,T,q,I,O="Powered by: <code>gpt-oss</code>",H,D,X,V,G,j,N,K,Y,r=i[5]&&(i[5].lines_added>0||i[5].lines_removed>0)&&ie(i);const B=[Ie,De],w=[];function J(h,v){return h[3]==="chat"?0:h[3]==="code"?1:-1}return~(d=J(i))&&(u=w[d]=B[d](i)),{c(){e=b("div"),o=b("button"),t=P(),s=b("div"),l=b("button"),l.textContent=n,c=P(),a=b("button"),p=R(`Code
			`),r&&r.c(),k=P(),E=b("div"),u&&u.c(),T=P(),q=b("div"),I=b("div"),I.innerHTML=O,H=P(),D=b("textarea"),X=P(),V=b("button"),G=R("Send"),this.h()},l(h){e=g(h,"DIV",{class:!0,style:!0});var v=y(e);o=g(v,"BUTTON",{class:!0,"aria-label":!0}),y(o).forEach(_),t=S(v),s=g(v,"DIV",{class:!0});var C=y(s);l=g(C,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(l)!=="svelte-1jfn66n"&&(l.textContent=n),c=S(C),a=g(C,"BUTTON",{class:!0});var M=y(a);p=A(M,`Code
			`),r&&r.l(M),M.forEach(_),C.forEach(_),k=S(v),E=g(v,"DIV",{class:!0});var W=y(E);u&&u.l(W),W.forEach(_),T=S(v),q=g(v,"DIV",{class:!0});var F=y(q);I=g(F,"DIV",{class:!0,"data-svelte-h":!0}),Q(I)!=="svelte-4qz8uo"&&(I.innerHTML=O),H=S(F),D=g(F,"TEXTAREA",{placeholder:!0,class:!0}),y(D).forEach(_),X=S(F),V=g(F,"BUTTON",{class:!0});var ee=y(V);G=A(ee,"Send"),ee.forEach(_),F.forEach(_),v.forEach(_),this.h()},h(){m(o,"class","resize-handle svelte-fv4qq0"),m(o,"aria-label","Resize sidebar"),m(l,"class","tab-button svelte-fv4qq0"),L(l,"active",i[3]==="chat"),m(a,"class","tab-button svelte-fv4qq0"),L(a,"active",i[3]==="code"),m(s,"class","tab-header svelte-fv4qq0"),m(E,"class","tab-content svelte-fv4qq0"),m(I,"class","powered-by svelte-fv4qq0"),m(D,"placeholder","What can I add or change?"),m(D,"class","prompt-input svelte-fv4qq0"),m(V,"class","submit-button svelte-fv4qq0"),V.disabled=j=i[0].trim()==="",m(q,"class","input-section svelte-fv4qq0"),m(e,"class","vibe-editor svelte-fv4qq0"),te(e,"width",i[1]+"px")},m(h,v){z(h,e,v),f(e,o),f(e,t),f(e,s),f(s,l),f(s,c),f(s,a),f(a,p),r&&r.m(a,null),f(e,k),f(e,E),~d&&w[d].m(E,null),f(e,T),f(e,q),f(q,I),f(q,H),f(q,D),se(D,i[0]),f(q,X),f(q,V),f(V,G),i[19](e),N=!0,K||(Y=[U(o,"mousedown",i[9]),U(l,"click",i[13]),U(a,"click",i[14]),U(D,"keydown",i[17]),U(D,"input",i[18]),U(V,"click",i[7])],K=!0)},p(h,[v]){(!N||v&8)&&L(l,"active",h[3]==="chat"),h[5]&&(h[5].lines_added>0||h[5].lines_removed>0)?r?r.p(h,v):(r=ie(h),r.c(),r.m(a,null)):r&&(r.d(1),r=null),(!N||v&8)&&L(a,"active",h[3]==="code");let C=d;d=J(h),d===C?~d&&w[d].p(h,v):(u&&(me(),Z(w[C],1,1,()=>{w[C]=null}),pe()),~d?(u=w[d],u?u.p(h,v):(u=w[d]=B[d](h),u.c()),x(u,1),u.m(E,null)):u=null),v&1&&se(D,h[0]),(!N||v&1&&j!==(j=h[0].trim()===""))&&(V.disabled=j),(!N||v&2)&&te(e,"width",h[1]+"px")},i(h){N||(x(u),N=!0)},o(h){Z(u),N=!1},d(h){h&&_(e),r&&r.d(),~d&&w[d].d(),i[19](null),K=!1,be(Y)}}}function Ne(i,e,o){let{app:t}=e,{root:s}=e,l="",n=350,c=!1,a,p="chat",k="",E=null,d=[];const u=()=>{if(l.trim()==="")return;o(5,E=null);const r=d.length;o(6,d=[...d,{text:l,isBot:!1}]);const B=d.length;o(6,d=[...d,{text:"Working...",isBot:!0,isPending:!0}]);const w=l;o(0,l=""),t.post_data(`${s}/gradio_api/vibe-edit/`,{prompt:w}).then(([h,v])=>{if(v!==200)throw new Error(`Error: ${v}`);const C=h;o(5,E=C.diff_stats),o(6,d=d.map((M,W)=>(console.log(W,r,C.hash),W===r?{...M,hash:C.hash}:M))),o(6,d=d.map((M,W)=>W===B?{text:C.reasoning?C.reasoning:"Done.",isBot:!0,isPending:!1}:M))}).catch(h=>{o(6,d=d.map((v,C)=>C===B?{text:"Error occurred.",isBot:!0,isPending:!1}:v))})},T=async(r,B)=>{try{await t.post_data(`${s}/gradio_api/undo-vibe-edit/`,{hash:r}),o(5,E=null);const w=d[B];o(0,l=w.text),o(6,d=d.slice(0,B))}catch(w){console.error("Failed to undo:",w)}},q=r=>{r.preventDefault(),c=!0,document.addEventListener("mousemove",I),document.addEventListener("mouseup",O),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},I=r=>{if(!c)return;const B=250,w=Math.min(800,window.innerWidth*.5),J=window.innerWidth-r.clientX;o(1,n=Math.max(B,Math.min(w,J))),window.dispatchEvent(new CustomEvent("vibeEditorResize",{detail:{width:n}}))},O=()=>{c=!1,document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",O),document.body.style.cursor="",document.body.style.userSelect=""},H=async()=>{try{const r=await fetch(`${s}/gradio_api/vibe-code/`,{method:"GET",headers:{"Content-Type":"application/json"}});if(r.ok){const B=await r.json();o(4,k=B.code)}}catch(r){console.error("Failed to fetch code:",r)}},D=async()=>{try{await t.post_data(`${s}/gradio_api/vibe-code/`,{code:k})}catch(r){console.error("Failed to update code:",r)}};ge(()=>()=>{document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",O)});const X=()=>o(3,p="chat"),V=()=>o(3,p="code"),G=(r,B)=>T(r.hash||"",B);function j(r){k=r,o(4,k)}const N=r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),u())};function K(){l=this.value,o(0,l)}function Y(r){fe[r?"unshift":"push"](()=>{a=r,o(2,a)})}return i.$$set=r=>{"app"in r&&o(11,t=r.app),"root"in r&&o(12,s=r.root)},i.$$.update=()=>{i.$$.dirty&2048&&H()},[l,n,a,p,k,E,d,u,T,q,D,t,s,X,V,G,j,N,K,Y]}class Le extends he{constructor(e){super(),_e(this,e,Ne,Ve,ve,{app:11,root:12})}}export{Le as default};
//# sourceMappingURL=Index.fivTamD2.js.map
