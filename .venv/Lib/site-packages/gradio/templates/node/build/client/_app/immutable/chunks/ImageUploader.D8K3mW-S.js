import{SvelteComponent as ve,init as we,safe_not_equal as ke,svg_element as me,claim_svg_element as ge,children as B,detach as b,attr as g,insert_hydration as V,append_hydration as z,noop as x,element as N,create_component as j,space as A,text as se,claim_element as C,claim_component as P,claim_space as F,claim_text as ue,set_style as he,mount_component as R,listen as re,transition_in as w,transition_out as E,destroy_component as q,createEventDispatcher as We,toggle_class as Z,src_url_equal as Se,group_outros as $,check_outros as ee,onMount as et,onDestroy as tt,binding_callbacks as ae,empty as te,add_render_callback as lt,create_in_transition as it,stop_propagation as nt,action_destroyer as rt,run_all as Je,ensure_array_like as Ue,destroy_each as at,set_input_value as Oe,set_data as Ie,bind as be,add_flush_callback as pe,tick as ye,bubble as de,create_slot as ot,update_slot_base as st,get_all_dirty_from_scope as ut,get_slot_changes as ct}from"../../../svelte/svelte.js";import{fade as ft}from"../../../svelte/svelte-submodules.js";import{z as _t,P as dt,I as mt,j as gt,C as ht,q as bt}from"./2.BPD7TSJN.js";import{B as pt}from"./BlockLabel.B6sjuoOP.js";import{I as vt}from"./Image.CTVzPhL7.js";import{W as wt,a as kt,S as It}from"./SelectSource.BAYRyk3o.js";import{F as Et}from"./FullscreenButton.L5WHtCWr.js";import{g as yt}from"./utils.Gtzs_Zla.js";import{D as Ke}from"./DropdownArrow.Dsz0Zcs8.js";import{S as Dt}from"./StreamingBar.DqrTU_oA.js";import{a as zt}from"./Upload.DYS5R487.js";function Tt(n){let e,t,l;return{c(){e=me("svg"),t=me("path"),l=me("circle"),this.h()},l(i){e=ge(i,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0});var r=B(e);t=ge(r,"path",{d:!0}),B(t).forEach(b),l=ge(r,"circle",{cx:!0,cy:!0,r:!0}),B(l).forEach(b),r.forEach(b),this.h()},h(){g(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),g(l,"cx","12"),g(l,"cy","13"),g(l,"r","4"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 24 24"),g(e,"fill","none"),g(e,"stroke","currentColor"),g(e,"stroke-width","1.5"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),g(e,"class","feather feather-camera")},m(i,r){V(i,e,r),z(e,t),z(e,l)},p:x,i:x,o:x,d(i){i&&b(e)}}}class Bt extends ve{constructor(e){super(),we(this,e,null,Tt,ke,{})}}function Vt(n){let e,t;return{c(){e=me("svg"),t=me("circle"),this.h()},l(l){e=ge(l,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0});var i=B(e);t=ge(i,"circle",{cx:!0,cy:!0,r:!0}),B(t).forEach(b),i.forEach(b),this.h()},h(){g(t,"cx","12"),g(t,"cy","12"),g(t,"r","10"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width","1.5"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),g(e,"class","feather feather-circle")},m(l,i){V(l,e,i),z(e,t)},p:x,i:x,o:x,d(l){l&&b(e)}}}class Nt extends ve{constructor(e){super(),we(this,e,null,Vt,ke,{})}}function Ct(n){let e,t,l,i,r,a="Click to Access Webcam",s,o,c,f;return i=new wt({}),{c(){e=N("button"),t=N("div"),l=N("span"),j(i.$$.fragment),r=A(),s=se(a),this.h()},l(_){e=C(_,"BUTTON",{class:!0});var k=B(e);t=C(k,"DIV",{class:!0});var y=B(t);l=C(y,"SPAN",{class:!0});var M=B(l);P(i.$$.fragment,M),M.forEach(b),r=F(y),s=ue(y,a),y.forEach(b),k.forEach(b),this.h()},h(){g(l,"class","icon-wrap svelte-qbrfs"),g(t,"class","wrap svelte-qbrfs"),g(e,"class","svelte-qbrfs"),he(e,"height","100%")},m(_,k){V(_,e,k),z(e,t),z(t,l),R(i,l,null),z(t,r),z(t,s),o=!0,c||(f=re(e,"click",n[1]),c=!0)},p:x,i(_){o||(w(i.$$.fragment,_),o=!0)},o(_){E(i.$$.fragment,_),o=!1},d(_){_&&b(e),q(i),c=!1,f()}}}function Ot(n){const e=We();return[e,()=>e("click")]}class Wt extends ve{constructor(e){super(),we(this,e,Ot,Ct,ke,{})}}function Mt(){return navigator.mediaDevices.enumerateDevices()}function St(n,e){e.srcObject=n,e.muted=!0,e.play()}async function je(n,e,t,l){const i={video:l?{deviceId:{exact:l},...t==null?void 0:t.video}:(t==null?void 0:t.video)||{width:{ideal:1920},height:{ideal:1440}},audio:n&&((t==null?void 0:t.audio)??!0)};return navigator.mediaDevices.getUserMedia(i).then(r=>(St(r,e),r))}function Ut(n){return n.filter(t=>t.kind==="videoinput")}function Pe(n,e,t){const l=n.slice();return l[39]=e[t],l}function jt(n){let e,t,l,i,r,a,s,o,c,f,_;const k=[qt,Rt],y=[];function M(I,D){return I[2]==="video"||I[1]?0:1}l=M(n),i=y[l]=k[l](n);let m=!n[11]&&Re(n),p=n[13]&&n[8]&&qe(n);return{c(){e=N("div"),t=N("button"),i.c(),a=A(),m&&m.c(),s=A(),p&&p.c(),o=te(),this.h()},l(I){e=C(I,"DIV",{class:!0});var D=B(e);t=C(D,"BUTTON",{"aria-label":!0,class:!0});var S=B(t);i.l(S),S.forEach(b),a=F(D),m&&m.l(D),D.forEach(b),s=F(I),p&&p.l(I),o=te(),this.h()},h(){g(t,"aria-label",r=n[2]==="image"?"capture photo":"start recording"),g(t,"class","svelte-10cpz3p"),g(e,"class","button-wrap svelte-10cpz3p")},m(I,D){V(I,e,D),z(e,t),y[l].m(t,null),z(e,a),m&&m.m(e,null),V(I,s,D),p&&p.m(I,D),V(I,o,D),c=!0,f||(_=re(t,"click",n[28]),f=!0)},p(I,D){let S=l;l=M(I),l===S?y[l].p(I,D):($(),E(y[S],1,1,()=>{y[S]=null}),ee(),i=y[l],i?i.p(I,D):(i=y[l]=k[l](I),i.c()),w(i,1),i.m(t,null)),(!c||D[0]&4&&r!==(r=I[2]==="image"?"capture photo":"start recording"))&&g(t,"aria-label",r),I[11]?m&&($(),E(m,1,1,()=>{m=null}),ee()):m?(m.p(I,D),D[0]&2048&&w(m,1)):(m=Re(I),m.c(),w(m,1),m.m(e,null)),I[13]&&I[8]?p?(p.p(I,D),D[0]&8448&&w(p,1)):(p=qe(I),p.c(),w(p,1),p.m(o.parentNode,o)):p&&($(),E(p,1,1,()=>{p=null}),ee())},i(I){c||(w(i),w(m),w(p),c=!0)},o(I){E(i),E(m),E(p),c=!1},d(I){I&&(b(e),b(s),b(o)),y[l].d(),m&&m.d(),p&&p.d(I),f=!1,_()}}}function Pt(n){let e,t,l,i;return t=new Wt({}),t.$on("click",n[27]),{c(){e=N("div"),j(t.$$.fragment),this.h()},l(r){e=C(r,"DIV",{title:!0,style:!0});var a=B(e);P(t.$$.fragment,a),a.forEach(b),this.h()},h(){g(e,"title","grant webcam access"),he(e,"height","100%")},m(r,a){V(r,e,a),R(t,e,null),i=!0},p:x,i(r){i||(w(t.$$.fragment,r),r&&(l||lt(()=>{l=it(e,ft,{delay:100,duration:200}),l.start()})),i=!0)},o(r){E(t.$$.fragment,r),i=!1},d(r){r&&b(e),q(t)}}}function Rt(n){let e,t,l;return t=new Bt({}),{c(){e=N("div"),j(t.$$.fragment),this.h()},l(i){e=C(i,"DIV",{class:!0,title:!0});var r=B(e);P(t.$$.fragment,r),r.forEach(b),this.h()},h(){g(e,"class","icon svelte-10cpz3p"),g(e,"title","capture photo")},m(i,r){V(i,e,r),R(t,e,null),l=!0},p:x,i(i){l||(w(t.$$.fragment,i),l=!0)},o(i){E(t.$$.fragment,i),l=!1},d(i){i&&b(e),q(t)}}}function qt(n){let e,t,l,i;const r=[Ft,At,Lt],a=[];function s(o,c){return o[1]&&o[10]==="waiting"?0:o[1]&&o[10]==="open"||!o[1]&&o[11]?1:2}return e=s(n),t=a[e]=r[e](n),{c(){t.c(),l=te()},l(o){t.l(o),l=te()},m(o,c){a[e].m(o,c),V(o,l,c),i=!0},p(o,c){let f=e;e=s(o),e===f?a[e].p(o,c):($(),E(a[f],1,1,()=>{a[f]=null}),ee(),t=a[e],t?t.p(o,c):(t=a[e]=r[e](o),t.c()),w(t,1),t.m(l.parentNode,l))},i(o){i||(w(t),i=!0)},o(o){E(t),i=!1},d(o){o&&b(l),a[e].d(o)}}}function Lt(n){let e,t,l,i,r=n[4]("audio.record")+"",a,s;return l=new Nt({}),{c(){e=N("div"),t=N("div"),j(l.$$.fragment),i=A(),a=se(r),this.h()},l(o){e=C(o,"DIV",{class:!0});var c=B(e);t=C(c,"DIV",{class:!0,title:!0});var f=B(t);P(l.$$.fragment,f),f.forEach(b),i=F(c),a=ue(c,r),c.forEach(b),this.h()},h(){g(t,"class","icon color-primary svelte-10cpz3p"),g(t,"title","start recording"),g(e,"class","icon-with-text svelte-10cpz3p")},m(o,c){V(o,e,c),z(e,t),R(l,t,null),z(e,i),z(e,a),s=!0},p(o,c){(!s||c[0]&16)&&r!==(r=o[4]("audio.record")+"")&&Ie(a,r)},i(o){s||(w(l.$$.fragment,o),s=!0)},o(o){E(l.$$.fragment,o),s=!1},d(o){o&&b(e),q(l)}}}function At(n){let e,t,l,i,r=n[4]("audio.stop")+"",a,s;return l=new dt({}),{c(){e=N("div"),t=N("div"),j(l.$$.fragment),i=A(),a=se(r),this.h()},l(o){e=C(o,"DIV",{class:!0});var c=B(e);t=C(c,"DIV",{class:!0,title:!0});var f=B(t);P(l.$$.fragment,f),f.forEach(b),i=F(c),a=ue(c,r),c.forEach(b),this.h()},h(){g(t,"class","icon color-primary svelte-10cpz3p"),g(t,"title","stop recording"),g(e,"class","icon-with-text svelte-10cpz3p")},m(o,c){V(o,e,c),z(e,t),R(l,t,null),z(e,i),z(e,a),s=!0},p(o,c){(!s||c[0]&16)&&r!==(r=o[4]("audio.stop")+"")&&Ie(a,r)},i(o){s||(w(l.$$.fragment,o),s=!0)},o(o){E(l.$$.fragment,o),s=!1},d(o){o&&b(e),q(l)}}}function Ft(n){let e,t,l,i,r=n[4]("audio.waiting")+"",a,s;return l=new kt({}),{c(){e=N("div"),t=N("div"),j(l.$$.fragment),i=A(),a=se(r),this.h()},l(o){e=C(o,"DIV",{class:!0,style:!0});var c=B(e);t=C(c,"DIV",{class:!0,title:!0});var f=B(t);P(l.$$.fragment,f),f.forEach(b),i=F(c),a=ue(c,r),c.forEach(b),this.h()},h(){g(t,"class","icon color-primary svelte-10cpz3p"),g(t,"title","spinner"),g(e,"class","icon-with-text svelte-10cpz3p"),he(e,"width","var(--size-24)")},m(o,c){V(o,e,c),z(e,t),R(l,t,null),z(e,i),z(e,a),s=!0},p(o,c){(!s||c[0]&16)&&r!==(r=o[4]("audio.waiting")+"")&&Ie(a,r)},i(o){s||(w(l.$$.fragment,o),s=!0)},o(o){E(l.$$.fragment,o),s=!1},d(o){o&&b(e),q(l)}}}function Re(n){let e,t,l,i,r;return t=new Ke({}),{c(){e=N("button"),j(t.$$.fragment),this.h()},l(a){e=C(a,"BUTTON",{class:!0,"aria-label":!0});var s=B(e);P(t.$$.fragment,s),s.forEach(b),this.h()},h(){g(e,"class","icon svelte-10cpz3p"),g(e,"aria-label","select input source")},m(a,s){V(a,e,s),R(t,e,null),l=!0,i||(r=re(e,"click",n[29]),i=!0)},p:x,i(a){l||(w(t.$$.fragment,a),l=!0)},o(a){E(t.$$.fragment,a),l=!1},d(a){a&&b(e),q(t),i=!1,r()}}}function qe(n){let e,t,l,i,r,a,s;l=new Ke({});function o(_,k){return _[7].length===0?Gt:Ht}let c=o(n),f=c(n);return{c(){e=N("select"),t=N("button"),j(l.$$.fragment),i=A(),f.c(),this.h()},l(_){e=C(_,"SELECT",{class:!0,"aria-label":!0});var k=B(e);t=C(k,"BUTTON",{class:!0});var y=B(t);P(l.$$.fragment,y),i=F(y),y.forEach(b),f.l(k),k.forEach(b),this.h()},h(){g(t,"class","inset-icon svelte-10cpz3p"),g(e,"class","select-wrap svelte-10cpz3p"),g(e,"aria-label","select source")},m(_,k){V(_,e,k),z(e,t),R(l,t,null),z(t,i),f.m(e,null),r=!0,a||(s=[re(t,"click",nt(n[30])),rt(Me.call(null,e,n[17])),re(e,"change",n[14])],a=!0)},p(_,k){c===(c=o(_))&&f?f.p(_,k):(f.d(1),f=c(_),f&&(f.c(),f.m(e,null)))},i(_){r||(w(l.$$.fragment,_),r=!0)},o(_){E(l.$$.fragment,_),r=!1},d(_){_&&b(e),q(l),f.d(),a=!1,Je(s)}}}function Ht(n){let e,t=Ue(n[7]),l=[];for(let i=0;i<t.length;i+=1)l[i]=Le(Pe(n,t,i));return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=te()},l(i){for(let r=0;r<l.length;r+=1)l[r].l(i);e=te()},m(i,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(i,r);V(i,e,r)},p(i,r){if(r[0]&384){t=Ue(i[7]);let a;for(a=0;a<t.length;a+=1){const s=Pe(i,t,a);l[a]?l[a].p(s,r):(l[a]=Le(s),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(i){i&&b(e),at(l,i)}}}function Gt(n){let e,t=n[4]("common.no_devices")+"",l;return{c(){e=N("option"),l=se(t),this.h()},l(i){e=C(i,"OPTION",{class:!0});var r=B(e);l=ue(r,t),r.forEach(b),this.h()},h(){e.__value="",Oe(e,e.__value),g(e,"class","svelte-10cpz3p")},m(i,r){V(i,e,r),z(e,l)},p(i,r){r[0]&16&&t!==(t=i[4]("common.no_devices")+"")&&Ie(l,t)},d(i){i&&b(e)}}}function Le(n){let e,t=n[39].label+"",l,i,r,a;return{c(){e=N("option"),l=se(t),i=A(),this.h()},l(s){e=C(s,"OPTION",{class:!0});var o=B(e);l=ue(o,t),i=F(o),o.forEach(b),this.h()},h(){e.__value=r=n[39].deviceId,Oe(e,e.__value),e.selected=a=n[8].deviceId===n[39].deviceId,g(e,"class","svelte-10cpz3p")},m(s,o){V(s,e,o),z(e,l),z(e,i)},p(s,o){o[0]&128&&t!==(t=s[39].label+"")&&Ie(l,t),o[0]&128&&r!==(r=s[39].deviceId)&&(e.__value=r,Oe(e,e.__value)),o[0]&384&&a!==(a=s[8].deviceId===s[39].deviceId)&&(e.selected=a)},d(s){s&&b(e)}}}function Jt(n){let e,t,l,i,r,a,s,o,c,f,_;t=new Dt({props:{time_limit:n[9]}});const k=[Pt,jt],y=[];function M(m,p){return m[12]?1:0}return c=M(n),f=y[c]=k[c](n),{c(){e=N("div"),j(t.$$.fragment),l=A(),i=N("video"),r=A(),a=N("img"),o=A(),f.c(),this.h()},l(m){e=C(m,"DIV",{class:!0});var p=B(e);P(t.$$.fragment,p),l=F(p),i=C(p,"VIDEO",{class:!0}),B(i).forEach(b),r=F(p),a=C(p,"IMG",{src:!0,class:!0}),o=F(p),f.l(p),p.forEach(b),this.h()},h(){var m;g(i,"class","svelte-10cpz3p"),Z(i,"flip",n[3]),Z(i,"hide",!n[12]||n[12]&&!!n[0]),Se(a.src,s=(m=n[0])==null?void 0:m.url)||g(a,"src",s),g(a,"class","svelte-10cpz3p"),Z(a,"hide",!n[12]||n[12]&&!n[0]),g(e,"class","wrap svelte-10cpz3p")},m(m,p){V(m,e,p),R(t,e,null),z(e,l),z(e,i),n[26](i),z(e,r),z(e,a),z(e,o),y[c].m(e,null),_=!0},p(m,p){var S;const I={};p[0]&512&&(I.time_limit=m[9]),t.$set(I),(!_||p[0]&8)&&Z(i,"flip",m[3]),(!_||p[0]&4097)&&Z(i,"hide",!m[12]||m[12]&&!!m[0]),(!_||p[0]&1&&!Se(a.src,s=(S=m[0])==null?void 0:S.url))&&g(a,"src",s),(!_||p[0]&4097)&&Z(a,"hide",!m[12]||m[12]&&!m[0]);let D=c;c=M(m),c===D?y[c].p(m,p):($(),E(y[D],1,1,()=>{y[D]=null}),ee(),f=y[c],f?f.p(m,p):(f=y[c]=k[c](m),f.c()),w(f,1),f.m(e,null))},i(m){_||(w(t.$$.fragment,m),w(f),_=!0)},o(m){E(t.$$.fragment,m),E(f),_=!1},d(m){m&&b(e),q(t),n[26](null),y[c].d()}}}function Me(n,e){const t=l=>{n&&!n.contains(l.target)&&!l.defaultPrevented&&e(l)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Kt(n,e,t){let l,i=[],r=null,a=null,s="closed";const o=h=>{h==="closed"?(t(9,a=null),t(10,s="closed"),t(0,G=null)):h==="waiting"?t(10,s="waiting"):t(10,s="open")},c=h=>{v&&t(9,a=h)};let f,{streaming:_=!1}=e,{pending:k=!1}=e,{root:y=""}=e,{stream_every:M=1}=e,{mode:m="image"}=e,{mirror_webcam:p}=e,{include_audio:I}=e,{webcam_constraints:D=null}=e,{i18n:S}=e,{upload:K}=e,{value:G=null}=e;const O=We();et(()=>{f=document.createElement("canvas"),_&&m==="image"&&window.setInterval(()=>{l&&!k&&d()},M*1e3)});const Q=async h=>{const Y=h.target.value;await je(I,l,D,Y).then(async ie=>{L=ie,t(8,r=i.find(_e=>_e.deviceId===Y)||null),t(13,oe=!1)})};async function T(){try{je(I,l,D).then(async h=>{t(12,X=!0),t(7,i=await Mt()),L=h}).then(()=>Ut(i)).then(h=>{t(7,i=h);const U=L.getTracks().map(Y=>{var ie;return(ie=Y.getSettings())==null?void 0:ie.deviceId})[0];t(8,r=U&&h.find(Y=>Y.deviceId===U)||i[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&O("error",S("image.no_webcam_support"))}catch(h){if(h instanceof DOMException&&h.name=="NotAllowedError")O("error",S("image.allow_webcam_access"));else throw h}}function d(){var h=f.getContext("2d");if((!_||_&&v)&&l.videoWidth&&l.videoHeight){if(f.width=l.videoWidth,f.height=l.videoHeight,h.drawImage(l,0,0,l.videoWidth,l.videoHeight),p&&(h.scale(-1,1),h.drawImage(l,-l.videoWidth,0)),_&&(!v||s==="waiting"))return;if(_){const U=f.toDataURL("image/jpeg");O("stream",U);return}f.toBlob(U=>{O(_?"stream":"capture",U)},`image/${_?"jpeg":"png"}`,.8)}}let v=!1,H=[],L,W,J;function le(){if(v){J.stop();let h=new Blob(H,{type:W}),U=new FileReader;U.onload=async function(Y){var ie;if(Y.target){let _e=new File([h],"sample."+W.substring(6));const Ne=await _t([_e]);let Ce=(ie=await K(Ne,y))==null?void 0:ie.filter(Boolean)[0];O("capture",Ce),O("stop_recording")}},U.readAsDataURL(h)}else if(typeof MediaRecorder<"u"){O("start_recording"),H=[];let h=["video/webm","video/mp4"];for(let U of h)if(MediaRecorder.isTypeSupported(U)){W=U;break}if(W===null){console.error("No supported MediaRecorder mimeType");return}J=new MediaRecorder(L,{mimeType:W}),J.addEventListener("dataavailable",function(U){H.push(U.data)}),J.start(200)}t(11,v=!v)}let X=!1;function ce({destroy:h}={}){m==="image"&&_&&t(11,v=!v),h||(m==="image"?d():le()),!v&&L&&(O("close_stream"),L.getTracks().forEach(U=>U.stop()),t(6,l.srcObject=null,l),t(12,X=!1),window.setTimeout(()=>{t(0,G=null)},500),t(0,G=null))}let oe=!1;function fe(h){h.preventDefault(),h.stopPropagation(),t(13,oe=!1)}tt(()=>{typeof window>"u"||(ce({destroy:!0}),L==null||L.getTracks().forEach(h=>h.stop()))});function De(h){ae[h?"unshift":"push"](()=>{l=h,t(6,l)})}const ze=async()=>T(),Te=()=>ce(),Be=()=>t(13,oe=!0),Ve=()=>t(13,oe=!1);return n.$$set=h=>{"streaming"in h&&t(1,_=h.streaming),"pending"in h&&t(20,k=h.pending),"root"in h&&t(21,y=h.root),"stream_every"in h&&t(22,M=h.stream_every),"mode"in h&&t(2,m=h.mode),"mirror_webcam"in h&&t(3,p=h.mirror_webcam),"include_audio"in h&&t(23,I=h.include_audio),"webcam_constraints"in h&&t(24,D=h.webcam_constraints),"i18n"in h&&t(4,S=h.i18n),"upload"in h&&t(25,K=h.upload),"value"in h&&t(0,G=h.value)},[G,_,m,p,S,Me,l,i,r,a,s,v,X,oe,Q,T,ce,fe,o,c,k,y,M,I,D,K,De,ze,Te,Be,Ve]}class Qt extends ve{constructor(e){super(),we(this,e,Kt,Jt,ke,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,webcam_constraints:24,i18n:4,upload:25,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get click_outside(){return Me}}const Xt=Qt;function Ae(n){let e,t,l,i=n[18]&&Fe(n);return t=new gt({props:{Icon:ht,label:"Remove Image"}}),t.$on("click",n[25]),{c(){i&&i.c(),e=A(),j(t.$$.fragment)},l(r){i&&i.l(r),e=F(r),P(t.$$.fragment,r)},m(r,a){i&&i.m(r,a),V(r,e,a),R(t,r,a),l=!0},p(r,a){r[18]?i?(i.p(r,a),a[0]&262144&&w(i,1)):(i=Fe(r),i.c(),w(i,1),i.m(e.parentNode,e)):i&&($(),E(i,1,1,()=>{i=null}),ee())},i(r){l||(w(i),w(t.$$.fragment,r),l=!0)},o(r){E(i),E(t.$$.fragment,r),l=!1},d(r){r&&b(e),i&&i.d(r),q(t,r)}}}function Fe(n){let e,t;return e=new Et({props:{fullscreen:n[19]}}),e.$on("fullscreen",n[33]),{c(){j(e.$$.fragment)},l(l){P(e.$$.fragment,l)},m(l,i){R(e,l,i),t=!0},p(l,i){const r={};i[0]&524288&&(r.fullscreen=l[19]),e.$set(r)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){q(e,l)}}}function Yt(n){var i;let e,t,l=((i=n[3])==null?void 0:i.url)&&!n[20]&&Ae(n);return{c(){l&&l.c(),e=te()},l(r){l&&l.l(r),e=te()},m(r,a){l&&l.m(r,a),V(r,e,a),t=!0},p(r,a){var s;(s=r[3])!=null&&s.url&&!r[20]?l?(l.p(r,a),a[0]&1048584&&w(l,1)):(l=Ae(r),l.c(),w(l,1),l.m(e.parentNode,e)):l&&($(),E(l,1,1,()=>{l=null}),ee())},i(r){t||(w(l),t=!0)},o(r){E(l),t=!1},d(r){r&&b(e),l&&l.d(r)}}}function He(n){let e;const t=n[32].default,l=ot(t,n,n[48],null);return{c(){l&&l.c()},l(i){l&&l.l(i)},m(i,r){l&&l.m(i,r),e=!0},p(i,r){l&&l.p&&(!e||r[1]&131072)&&st(l,t,i,i[48],e?ct(t,i[48],r,null):ut(i[48]),null)},i(i){e||(w(l,i),e=!0)},o(i){E(l,i),e=!1},d(i){l&&l.d(i)}}}function Zt(n){let e,t,l=n[3]===null&&He(n);return{c(){l&&l.c(),e=te()},l(i){l&&l.l(i),e=te()},m(i,r){l&&l.m(i,r),V(i,e,r),t=!0},p(i,r){i[3]===null?l?(l.p(i,r),r[0]&8&&w(l,1)):(l=He(i),l.c(),w(l,1),l.m(e.parentNode,e)):l&&($(),E(l,1,1,()=>{l=null}),ee())},i(i){t||(w(l),t=!0)},o(i){E(l),t=!1},d(i){i&&b(e),l&&l.d(i)}}}function xt(n){let e,t,l,i,r;return t=new bt({props:{src:n[3].url,alt:n[3].alt_text}}),{c(){e=N("div"),j(t.$$.fragment),this.h()},l(a){e=C(a,"DIV",{class:!0});var s=B(e);P(t.$$.fragment,s),s.forEach(b),this.h()},h(){g(e,"class","image-frame svelte-1hdlew6"),Z(e,"selectable",n[11])},m(a,s){V(a,e,s),R(t,e,null),l=!0,i||(r=re(e,"click",n[27]),i=!0)},p(a,s){const o={};s[0]&8&&(o.src=a[3].url),s[0]&8&&(o.alt=a[3].alt_text),t.$set(o),(!l||s[0]&2048)&&Z(e,"selectable",a[11])},i(a){l||(w(t.$$.fragment,a),l=!0)},o(a){E(t.$$.fragment,a),l=!1},d(a){a&&b(e),q(t),i=!1,r()}}}function $t(n){let e,t,l,i;function r(o){n[38](o)}function a(o){n[39](o)}let s={root:n[12],value:n[3],mirror_webcam:n[10].mirror,stream_every:n[17],streaming:n[9],mode:"image",include_audio:!1,i18n:n[13],upload:n[15],webcam_constraints:n[10].constraints};return n[4]!==void 0&&(s.modify_stream=n[4]),n[5]!==void 0&&(s.set_time_limit=n[5]),e=new Xt({props:s}),ae.push(()=>be(e,"modify_stream",r)),ae.push(()=>be(e,"set_time_limit",a)),e.$on("capture",n[40]),e.$on("stream",n[41]),e.$on("error",n[42]),e.$on("drag",n[43]),e.$on("upload",n[44]),e.$on("close_stream",n[45]),{c(){j(e.$$.fragment)},l(o){P(e.$$.fragment,o)},m(o,c){R(e,o,c),i=!0},p(o,c){const f={};c[0]&4096&&(f.root=o[12]),c[0]&8&&(f.value=o[3]),c[0]&1024&&(f.mirror_webcam=o[10].mirror),c[0]&131072&&(f.stream_every=o[17]),c[0]&512&&(f.streaming=o[9]),c[0]&8192&&(f.i18n=o[13]),c[0]&32768&&(f.upload=o[15]),c[0]&1024&&(f.webcam_constraints=o[10].constraints),!t&&c[0]&16&&(t=!0,f.modify_stream=o[4],pe(()=>t=!1)),!l&&c[0]&32&&(l=!0,f.set_time_limit=o[5],pe(()=>l=!1)),e.$set(f)},i(o){i||(w(e.$$.fragment,o),i=!0)},o(o){E(e.$$.fragment,o),i=!1},d(o){q(e,o)}}}function Ge(n){let e,t,l;function i(a){n[46](a)}let r={sources:n[8],handle_clear:n[24],handle_select:n[28]};return n[1]!==void 0&&(r.active_source=n[1]),e=new It({props:r}),ae.push(()=>be(e,"active_source",i)),{c(){j(e.$$.fragment)},l(a){P(e.$$.fragment,a)},m(a,s){R(e,a,s),l=!0},p(a,s){const o={};s[0]&256&&(o.sources=a[8]),!t&&s[0]&2&&(t=!0,o.active_source=a[1],pe(()=>t=!1)),e.$set(o)},i(a){l||(w(e.$$.fragment,a),l=!0)},o(a){E(e.$$.fragment,a),l=!1},d(a){q(e,a)}}}function el(n){let e,t,l,i,r,a,s,o,c,f,_,k,y,M=n[8].length>1||n[8].includes("clipboard"),m,p,I;e=new pt({props:{show_label:n[7],Icon:vt,label:n[6]||"Image"}}),i=new mt({props:{$$slots:{default:[Yt]},$$scope:{ctx:n}}});function D(d){n[35](d)}function S(d){n[36](d)}let K={hidden:n[3]!==null||n[1]==="webcam",filetype:n[1]==="clipboard"?"clipboard":"image/*",root:n[12],max_file_size:n[14],disable_click:!n[8].includes("upload")||n[3]!==null,upload:n[15],stream_handler:n[16],aria_label:n[13]("image.drop_to_upload"),$$slots:{default:[Zt]},$$scope:{ctx:n}};n[0]!==void 0&&(K.uploading=n[0]),n[2]!==void 0&&(K.dragging=n[2]),s=new zt({props:K}),n[34](s),ae.push(()=>be(s,"uploading",D)),ae.push(()=>be(s,"dragging",S)),s.$on("load",n[23]),s.$on("error",n[37]);const G=[$t,xt],O=[];function Q(d,v){return d[1]==="webcam"&&(d[9]||!d[9]&&!d[3])?0:d[3]!==null&&!d[9]?1:-1}~(_=Q(n))&&(k=O[_]=G[_](n));let T=M&&Ge(n);return{c(){j(e.$$.fragment),t=A(),l=N("div"),j(i.$$.fragment),r=A(),a=N("div"),j(s.$$.fragment),f=A(),k&&k.c(),y=A(),T&&T.c(),this.h()},l(d){P(e.$$.fragment,d),t=F(d),l=C(d,"DIV",{"data-testid":!0,class:!0});var v=B(l);P(i.$$.fragment,v),r=F(v),a=C(v,"DIV",{class:!0});var H=B(a);P(s.$$.fragment,H),f=F(H),k&&k.l(H),H.forEach(b),y=F(v),T&&T.l(v),v.forEach(b),this.h()},h(){g(a,"class","upload-container svelte-1hdlew6"),Z(a,"reduced-height",n[8].length>1),he(a,"width",n[3]?"auto":"100%"),g(l,"data-testid","image"),g(l,"class","image-container svelte-1hdlew6")},m(d,v){R(e,d,v),V(d,t,v),V(d,l,v),R(i,l,null),z(l,r),z(l,a),R(s,a,null),z(a,f),~_&&O[_].m(a,null),z(l,y),T&&T.m(l,null),n[47](l),m=!0,p||(I=[re(a,"dragover",n[29]),re(a,"drop",n[30])],p=!0)},p(d,v){const H={};v[0]&128&&(H.show_label=d[7]),v[0]&64&&(H.label=d[6]||"Image"),e.$set(H);const L={};v[0]&1835016|v[1]&131072&&(L.$$scope={dirty:v,ctx:d}),i.$set(L);const W={};v[0]&10&&(W.hidden=d[3]!==null||d[1]==="webcam"),v[0]&2&&(W.filetype=d[1]==="clipboard"?"clipboard":"image/*"),v[0]&4096&&(W.root=d[12]),v[0]&16384&&(W.max_file_size=d[14]),v[0]&264&&(W.disable_click=!d[8].includes("upload")||d[3]!==null),v[0]&32768&&(W.upload=d[15]),v[0]&65536&&(W.stream_handler=d[16]),v[0]&8192&&(W.aria_label=d[13]("image.drop_to_upload")),v[0]&8|v[1]&131072&&(W.$$scope={dirty:v,ctx:d}),!o&&v[0]&1&&(o=!0,W.uploading=d[0],pe(()=>o=!1)),!c&&v[0]&4&&(c=!0,W.dragging=d[2],pe(()=>c=!1)),s.$set(W);let J=_;_=Q(d),_===J?~_&&O[_].p(d,v):(k&&($(),E(O[J],1,1,()=>{O[J]=null}),ee()),~_?(k=O[_],k?k.p(d,v):(k=O[_]=G[_](d),k.c()),w(k,1),k.m(a,null)):k=null),(!m||v[0]&256)&&Z(a,"reduced-height",d[8].length>1),v[0]&8&&he(a,"width",d[3]?"auto":"100%"),v[0]&256&&(M=d[8].length>1||d[8].includes("clipboard")),M?T?(T.p(d,v),v[0]&256&&w(T,1)):(T=Ge(d),T.c(),w(T,1),T.m(l,null)):T&&($(),E(T,1,1,()=>{T=null}),ee())},i(d){m||(w(e.$$.fragment,d),w(i.$$.fragment,d),w(s.$$.fragment,d),w(k),w(T),m=!0)},o(d){E(e.$$.fragment,d),E(i.$$.fragment,d),E(s.$$.fragment,d),E(k),E(T),m=!1},d(d){d&&(b(t),b(l)),q(e,d),q(i),n[34](null),q(s),~_&&O[_].d(),T&&T.d(),n[47](null),p=!1,Je(I)}}}function tl(n,e,t){let l,{$$slots:i={},$$scope:r}=e,{value:a=null}=e,{label:s=void 0}=e,{show_label:o}=e,{sources:c=["upload","clipboard","webcam"]}=e,{streaming:f=!1}=e,{pending:_=!1}=e,{webcam_options:k}=e,{selectable:y=!1}=e,{root:M}=e,{i18n:m}=e,{max_file_size:p=null}=e,{upload:I}=e,{stream_handler:D}=e,{stream_every:S}=e,{modify_stream:K}=e,{set_time_limit:G}=e,{show_fullscreen_button:O=!0}=e,Q,{uploading:T=!1}=e,{active_source:d=null}=e,{fullscreen:v=!1}=e;async function H({detail:u}){var ne;if(!f){if((ne=u.path)!=null&&ne.toLowerCase().endsWith(".svg")&&u.url){const $e=await(await fetch(u.url)).text();t(3,a={...u,url:`data:image/svg+xml,${encodeURIComponent($e)}`})}else t(3,a=u);await ye(),le("upload")}}function L(){t(3,a=null),le("clear"),le("change",null)}function W(u){L(),u.stopPropagation()}async function J(u,ne){if(ne==="stream"){le("stream",{value:{url:u},is_value_data:!0});return}t(31,_=!0);const Ee=await Q.load_files([new File([u],`image/${f?"jpeg":"png"}`)]);(ne==="change"||ne==="upload")&&(t(3,a=(Ee==null?void 0:Ee[0])||null),await ye(),le("change")),t(31,_=!1)}const le=We();let{dragging:X=!1}=e;function ce(u){let ne=yt(u);ne&&le("select",{index:ne,value:null})}async function oe(u){switch(u){case"clipboard":Q.paste_clipboard();break}}let fe;function De(u){u.preventDefault(),u.stopPropagation(),u.dataTransfer&&(u.dataTransfer.dropEffect="copy"),t(2,X=!0)}async function ze(u){u.preventDefault(),u.stopPropagation(),t(2,X=!1),a&&(L(),await ye()),t(1,d="upload"),await ye(),Q.load_files_from_drop(u)}function Te(u){de.call(this,n,u)}function Be(u){ae[u?"unshift":"push"](()=>{Q=u,t(21,Q)})}function Ve(u){T=u,t(0,T)}function h(u){X=u,t(2,X)}function U(u){de.call(this,n,u)}function Y(u){K=u,t(4,K)}function ie(u){G=u,t(5,G)}const _e=u=>J(u.detail,"change"),Ne=u=>J(u.detail,"stream");function Ce(u){de.call(this,n,u)}function Qe(u){de.call(this,n,u)}const Xe=u=>J(u.detail,"upload");function Ye(u){de.call(this,n,u)}function Ze(u){d=u,t(1,d),t(8,c)}function xe(u){ae[u?"unshift":"push"](()=>{fe=u,t(22,fe)})}return n.$$set=u=>{"value"in u&&t(3,a=u.value),"label"in u&&t(6,s=u.label),"show_label"in u&&t(7,o=u.show_label),"sources"in u&&t(8,c=u.sources),"streaming"in u&&t(9,f=u.streaming),"pending"in u&&t(31,_=u.pending),"webcam_options"in u&&t(10,k=u.webcam_options),"selectable"in u&&t(11,y=u.selectable),"root"in u&&t(12,M=u.root),"i18n"in u&&t(13,m=u.i18n),"max_file_size"in u&&t(14,p=u.max_file_size),"upload"in u&&t(15,I=u.upload),"stream_handler"in u&&t(16,D=u.stream_handler),"stream_every"in u&&t(17,S=u.stream_every),"modify_stream"in u&&t(4,K=u.modify_stream),"set_time_limit"in u&&t(5,G=u.set_time_limit),"show_fullscreen_button"in u&&t(18,O=u.show_fullscreen_button),"uploading"in u&&t(0,T=u.uploading),"active_source"in u&&t(1,d=u.active_source),"fullscreen"in u&&t(19,v=u.fullscreen),"dragging"in u&&t(2,X=u.dragging),"$$scope"in u&&t(48,r=u.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&258&&!d&&c&&t(1,d=c[0]),n.$$.dirty[0]&514&&t(20,l=f&&d==="webcam"),n.$$.dirty[0]&1048577&&T&&!l&&t(3,a=null),n.$$.dirty[0]&4&&le("drag",X)},[T,d,X,a,K,G,s,o,c,f,k,y,M,m,p,I,D,S,O,v,l,Q,fe,H,L,W,J,ce,oe,De,ze,_,i,Te,Be,Ve,h,U,Y,ie,_e,Ne,Ce,Qe,Xe,Ye,Ze,xe,r]}class ll extends ve{constructor(e){super(),we(this,e,tl,el,ke,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:31,webcam_options:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,show_fullscreen_button:18,uploading:0,active_source:1,fullscreen:19,dragging:2},null,[-1,-1])}}const ml=ll;export{Nt as C,ml as I,Xt as W};
//# sourceMappingURL=ImageUploader.D8K3mW-S.js.map
