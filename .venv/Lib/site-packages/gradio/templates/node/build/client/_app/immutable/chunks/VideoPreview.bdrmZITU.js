import{SvelteComponent as pe,init as Ee,safe_not_equal as me,element as R,claim_element as L,children as B,detach as E,attr as p,insert_hydration as P,noop as _e,onMount as Se,onDestroy as Je,ensure_array_like as Be,space as F,claim_space as G,set_style as re,append_hydration as S,listen as J,update_keyed_each as Qe,destroy_block as Ye,run_all as Me,get_svelte_dataset as Re,src_url_equal as ke,create_component as q,claim_component as A,toggle_class as $,mount_component as U,transition_in as y,group_outros as ie,transition_out as T,check_outros as oe,destroy_component as H,binding_callbacks as te,bind as ne,add_flush_callback as le,empty as ae,text as ve,claim_text as we,set_data as Le,prevent_default as Ne,stop_propagation as Ze,createEventDispatcher as Ge,bubble as Z,afterUpdate as xe,tick as $e}from"../../../svelte/svelte.js";import"../../../svelte/svelte-submodules.js";import{R as de,j as Pe,z as et,u as tt,I as nt}from"./2.BPD7TSJN.js";import{B as lt}from"./BlockLabel.B6sjuoOP.js";import{D as it}from"./DownloadLink.DGlcG7fv.js";import{E as ot}from"./Empty.D5XVnMZ_.js";import{S as rt}from"./ShareButton.D3C70nBL.js";import{D as at}from"./Download.CpfEFmFf.js";import{V as We}from"./Video.CE2Y9LYL.js";import{M as ut}from"./Maximize.DHMLY8eU.js";import{T as st,P as ft}from"./Trim.CWFkmJwA.js";import{P as dt}from"./Play.DJ4h2PVY.js";import{U as Ke}from"./Undo.LhwFM5M8.js";import{b as _t,t as ct,V as mt}from"./Video.CGJke9Z3.js";/* empty css                                             */import{M as ht}from"./ModifyUpload.ZjEjKsCN.js";function qe(l,e,n){const t=l.slice();return t[20]=e[n],t[22]=n,t}function gt(l){let e,n,t,i,r,o=[],a=new Map,c,g,f,v,d=Be(l[1]);const u=_=>_[22];for(let _=0;_<d.length;_+=1){let m=qe(l,d,_),V=u(m);a.set(V,o[_]=Ae(V,m))}return{c(){e=R("div"),n=R("button"),t=F(),i=R("div"),r=F();for(let _=0;_<o.length;_+=1)o[_].c();c=F(),g=R("button"),this.h()},l(_){e=L(_,"DIV",{id:!0,class:!0});var m=B(e);n=L(m,"BUTTON",{"aria-label":!0,class:!0,style:!0}),B(n).forEach(E),t=G(m),i=L(m,"DIV",{class:!0,style:!0}),B(i).forEach(E),r=G(m);for(let V=0;V<o.length;V+=1)o[V].l(m);c=G(m),g=L(m,"BUTTON",{"aria-label":!0,class:!0,style:!0}),B(g).forEach(E),m.forEach(E),this.h()},h(){p(n,"aria-label","start drag handle for trimming video"),p(n,"class","handle left svelte-10c4beq"),re(n,"left",l[2]+"%"),p(i,"class","opaque-layer svelte-10c4beq"),re(i,"left",l[2]+"%"),re(i,"right",100-l[3]+"%"),p(g,"aria-label","end drag handle for trimming video"),p(g,"class","handle right svelte-10c4beq"),re(g,"left",l[3]+"%"),p(e,"id","timeline"),p(e,"class","thumbnail-wrapper svelte-10c4beq")},m(_,m){P(_,e,m),S(e,n),S(e,t),S(e,i),S(e,r);for(let V=0;V<o.length;V+=1)o[V]&&o[V].m(e,null);S(e,c),S(e,g),f||(v=[J(n,"mousedown",l[10]),J(n,"blur",l[5]),J(n,"keydown",l[11]),J(g,"mousedown",l[12]),J(g,"blur",l[5]),J(g,"keydown",l[13])],f=!0)},p(_,m){m&4&&re(n,"left",_[2]+"%"),m&4&&re(i,"left",_[2]+"%"),m&8&&re(i,"right",100-_[3]+"%"),m&2&&(d=Be(_[1]),o=Qe(o,m,u,1,_,d,a,e,Ye,Ae,c,qe)),m&8&&re(g,"left",_[3]+"%")},d(_){_&&E(e);for(let m=0;m<o.length;m+=1)o[m].d();f=!1,Me(v)}}}function bt(l){let e,n='<span aria-label="loading timeline" class="loader svelte-10c4beq"></span>';return{c(){e=R("div"),e.innerHTML=n,this.h()},l(t){e=L(t,"DIV",{class:!0,"data-svelte-h":!0}),Re(e)!=="svelte-13yzice"&&(e.innerHTML=n),this.h()},h(){p(e,"class","load-wrap svelte-10c4beq")},m(t,i){P(t,e,i)},p:_e,d(t){t&&E(e)}}}function Ae(l,e){let n,t,i;return{key:l,first:null,c(){n=R("img"),this.h()},l(r){n=L(r,"IMG",{src:!0,alt:!0,draggable:!0,class:!0}),this.h()},h(){ke(n.src,t=e[20])||p(n,"src",t),p(n,"alt",i=`frame-${e[22]}`),p(n,"draggable","false"),p(n,"class","svelte-10c4beq"),this.first=n},m(r,o){P(r,n,o)},p(r,o){e=r,o&2&&!ke(n.src,t=e[20])&&p(n,"src",t),o&2&&i!==(i=`frame-${e[22]}`)&&p(n,"alt",i)},d(r){r&&E(n)}}}function vt(l){let e;function n(r,o){return r[0]?bt:gt}let t=n(l),i=t(l);return{c(){e=R("div"),i.c(),this.h()},l(r){e=L(r,"DIV",{class:!0});var o=B(e);i.l(o),o.forEach(E),this.h()},h(){p(e,"class","container svelte-10c4beq")},m(r,o){P(r,e,o),i.m(e,null)},p(r,[o]){t===(t=n(r))&&i?i.p(r,o):(i.d(1),i=t(r),i&&(i.c(),i.m(e,null)))},i:_e,o:_e,d(r){r&&E(e),i.d()}}}let Ie=10;function wt(l,e,n){let{videoElement:t}=e,{trimmedDuration:i}=e,{dragStart:r}=e,{dragEnd:o}=e,{loadingTimeline:a}=e,c=[],g,f=0,v=100,d=null;const u=b=>{d=b},_=()=>{d=null},m=(b,M)=>{if(d){const I=document.getElementById("timeline");if(!I)return;const h=I.getBoundingClientRect();let N=(b.clientX-h.left)/h.width*100;if(M?N=d==="left"?f+M:v+M:N=(b.clientX-h.left)/h.width*100,N=Math.max(0,Math.min(N,100)),d==="left"){n(2,f=Math.min(N,v));const j=f/100*g;n(6,t.currentTime=j,t),n(8,r=j)}else if(d==="right"){n(3,v=Math.max(N,f));const j=v/100*g;n(6,t.currentTime=j,t),n(9,o=j)}const x=f/100*g,k=v/100*g;n(7,i=k-x),n(2,f),n(3,v)}},V=b=>{if(d){const M=1/g*100;b.key==="ArrowLeft"?m({clientX:0},-M):b.key==="ArrowRight"&&m({clientX:0},M)}},X=()=>{const b=document.createElement("canvas"),M=b.getContext("2d");if(!M)return;b.width=t.videoWidth,b.height=t.videoHeight,M.drawImage(t,0,0,b.width,b.height);const I=b.toDataURL("image/jpeg",.7);n(1,c=[...c,I])};Se(()=>{const b=()=>{g=t.duration;const M=g/Ie;let I=0;const h=()=>{X(),I++,I<Ie?n(6,t.currentTime+=M,t):t.removeEventListener("seeked",h)};t.addEventListener("seeked",h),n(6,t.currentTime=0,t)};t.readyState>=1?b():t.addEventListener("loadedmetadata",b)}),Je(()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",_),window.removeEventListener("keydown",V)}),Se(()=>{window.addEventListener("mousemove",m),window.addEventListener("mouseup",_),window.addEventListener("keydown",V)});const W=()=>u("left"),z=b=>{(b.key==="ArrowLeft"||b.key=="ArrowRight")&&u("left")},Q=()=>u("right"),O=b=>{(b.key==="ArrowLeft"||b.key=="ArrowRight")&&u("right")};return l.$$set=b=>{"videoElement"in b&&n(6,t=b.videoElement),"trimmedDuration"in b&&n(7,i=b.trimmedDuration),"dragStart"in b&&n(8,r=b.dragStart),"dragEnd"in b&&n(9,o=b.dragEnd),"loadingTimeline"in b&&n(0,a=b.loadingTimeline)},l.$$.update=()=>{l.$$.dirty&2&&n(0,a=c.length!==Ie)},[a,c,f,v,u,_,t,i,r,o,W,z,Q,O]}class kt extends pe{constructor(e){super(),Ee(this,e,wt,vt,me,{videoElement:6,trimmedDuration:7,dragStart:8,dragEnd:9,loadingTimeline:0})}}function Ue(l){let e,n,t,i,r,o,a;function c(u){l[18](u)}function g(u){l[19](u)}function f(u){l[20](u)}function v(u){l[21](u)}let d={videoElement:l[2]};return l[14]!==void 0&&(d.dragStart=l[14]),l[15]!==void 0&&(d.dragEnd=l[15]),l[12]!==void 0&&(d.trimmedDuration=l[12]),l[16]!==void 0&&(d.loadingTimeline=l[16]),n=new kt({props:d}),te.push(()=>ne(n,"dragStart",c)),te.push(()=>ne(n,"dragEnd",g)),te.push(()=>ne(n,"trimmedDuration",f)),te.push(()=>ne(n,"loadingTimeline",v)),{c(){e=R("div"),q(n.$$.fragment),this.h()},l(u){e=L(u,"DIV",{class:!0});var _=B(e);A(n.$$.fragment,_),_.forEach(E),this.h()},h(){p(e,"class","timeline-wrapper svelte-7yrr5f")},m(u,_){P(u,e,_),U(n,e,null),a=!0},p(u,_){const m={};_&4&&(m.videoElement=u[2]),!t&&_&16384&&(t=!0,m.dragStart=u[14],le(()=>t=!1)),!i&&_&32768&&(i=!0,m.dragEnd=u[15],le(()=>i=!1)),!r&&_&4096&&(r=!0,m.trimmedDuration=u[12],le(()=>r=!1)),!o&&_&65536&&(o=!0,m.loadingTimeline=u[16],le(()=>o=!1)),n.$set(m)},i(u){a||(y(n.$$.fragment,u),a=!0)},o(u){T(n.$$.fragment,u),a=!1},d(u){u&&E(e),H(n)}}}function pt(l){let e;return{c(){e=R("div"),this.h()},l(n){e=L(n,"DIV",{class:!0}),B(e).forEach(E),this.h()},h(){p(e,"class","svelte-7yrr5f")},m(n,t){P(n,e,t)},p:_e,d(n){n&&E(e)}}}function Et(l){let e,n=de(l[12])+"",t,i,r,o,a="Trim",c,g,f="Cancel",v,d;return{c(){e=R("time"),t=ve(n),i=F(),r=R("div"),o=R("button"),o.textContent=a,c=F(),g=R("button"),g.textContent=f,this.h()},l(u){e=L(u,"TIME",{"aria-label":!0,class:!0});var _=B(e);t=we(_,n),_.forEach(E),i=G(u),r=L(u,"DIV",{class:!0});var m=B(r);o=L(m,"BUTTON",{class:!0,"data-svelte-h":!0}),Re(o)!=="svelte-18nzick"&&(o.textContent=a),c=G(m),g=L(m,"BUTTON",{class:!0,"data-svelte-h":!0}),Re(g)!=="svelte-1mj98i4"&&(g.textContent=f),m.forEach(E),this.h()},h(){p(e,"aria-label","duration of selected region in seconds"),p(e,"class","svelte-7yrr5f"),$(e,"hidden",l[16]),p(o,"class","text-button svelte-7yrr5f"),$(o,"hidden",l[16]),p(g,"class","text-button svelte-7yrr5f"),$(g,"hidden",l[16]),p(r,"class","edit-buttons svelte-7yrr5f")},m(u,_){P(u,e,_),S(e,t),P(u,i,_),P(u,r,_),S(r,o),S(r,c),S(r,g),v||(d=[J(o,"click",l[22]),J(g,"click",l[17])],v=!0)},p(u,_){_&4096&&n!==(n=de(u[12])+"")&&Le(t,n),_&65536&&$(e,"hidden",u[16]),_&65536&&$(o,"hidden",u[16]),_&65536&&$(g,"hidden",u[16])},d(u){u&&(E(e),E(i),E(r)),v=!1,Me(d)}}}function He(l){let e,n;return e=new Pe({props:{Icon:Ke,label:"Reset video to initial value",disabled:l[1]||!l[11]}}),e.$on("click",l[23]),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p(t,i){const r={};i&2050&&(r.disabled=t[1]||!t[11]),e.$set(r)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Oe(l){let e,n;return e=new Pe({props:{Icon:st,label:"Trim video to selection",disabled:l[1]}}),e.$on("click",l[17]),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p(t,i){const r={};i&2&&(r.disabled=t[1]),e.$set(r)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function yt(l){let e,n,t,i=l[3]&&l[0]===""&&He(l),r=l[4]&&l[0]===""&&Oe(l);return{c(){i&&i.c(),e=F(),r&&r.c(),n=ae()},l(o){i&&i.l(o),e=G(o),r&&r.l(o),n=ae()},m(o,a){i&&i.m(o,a),P(o,e,a),r&&r.m(o,a),P(o,n,a),t=!0},p(o,a){o[3]&&o[0]===""?i?(i.p(o,a),a&9&&y(i,1)):(i=He(o),i.c(),y(i,1),i.m(e.parentNode,e)):i&&(ie(),T(i,1,1,()=>{i=null}),oe()),o[4]&&o[0]===""?r?(r.p(o,a),a&17&&y(r,1)):(r=Oe(o),r.c(),y(r,1),r.m(n.parentNode,n)):r&&(ie(),T(r,1,1,()=>{r=null}),oe())},i(o){t||(y(i),y(r),t=!0)},o(o){T(i),T(r),t=!1},d(o){o&&(E(e),E(n)),i&&i.d(o),r&&r.d(o)}}}function Tt(l){var v;let e,n,t,i,r,o,a=l[0]==="edit"&&Ue(l);function c(d,u){return d[0]==="edit"&&d[12]!==null?Et:pt}let g=c(l),f=g(l);return r=new ht({props:{i18n:l[7],download:l[9]?(v=l[8])==null?void 0:v.url:null,$$slots:{default:[yt]},$$scope:{ctx:l}}}),r.$on("clear",l[24]),{c(){e=R("div"),a&&a.c(),n=F(),t=R("div"),f.c(),i=F(),q(r.$$.fragment),this.h()},l(d){e=L(d,"DIV",{class:!0});var u=B(e);a&&a.l(u),n=G(u),t=L(u,"DIV",{class:!0,"data-testid":!0});var _=B(t);f.l(_),_.forEach(E),u.forEach(E),i=G(d),A(r.$$.fragment,d),this.h()},h(){p(t,"class","controls svelte-7yrr5f"),p(t,"data-testid","waveform-controls"),p(e,"class","container svelte-7yrr5f"),$(e,"hidden",l[0]!=="edit")},m(d,u){P(d,e,u),a&&a.m(e,null),S(e,n),S(e,t),f.m(t,null),P(d,i,u),U(r,d,u),o=!0},p(d,[u]){var m;d[0]==="edit"?a?(a.p(d,u),u&1&&y(a,1)):(a=Ue(d),a.c(),y(a,1),a.m(e,n)):a&&(ie(),T(a,1,1,()=>{a=null}),oe()),g===(g=c(d))&&f?f.p(d,u):(f.d(1),f=g(d),f&&(f.c(),f.m(t,null))),(!o||u&1)&&$(e,"hidden",d[0]!=="edit");const _={};u&128&&(_.i18n=d[7]),u&768&&(_.download=d[9]?(m=d[8])==null?void 0:m.url:null),u&33556539&&(_.$$scope={dirty:u,ctx:d}),r.$set(_)},i(d){o||(y(a),y(r.$$.fragment,d),o=!0)},o(d){T(a),T(r.$$.fragment,d),o=!1},d(d){d&&(E(e),E(i)),a&&a.d(),f.d(),H(r,d)}}}function Vt(l,e,n){let{videoElement:t}=e,{showRedo:i=!1}=e,{interactive:r=!0}=e,{mode:o=""}=e,{handle_reset_value:a}=e,{handle_trim_video:c}=e,{processingVideo:g=!1}=e,{i18n:f}=e,{value:v=null}=e,{show_download_button:d=!1}=e,{handle_clear:u=()=>{}}=e,{has_change_history:_=!1}=e,m;Se(async()=>{n(13,m=await _t())});let V=null,X=0,W=0,z=!1;const Q=()=>{o==="edit"?(n(0,o=""),n(12,V=t.duration)):n(0,o="edit")};function O(k){X=k,n(14,X)}function b(k){W=k,n(15,W)}function M(k){V=k,n(12,V),n(0,o),n(2,t)}function I(k){z=k,n(16,z)}const h=()=>{n(0,o=""),n(1,g=!0),ct(m,X,W,t).then(k=>{c(k)}).then(()=>{n(1,g=!1)})},N=()=>{a(),n(0,o="")},x=()=>u();return l.$$set=k=>{"videoElement"in k&&n(2,t=k.videoElement),"showRedo"in k&&n(3,i=k.showRedo),"interactive"in k&&n(4,r=k.interactive),"mode"in k&&n(0,o=k.mode),"handle_reset_value"in k&&n(5,a=k.handle_reset_value),"handle_trim_video"in k&&n(6,c=k.handle_trim_video),"processingVideo"in k&&n(1,g=k.processingVideo),"i18n"in k&&n(7,f=k.i18n),"value"in k&&n(8,v=k.value),"show_download_button"in k&&n(9,d=k.show_download_button),"handle_clear"in k&&n(10,u=k.handle_clear),"has_change_history"in k&&n(11,_=k.has_change_history)},l.$$.update=()=>{l.$$.dirty&4101&&o==="edit"&&V===null&&t&&n(12,V=t.duration)},[o,g,t,i,r,a,c,f,v,d,u,_,V,m,X,W,z,Q,O,b,M,I,h,N,x]}class Dt extends pe{constructor(e){super(),Ee(this,e,Vt,Tt,me,{videoElement:2,showRedo:3,interactive:4,mode:0,handle_reset_value:5,handle_trim_video:6,processingVideo:1,i18n:7,value:8,show_download_button:9,handle_clear:10,has_change_history:11})}}function It(l){let e,n;return{c(){e=R("track"),this.h()},l(t){e=L(t,"TRACK",{kind:!0,src:!0}),this.h()},h(){p(e,"kind","captions"),ke(e.src,n=l[1])||p(e,"src",n),e.default=!0},m(t,i){P(t,e,i)},p(t,i){i[0]&2&&!ke(e.src,n=t[1])&&p(e,"src",n)},d(t){t&&E(e)}}}function St(l){let e,n;return e=new ft({}),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Rt(l){let e,n;return e=new dt({}),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Lt(l){let e,n;return e=new Ke({}),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Xe(l){let e,n,t;function i(o){l[38](o)}let r={videoElement:l[17],showRedo:!0,handle_trim_video:l[23],handle_reset_value:l[7],value:l[11],i18n:l[9],show_download_button:l[10],handle_clear:l[12],has_change_history:l[13]};return l[18]!==void 0&&(r.processingVideo=l[18]),e=new Dt({props:r}),te.push(()=>ne(e,"processingVideo",i)),{c(){q(e.$$.fragment)},l(o){A(e.$$.fragment,o)},m(o,a){U(e,o,a),t=!0},p(o,a){const c={};a[0]&131072&&(c.videoElement=o[17]),a[0]&128&&(c.handle_reset_value=o[7]),a[0]&2048&&(c.value=o[11]),a[0]&512&&(c.i18n=o[9]),a[0]&1024&&(c.show_download_button=o[10]),a[0]&4096&&(c.handle_clear=o[12]),a[0]&8192&&(c.has_change_history=o[13]),!n&&a[0]&262144&&(n=!0,c.processingVideo=o[18],le(()=>n=!1)),e.$set(c)},i(o){t||(y(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){H(e,o)}}}function Mt(l){let e,n,t,i,r,o,a,c,g,f,v,d,u,_,m,V=de(l[14])+"",X,W,z=de(l[15])+"",Q,O,b,M,I,h,N,x,k,j,ce,he;function ye(w){l[28](w)}function Te(w){l[29](w)}function Ve(w){l[30](w)}function De(w){l[31](w)}let ue={src:l[0],preload:"auto",autoplay:l[3],loop:l[4],is_stream:l[8],"data-testid":`${l[5]}-player`,processingVideo:l[18],$$slots:{default:[It]},$$scope:{ctx:l}};l[14]!==void 0&&(ue.currentTime=l[14]),l[15]!==void 0&&(ue.duration=l[15]),l[16]!==void 0&&(ue.paused=l[16]),l[17]!==void 0&&(ue.node=l[17]),t=new mt({props:ue}),te.push(()=>ne(t,"currentTime",ye)),te.push(()=>ne(t,"duration",Te)),te.push(()=>ne(t,"paused",Ve)),te.push(()=>ne(t,"node",De)),t.$on("click",l[20]),t.$on("play",l[32]),t.$on("pause",l[33]),t.$on("error",l[34]),t.$on("ended",l[22]),t.$on("loadstart",l[35]),t.$on("loadeddata",l[36]),t.$on("loadedmetadata",l[37]);const ge=[Lt,Rt,St],ee=[];function be(w,D){return w[14]===w[15]?0:w[16]?1:2}d=be(l),u=ee[d]=ge[d](l),N=new ut({});let C=l[6]&&Xe(l);return{c(){e=R("div"),n=R("div"),q(t.$$.fragment),c=F(),g=R("div"),f=R("div"),v=R("span"),u.c(),_=F(),m=R("span"),X=ve(V),W=ve(" / "),Q=ve(z),O=F(),b=R("progress"),I=F(),h=R("div"),q(N.$$.fragment),x=F(),C&&C.c(),k=ae(),this.h()},l(w){e=L(w,"DIV",{class:!0});var D=B(e);n=L(D,"DIV",{class:!0});var s=B(n);A(t.$$.fragment,s),s.forEach(E),c=G(D),g=L(D,"DIV",{class:!0});var Y=B(g);f=L(Y,"DIV",{class:!0});var K=B(f);v=L(K,"SPAN",{role:!0,tabindex:!0,class:!0,"aria-label":!0});var fe=B(v);u.l(fe),fe.forEach(E),_=G(K),m=L(K,"SPAN",{class:!0});var se=B(m);X=we(se,V),W=we(se," / "),Q=we(se,z),se.forEach(E),O=G(K),b=L(K,"PROGRESS",{class:!0}),B(b).forEach(E),I=G(K),h=L(K,"DIV",{role:!0,tabindex:!0,class:!0,"aria-label":!0});var Ce=B(h);A(N.$$.fragment,Ce),Ce.forEach(E),K.forEach(E),Y.forEach(E),D.forEach(E),x=G(w),C&&C.l(w),k=ae(),this.h()},h(){p(n,"class","mirror-wrap svelte-euo1cw"),$(n,"mirror",l[2]),p(v,"role","button"),p(v,"tabindex","0"),p(v,"class","icon svelte-euo1cw"),p(v,"aria-label","play-pause-replay-button"),p(m,"class","time svelte-euo1cw"),b.value=M=l[14]/l[15]||0,p(b,"class","svelte-euo1cw"),p(h,"role","button"),p(h,"tabindex","0"),p(h,"class","icon svelte-euo1cw"),p(h,"aria-label","full-screen"),p(f,"class","inner svelte-euo1cw"),p(g,"class","controls svelte-euo1cw"),p(e,"class","wrap svelte-euo1cw")},m(w,D){P(w,e,D),S(e,n),U(t,n,null),S(e,c),S(e,g),S(g,f),S(f,v),ee[d].m(v,null),S(f,_),S(f,m),S(m,X),S(m,W),S(m,Q),S(f,O),S(f,b),S(f,I),S(f,h),U(N,h,null),P(w,x,D),C&&C.m(w,D),P(w,k,D),j=!0,ce||(he=[J(v,"click",l[20]),J(v,"keydown",l[20]),J(b,"mousemove",l[19]),J(b,"touchmove",Ne(l[19])),J(b,"click",Ze(Ne(l[21]))),J(h,"click",l[24]),J(h,"keypress",l[24])],ce=!0)},p(w,D){const s={};D[0]&1&&(s.src=w[0]),D[0]&8&&(s.autoplay=w[3]),D[0]&16&&(s.loop=w[4]),D[0]&256&&(s.is_stream=w[8]),D[0]&32&&(s["data-testid"]=`${w[5]}-player`),D[0]&262144&&(s.processingVideo=w[18]),D[0]&2|D[1]&512&&(s.$$scope={dirty:D,ctx:w}),!i&&D[0]&16384&&(i=!0,s.currentTime=w[14],le(()=>i=!1)),!r&&D[0]&32768&&(r=!0,s.duration=w[15],le(()=>r=!1)),!o&&D[0]&65536&&(o=!0,s.paused=w[16],le(()=>o=!1)),!a&&D[0]&131072&&(a=!0,s.node=w[17],le(()=>a=!1)),t.$set(s),(!j||D[0]&4)&&$(n,"mirror",w[2]);let Y=d;d=be(w),d!==Y&&(ie(),T(ee[Y],1,1,()=>{ee[Y]=null}),oe(),u=ee[d],u||(u=ee[d]=ge[d](w),u.c()),y(u,1),u.m(v,null)),(!j||D[0]&16384)&&V!==(V=de(w[14])+"")&&Le(X,V),(!j||D[0]&32768)&&z!==(z=de(w[15])+"")&&Le(Q,z),(!j||D[0]&49152&&M!==(M=w[14]/w[15]||0))&&(b.value=M),w[6]?C?(C.p(w,D),D[0]&64&&y(C,1)):(C=Xe(w),C.c(),y(C,1),C.m(k.parentNode,k)):C&&(ie(),T(C,1,1,()=>{C=null}),oe())},i(w){j||(y(t.$$.fragment,w),y(u),y(N.$$.fragment,w),y(C),j=!0)},o(w){T(t.$$.fragment,w),T(u),T(N.$$.fragment,w),T(C),j=!1},d(w){w&&(E(e),E(x),E(k)),H(t),ee[d].d(),H(N),C&&C.d(w),ce=!1,Me(he)}}}function Pt(l,e,n){let{root:t=""}=e,{src:i}=e,{subtitle:r=null}=e,{mirror:o}=e,{autoplay:a}=e,{loop:c}=e,{label:g="test"}=e,{interactive:f=!1}=e,{handle_change:v=()=>{}}=e,{handle_reset_value:d=()=>{}}=e,{upload:u}=e,{is_stream:_}=e,{i18n:m}=e,{show_download_button:V=!1}=e,{value:X=null}=e,{handle_clear:W=()=>{}}=e,{has_change_history:z=!1}=e;const Q=Ge();let O=0,b,M=!0,I,h=!1;function N(s){if(!b)return;if(s.type==="click"){k(s);return}if(s.type!=="touchmove"&&!(s.buttons&1))return;const Y=s.type==="touchmove"?s.touches[0].clientX:s.clientX,{left:K,right:fe}=s.currentTarget.getBoundingClientRect();n(14,O=b*(Y-K)/(fe-K))}async function x(){document.fullscreenElement!=I&&(I.currentTime>0&&!I.paused&&!I.ended&&I.readyState>I.HAVE_CURRENT_DATA?I.pause():await I.play())}function k(s){const{left:Y,right:K}=s.currentTarget.getBoundingClientRect();n(14,O=b*(s.clientX-Y)/(K-Y))}function j(){Q("stop"),Q("end")}const ce=async s=>{var se;let Y=new File([s],"video.mp4");const K=await et([Y]);let fe=(se=await u(K,t))==null?void 0:se.filter(Boolean)[0];v(fe)};function he(){I.requestFullscreen()}function ye(s){O=s,n(14,O)}function Te(s){b=s,n(15,b)}function Ve(s){M=s,n(16,M)}function De(s){I=s,n(17,I)}function ue(s){Z.call(this,l,s)}function ge(s){Z.call(this,l,s)}function ee(s){Z.call(this,l,s)}function be(s){Z.call(this,l,s)}function C(s){Z.call(this,l,s)}function w(s){Z.call(this,l,s)}function D(s){h=s,n(18,h)}return l.$$set=s=>{"root"in s&&n(25,t=s.root),"src"in s&&n(0,i=s.src),"subtitle"in s&&n(1,r=s.subtitle),"mirror"in s&&n(2,o=s.mirror),"autoplay"in s&&n(3,a=s.autoplay),"loop"in s&&n(4,c=s.loop),"label"in s&&n(5,g=s.label),"interactive"in s&&n(6,f=s.interactive),"handle_change"in s&&n(26,v=s.handle_change),"handle_reset_value"in s&&n(7,d=s.handle_reset_value),"upload"in s&&n(27,u=s.upload),"is_stream"in s&&n(8,_=s.is_stream),"i18n"in s&&n(9,m=s.i18n),"show_download_button"in s&&n(10,V=s.show_download_button),"value"in s&&n(11,X=s.value),"handle_clear"in s&&n(12,W=s.handle_clear),"has_change_history"in s&&n(13,z=s.has_change_history)},l.$$.update=()=>{l.$$.dirty[0]&16384&&n(14,O=O||0),l.$$.dirty[0]&32768&&n(15,b=b||0)},[i,r,o,a,c,g,f,d,_,m,V,X,W,z,O,b,M,I,h,N,x,k,j,ce,he,t,v,u,ye,Te,Ve,De,ue,ge,ee,be,C,w,D]}class Ct extends pe{constructor(e){super(),Ee(this,e,Pt,Mt,me,{root:25,src:0,subtitle:1,mirror:2,autoplay:3,loop:4,label:5,interactive:6,handle_change:26,handle_reset_value:7,upload:27,is_stream:8,i18n:9,show_download_button:10,value:11,handle_clear:12,has_change_history:13},null,[-1,-1])}}const Bt=Ct;function Nt(l){let e=l[0].url,n,t,i,r,o=ze(l);return i=new nt({props:{display_top_corner:l[10],$$slots:{default:[Ut]},$$scope:{ctx:l}}}),{c(){o.c(),n=F(),t=R("div"),q(i.$$.fragment),this.h()},l(a){o.l(a),n=G(a),t=L(a,"DIV",{"data-testid":!0});var c=B(t);A(i.$$.fragment,c),c.forEach(E),this.h()},h(){p(t,"data-testid","download-div")},m(a,c){o.m(a,c),P(a,n,c),P(a,t,c),U(i,t,null),r=!0},p(a,c){c&1&&me(e,e=a[0].url)?(ie(),T(o,1,1,_e),oe(),o=ze(a),o.c(),y(o,1),o.m(n.parentNode,n)):o.p(a,c);const g={};c&1024&&(g.display_top_corner=a[10]),c&4194657&&(g.$$scope={dirty:c,ctx:a}),i.$set(g)},i(a){r||(y(o),y(i.$$.fragment,a),r=!0)},o(a){T(o),T(i.$$.fragment,a),r=!1},d(a){a&&(E(n),E(t)),o.d(a),H(i)}}}function qt(l){let e,n;return e=new ot({props:{unpadded_box:!0,size:"large",$$slots:{default:[Ht]},$$scope:{ctx:l}}}),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p(t,i){const r={};i&4194304&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function ze(l){var t;let e,n;return e=new Bt({props:{src:l[0].url,subtitle:(t=l[1])==null?void 0:t.url,is_stream:l[0].is_stream,autoplay:l[4],mirror:!1,label:l[2],loop:l[7],interactive:!1,upload:l[9],i18n:l[8]}}),e.$on("play",l[12]),e.$on("pause",l[13]),e.$on("stop",l[14]),e.$on("end",l[15]),e.$on("loadedmetadata",l[16]),{c(){q(e.$$.fragment)},l(i){A(e.$$.fragment,i)},m(i,r){U(e,i,r),n=!0},p(i,r){var a;const o={};r&1&&(o.src=i[0].url),r&2&&(o.subtitle=(a=i[1])==null?void 0:a.url),r&1&&(o.is_stream=i[0].is_stream),r&16&&(o.autoplay=i[4]),r&4&&(o.label=i[2]),r&128&&(o.loop=i[7]),r&512&&(o.upload=i[9]),r&256&&(o.i18n=i[8]),e.$set(o)},i(i){n||(y(e.$$.fragment,i),n=!0)},o(i){T(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function je(l){var t;let e,n;return e=new it({props:{href:l[0].is_stream?(t=l[0].url)==null?void 0:t.replace("playlist.m3u8","playlist-file"):l[0].url,download:l[0].orig_name||l[0].path,$$slots:{default:[At]},$$scope:{ctx:l}}}),{c(){q(e.$$.fragment)},l(i){A(e.$$.fragment,i)},m(i,r){U(e,i,r),n=!0},p(i,r){var a;const o={};r&1&&(o.href=i[0].is_stream?(a=i[0].url)==null?void 0:a.replace("playlist.m3u8","playlist-file"):i[0].url),r&1&&(o.download=i[0].orig_name||i[0].path),r&4194304&&(o.$$scope={dirty:r,ctx:i}),e.$set(o)},i(i){n||(y(e.$$.fragment,i),n=!0)},o(i){T(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function At(l){let e,n;return e=new Pe({props:{Icon:at,label:"Download"}}),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p:_e,i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Fe(l){let e,n;return e=new rt({props:{i18n:l[8],value:l[0],formatter:l[17]}}),e.$on("error",l[18]),e.$on("share",l[19]),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},p(t,i){const r={};i&256&&(r.i18n=t[8]),i&1&&(r.value=t[0]),e.$set(r)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Ut(l){let e,n,t,i=l[6]&&je(l),r=l[5]&&Fe(l);return{c(){i&&i.c(),e=F(),r&&r.c(),n=ae()},l(o){i&&i.l(o),e=G(o),r&&r.l(o),n=ae()},m(o,a){i&&i.m(o,a),P(o,e,a),r&&r.m(o,a),P(o,n,a),t=!0},p(o,a){o[6]?i?(i.p(o,a),a&64&&y(i,1)):(i=je(o),i.c(),y(i,1),i.m(e.parentNode,e)):i&&(ie(),T(i,1,1,()=>{i=null}),oe()),o[5]?r?(r.p(o,a),a&32&&y(r,1)):(r=Fe(o),r.c(),y(r,1),r.m(n.parentNode,n)):r&&(ie(),T(r,1,1,()=>{r=null}),oe())},i(o){t||(y(i),y(r),t=!0)},o(o){T(i),T(r),t=!1},d(o){o&&(E(e),E(n)),i&&i.d(o),r&&r.d(o)}}}function Ht(l){let e,n;return e=new We({}),{c(){q(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,i){U(e,t,i),n=!0},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){H(e,t)}}}function Ot(l){let e,n,t,i,r,o;e=new lt({props:{show_label:l[3],Icon:We,label:l[2]||"Video"}});const a=[qt,Nt],c=[];function g(f,v){return!f[0]||f[0].url===void 0?0:1}return t=g(l),i=c[t]=a[t](l),{c(){q(e.$$.fragment),n=F(),i.c(),r=ae()},l(f){A(e.$$.fragment,f),n=G(f),i.l(f),r=ae()},m(f,v){U(e,f,v),P(f,n,v),c[t].m(f,v),P(f,r,v),o=!0},p(f,[v]){const d={};v&8&&(d.show_label=f[3]),v&4&&(d.label=f[2]||"Video"),e.$set(d);let u=t;t=g(f),t===u?c[t].p(f,v):(ie(),T(c[u],1,1,()=>{c[u]=null}),oe(),i=c[t],i?i.p(f,v):(i=c[t]=a[t](f),i.c()),y(i,1),i.m(r.parentNode,r))},i(f){o||(y(e.$$.fragment,f),y(i),o=!0)},o(f){T(e.$$.fragment,f),T(i),o=!1},d(f){f&&(E(n),E(r)),H(e,f),c[t].d(f)}}}function Xt(l,e,n){let{value:t=null}=e,{subtitle:i=null}=e,{label:r=void 0}=e,{show_label:o=!0}=e,{autoplay:a}=e,{show_share_button:c=!0}=e,{show_download_button:g=!0}=e,{loop:f}=e,{i18n:v}=e,{upload:d}=e,{display_icon_button_wrapper_top_corner:u=!1}=e,_=null,m=null;const V=Ge();xe(async()=>{t!==_&&i!==m&&m!==null&&(_=t,n(0,t=null),await $e(),n(0,t=_)),_=t,m=i});function X(h){Z.call(this,l,h)}function W(h){Z.call(this,l,h)}function z(h){Z.call(this,l,h)}function Q(h){Z.call(this,l,h)}const O=()=>{V("load")},b=async h=>h?await tt(h.data):"";function M(h){Z.call(this,l,h)}function I(h){Z.call(this,l,h)}return l.$$set=h=>{"value"in h&&n(0,t=h.value),"subtitle"in h&&n(1,i=h.subtitle),"label"in h&&n(2,r=h.label),"show_label"in h&&n(3,o=h.show_label),"autoplay"in h&&n(4,a=h.autoplay),"show_share_button"in h&&n(5,c=h.show_share_button),"show_download_button"in h&&n(6,g=h.show_download_button),"loop"in h&&n(7,f=h.loop),"i18n"in h&&n(8,v=h.i18n),"upload"in h&&n(9,d=h.upload),"display_icon_button_wrapper_top_corner"in h&&n(10,u=h.display_icon_button_wrapper_top_corner)},l.$$.update=()=>{l.$$.dirty&1&&t&&V("change",t)},[t,i,r,o,a,c,g,f,v,d,u,V,X,W,z,Q,O,b,M,I]}class zt extends pe{constructor(e){super(),Ee(this,e,Xt,Ot,me,{value:0,subtitle:1,label:2,show_label:3,autoplay:4,show_share_button:5,show_download_button:6,loop:7,i18n:8,upload:9,display_icon_button_wrapper_top_corner:10})}}const rn=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"}));export{Bt as P,zt as V,rn as a};
//# sourceMappingURL=VideoPreview.bdrmZITU.js.map
