import { c as create_ssr_component, b as createEventDispatcher, d as add_attribute, v as validate_component, h as add_styles, e as escape } from './ssr-C3HYbsxA.js';
import { _ as _t, j as ie, S as w, V as Kt$1, a0 as de, a1 as ce, a2 as Jt, a3 as Tt$1, F as xe, a4 as me, a5 as Ee, a6 as Ie, a7 as ye } from './2-CzxFoJuL.js';
import './hls-DpKhbIaL.js';

var kt=function(l,t,e,n){function i(r){return r instanceof e?r:new e(function(o){o(r);})}return new(e||(e=Promise))(function(r,o){function a(s){try{d(n.next(s));}catch(u){o(u);}}function c(s){try{d(n.throw(s));}catch(u){o(u);}}function d(s){s.done?r(s.value):i(s.value).then(a,c);}d((n=n.apply(l,[])).next());})};function xt(l,t){return kt(this,void 0,void 0,function*(){const e=new AudioContext({sampleRate:t});return e.decodeAudioData(l).finally(()=>e.close())})}function It(l){const t=l[0];if(t.some(e=>e>1||e<-1)){const e=t.length;let n=0;for(let i=0;i<e;i++){const r=Math.abs(t[i]);r>n&&(n=r);}for(const i of l)for(let r=0;r<e;r++)i[r]/=n;}return l}function Rt(l,t){return typeof l[0]=="number"&&(l=[l]),It(l),{duration:t,length:l[0].length,sampleRate:l[0].length/t,numberOfChannels:l.length,getChannelData:e=>l?.[e],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}const X={decode:xt,createBuffer:Rt};var et=function(l,t,e,n){function i(r){return r instanceof e?r:new e(function(o){o(r);})}return new(e||(e=Promise))(function(r,o){function a(s){try{d(n.next(s));}catch(u){o(u);}}function c(s){try{d(n.throw(s));}catch(u){o(u);}}function d(s){s.done?r(s.value):i(s.value).then(a,c);}d((n=n.apply(l,[])).next());})};function Mt(l,t,e){var n,i;return et(this,void 0,void 0,function*(){const r=yield fetch(l,e);{const o=(n=r.clone().body)===null||n===void 0?void 0:n.getReader(),a=Number((i=r.headers)===null||i===void 0?void 0:i.get("Content-Length"));let c=0;const d=(s,u)=>et(this,void 0,void 0,function*(){if(s)return;c+=u?.length||0;const v=Math.round(c/a*100);return t(v),o?.read().then(({done:h,value:A})=>d(h,A))});o?.read().then(({done:s,value:u})=>d(s,u));}return r.blob()})}const Bt={fetchBlob:Mt};class Y{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener;}addEventListener(t,e,n){if(this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(e),n?.once){const i=()=>{this.removeEventListener(t,i),this.removeEventListener(t,e);};return this.addEventListener(t,i),i}return ()=>this.removeEventListener(t,e)}removeEventListener(t,e){var n;(n=this.listeners[t])===null||n===void 0||n.delete(e);}once(t,e){return this.on(t,e,{once:!0})}unAll(){this.listeners={};}emit(t,...e){this.listeners[t]&&this.listeners[t].forEach(n=>n(...e));}}class St extends Y{constructor(t){super(),this.isExternalMedia=!1,t.media?(this.media=t.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),t.mediaControls&&(this.media.controls=!0),t.autoplay&&(this.media.autoplay=!0),t.playbackRate!=null&&this.onceMediaEvent("canplay",()=>{t.playbackRate!=null&&(this.media.playbackRate=t.playbackRate);});}onMediaEvent(t,e,n){return this.media.addEventListener(t,e,n),()=>this.media.removeEventListener(t,e)}onceMediaEvent(t,e){return this.onMediaEvent(t,e,{once:!0})}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const t=this.getSrc();t.startsWith("blob:")&&URL.revokeObjectURL(t);}setSrc(t,e){if(this.getSrc()===t)return;this.revokeSrc();const i=e instanceof Blob?URL.createObjectURL(e):t;this.media.src=i,this.media.load();}destroy(){this.media.pause(),!this.isExternalMedia&&(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load());}setMediaElement(t){this.media=t;}play(){return this.media.play()}pause(){this.media.pause();}isPlaying(){return !this.media.paused&&!this.media.ended}setTime(t){this.media.currentTime=t;}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(t){this.media.volume=t;}getMuted(){return this.media.muted}setMuted(t){this.media.muted=t;}getPlaybackRate(){return this.media.playbackRate}setPlaybackRate(t,e){e!=null&&(this.media.preservesPitch=e),this.media.playbackRate=t;}getMediaElement(){return this.media}setSinkId(t){return this.media.setSinkId(t)}}function jt(l,t,e,n,i=5){let r=()=>{};if(!l)return r;const o=a=>{if(a.button===2)return;a.preventDefault(),a.stopPropagation(),l.style.touchAction="none";let c=a.clientX,d=a.clientY,s=!1;const u=A=>{A.preventDefault(),A.stopPropagation();const f=A.clientX,p=A.clientY;if(s||Math.abs(f-c)>=i||Math.abs(p-d)>=i){const{left:b,top:g}=l.getBoundingClientRect();s||(s=!0,e?.(c-b,d-g)),t(f-c,p-d,f-b,p-g),c=f,d=p;}},v=A=>{s&&(A.preventDefault(),A.stopPropagation());},h=()=>{l.style.touchAction="",s&&n?.(),r();};document.addEventListener("pointermove",u),document.addEventListener("pointerup",h),document.addEventListener("pointerleave",h),document.addEventListener("click",v,!0),r=()=>{document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",h),document.removeEventListener("pointerleave",h),setTimeout(()=>{document.removeEventListener("click",v,!0);},10);};};return l.addEventListener("pointerdown",o),()=>{r(),l.removeEventListener("pointerdown",o);}}class N extends Y{constructor(t,e){super(),this.timeouts=[],this.isScrolling=!1,this.audioData=null,this.resizeObserver=null,this.isDragging=!1,this.options=t;const n=this.parentFromOptionsContainer(t.container);this.parent=n;const[i,r]=this.initHtml();n.appendChild(i),this.container=i,this.scrollContainer=r.querySelector(".scroll"),this.wrapper=r.querySelector(".wrapper"),this.canvasWrapper=r.querySelector(".canvases"),this.progressWrapper=r.querySelector(".progress"),this.cursor=r.querySelector(".cursor"),e&&r.appendChild(e),this.initEvents();}parentFromOptionsContainer(t){let e;if(typeof t=="string"?e=document.querySelector(t):t instanceof HTMLElement&&(e=t),!e)throw new Error("Container not found");return e}initEvents(){const t=n=>{const i=this.wrapper.getBoundingClientRect(),r=n.clientX-i.left,o=n.clientX-i.left,a=r/i.width,c=o/i.height;return [a,c]};this.wrapper.addEventListener("click",n=>{const[i,r]=t(n);this.emit("click",i,r);}),this.wrapper.addEventListener("dblclick",n=>{const[i,r]=t(n);this.emit("dblclick",i,r);}),this.options.dragToSeek&&this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:n,scrollWidth:i,clientWidth:r}=this.scrollContainer,o=n/i,a=(n+r)/i;this.emit("scroll",o,a);});const e=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{e(()=>this.reRender());}),this.resizeObserver.observe(this.scrollContainer);}initDrag(){jt(this.wrapper,(t,e,n)=>{this.emit("drag",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)));},()=>this.isDragging=!0,()=>this.isDragging=!1);}getHeight(){return this.options.height==null?128:isNaN(Number(this.options.height))?this.options.height==="auto"&&this.parent.clientHeight||128:Number(this.options.height)}initHtml(){const t=document.createElement("div"),e=t.attachShadow({mode:"open"});return e.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight()}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[t,e]}setOptions(t){if(this.options.container!==t.container){const e=this.parentFromOptionsContainer(t.container);e.appendChild(this.container),this.parent=e;}t.dragToSeek&&!this.options.dragToSeek&&this.initDrag(),this.options=t,this.reRender();}getWrapper(){return this.wrapper}getScroll(){return this.scrollContainer.scrollLeft}destroy(){var t;this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect();}createDelay(t=10){const e={};return this.timeouts.push(e),n=>{e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(n,t);}}convertColorValues(t){if(!Array.isArray(t))return t||"";if(t.length<2)return t[0]||"";const e=document.createElement("canvas"),i=e.getContext("2d").createLinearGradient(0,0,0,e.height),r=1/(t.length-1);return t.forEach((o,a)=>{const c=a*r;i.addColorStop(c,o);}),i}renderBarWaveform(t,e,n,i){const r=t[0],o=t[1]||t[0],a=r.length,{width:c,height:d}=n.canvas,s=d/2,u=window.devicePixelRatio||1,v=e.barWidth?e.barWidth*u:1,h=e.barGap?e.barGap*u:e.barWidth?v/2:0,A=e.barRadius||0,f=c/(v+h)/a,p=A&&"roundRect"in n?"roundRect":"rect";n.beginPath();let b=0,g=0,_=0;for(let m=0;m<=a;m++){const C=Math.round(m*f);if(C>b){const k=Math.round(g*s*i),B=Math.round(_*s*i),R=k+B||1;let M=s-k;e.barAlign==="top"?M=0:e.barAlign==="bottom"&&(M=d-R),n[p](b*(v+h),M,v,R,A),b=C,g=0,_=0;}const E=Math.abs(r[m]||0),x=Math.abs(o[m]||0);E>g&&(g=E),x>_&&(_=x);}n.fill(),n.closePath();}renderLineWaveform(t,e,n,i){const r=o=>{const a=t[o]||t[0],c=a.length,{height:d}=n.canvas,s=d/2,u=n.canvas.width/c;n.moveTo(0,s);let v=0,h=0;for(let A=0;A<=c;A++){const f=Math.round(A*u);if(f>v){const b=Math.round(h*s*i)||1,g=s+b*(o===0?-1:1);n.lineTo(v,g),v=f,h=0;}const p=Math.abs(a[A]||0);p>h&&(h=p);}n.lineTo(v,s);};n.beginPath(),r(0),r(1),n.fill(),n.closePath();}renderWaveform(t,e,n){if(n.fillStyle=this.convertColorValues(e.waveColor),e.renderFunction){e.renderFunction(t,n);return}let i=e.barHeight||1;if(e.normalize){const r=Array.from(t[0]).reduce((o,a)=>Math.max(o,Math.abs(a)),0);i=r?1/r:1;}if(e.barWidth||e.barGap||e.barAlign){this.renderBarWaveform(t,e,n,i);return}this.renderLineWaveform(t,e,n,i);}renderSingleCanvas(t,e,n,i,r,o,a,c){const d=window.devicePixelRatio||1,s=document.createElement("canvas"),u=t[0].length;s.width=Math.round(n*(o-r)/u),s.height=i*d,s.style.width=`${Math.floor(s.width/d)}px`,s.style.height=`${i}px`,s.style.left=`${Math.floor(r*n/d/u)}px`,a.appendChild(s);const v=s.getContext("2d");if(this.renderWaveform(t.map(h=>h.slice(r,o)),e,v),s.width>0&&s.height>0){const h=s.cloneNode(),A=h.getContext("2d");A.drawImage(s,0,0),A.globalCompositeOperation="source-in",A.fillStyle=this.convertColorValues(e.progressColor),A.fillRect(0,0,s.width,s.height),c.appendChild(h);}}renderChannel(t,e,n){const i=document.createElement("div"),r=this.getHeight();i.style.height=`${r}px`,this.canvasWrapper.style.minHeight=`${r}px`,this.canvasWrapper.appendChild(i);const o=i.cloneNode();this.progressWrapper.appendChild(o);const{scrollLeft:a,scrollWidth:c,clientWidth:d}=this.scrollContainer,s=t[0].length,u=s/c;let v=Math.min(N.MAX_CANVAS_WIDTH,d);if(e.barWidth||e.barGap){const C=e.barWidth||.5,E=e.barGap||C/2,x=C+E;v%x!==0&&(v=Math.floor(v/x)*x);}const h=Math.floor(Math.abs(a)*u),A=Math.floor(h+v*u),f=A-h,p=(C,E)=>{this.renderSingleCanvas(t,e,n,r,Math.max(0,C),Math.min(E,s),i,o);},b=this.createDelay(),g=this.createDelay(),_=(C,E)=>{p(C,E),C>0&&b(()=>{_(C-f,E-f);});},m=(C,E)=>{p(C,E),E<s&&g(()=>{m(C+f,E+f);});};_(h,A),A<s&&m(A,A+f);}render(t){this.timeouts.forEach(a=>a.timeout&&clearTimeout(a.timeout)),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.wrapper.style.width="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const e=window.devicePixelRatio||1,n=this.scrollContainer.clientWidth,i=Math.ceil(t.duration*(this.options.minPxPerSec||0));this.isScrolling=i>n;const r=this.options.fillParent&&!this.isScrolling,o=(r?n:i)*e;if(this.wrapper.style.width=r?"100%":`${i}px`,this.scrollContainer.style.overflowX=this.isScrolling?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.options.splitChannels)for(let a=0;a<t.numberOfChannels;a++){const c=Object.assign(Object.assign({},this.options),this.options.splitChannels[a]);this.renderChannel([t.getChannelData(a)],c,o);}else {const a=[t.getChannelData(0)];t.numberOfChannels>1&&a.push(t.getChannelData(1)),this.renderChannel(a,this.options,o);}this.audioData=t,this.emit("render");}reRender(){if(!this.audioData)return;const t=this.progressWrapper.clientWidth;this.render(this.audioData);const e=this.progressWrapper.clientWidth;this.scrollContainer.scrollLeft+=e-t;}zoom(t){this.options.minPxPerSec=t,this.reRender();}scrollIntoView(t,e=!1){const{clientWidth:n,scrollLeft:i,scrollWidth:r}=this.scrollContainer,o=r*t,a=n/2,c=e&&this.options.autoCenter&&!this.isDragging?a:n;if(o>i+c||o<i)if(this.options.autoCenter&&!this.isDragging){const d=a/20;o-(i+a)>=d&&o<i+n?this.scrollContainer.scrollLeft+=d:this.scrollContainer.scrollLeft=o-a;}else this.isDragging?this.scrollContainer.scrollLeft=o<i?o-10:o-n+10:this.scrollContainer.scrollLeft=o;{const{scrollLeft:d}=this.scrollContainer,s=d/r,u=(d+n)/r;this.emit("scroll",s,u);}}renderProgress(t,e){if(isNaN(t))return;const n=t*100;this.canvasWrapper.style.clipPath=`polygon(${n}% 0, 100% 0, 100% 100%, ${n}% 100%)`,this.progressWrapper.style.width=`${n}%`,this.cursor.style.left=`${n}%`,this.cursor.style.marginLeft=Math.round(n)===100?`-${this.options.cursorWidth}px`:"",this.isScrolling&&this.options.autoScroll&&this.scrollIntoView(t,e);}}N.MAX_CANVAS_WIDTH=4e3;class Lt extends Y{constructor(){super(...arguments),this.unsubscribe=()=>{};}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick");});}),this.emit("tick");}stop(){this.unsubscribe();}destroy(){this.unsubscribe();}}var Z=function(l,t,e,n){function i(r){return r instanceof e?r:new e(function(o){o(r);})}return new(e||(e=Promise))(function(r,o){function a(s){try{d(n.next(s));}catch(u){o(u);}}function c(s){try{d(n.throw(s));}catch(u){o(u);}}function d(s){s.done?r(s.value):i(s.value).then(a,c);}d((n=n.apply(l,[])).next());})};class Wt extends Y{constructor(t=new AudioContext){super(),this.bufferNode=null,this.autoplay=!1,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.audioContext=t,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination);}load(){return Z(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(t){this.currentSrc=t,fetch(t).then(e=>e.arrayBuffer()).then(e=>this.audioContext.decodeAudioData(e)).then(e=>{this.buffer=e,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play();});}_play(){var t;this.paused&&(this.paused=!1,(t=this.bufferNode)===null||t===void 0||t.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.bufferNode.buffer=this.buffer,this.bufferNode.connect(this.gainNode),this.playedDuration>=this.duration&&(this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,this.playedDuration),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"));});}_pause(){var t;this.paused||(this.paused=!0,(t=this.bufferNode)===null||t===void 0||t.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime);}play(){return Z(this,void 0,void 0,function*(){this._play(),this.emit("play");})}pause(){this._pause(),this.emit("pause");}setSinkId(t){return Z(this,void 0,void 0,function*(){return this.audioContext.setSinkId(t)})}get playbackRate(){var t,e;return (e=(t=this.bufferNode)===null||t===void 0?void 0:t.playbackRate.value)!==null&&e!==void 0?e:1}set playbackRate(t){this.bufferNode&&(this.bufferNode.playbackRate.value=t);}get currentTime(){return this.paused?this.playedDuration:this.playedDuration+this.audioContext.currentTime-this.playStartTime}set currentTime(t){this.emit("seeking"),this.paused?this.playedDuration=t:(this._pause(),this.playedDuration=t,this._play()),this.emit("timeupdate");}get duration(){var t;return ((t=this.buffer)===null||t===void 0?void 0:t.duration)||0}get volume(){return this.gainNode.gain.value}set volume(t){this.gainNode.gain.value=t,this.emit("volumechange");}get muted(){return this._muted}set muted(t){this._muted!==t&&(this._muted=t,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination));}getGainNode(){return this.gainNode}}var H=function(l,t,e,n){function i(r){return r instanceof e?r:new e(function(o){o(r);})}return new(e||(e=Promise))(function(r,o){function a(s){try{d(n.next(s));}catch(u){o(u);}}function c(s){try{d(n.throw(s));}catch(u){o(u);}}function d(s){s.done?r(s.value):i(s.value).then(a,c);}d((n=n.apply(l,[])).next());})};const zt={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class J extends St{static create(t){return new J(t)}constructor(t){const e=t.media||(t.backend==="WebAudio"?new Wt:void 0);super({media:e,mediaControls:t.mediaControls,autoplay:t.autoplay,playbackRate:t.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.options=Object.assign({},zt,t),this.timer=new Lt;const n=e?void 0:this.getMediaElement();this.renderer=new N(this.options,n),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const i=this.options.url||this.getSrc();i?this.load(i,this.options.peaks,this.options.duration):this.options.peaks&&this.options.duration&&this.loadPredecoded();}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{const t=this.getCurrentTime();this.renderer.renderProgress(t/this.getDuration(),!0),this.emit("timeupdate",t),this.emit("audioprocess",t);}));}initPlayerEvents(){this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const t=this.getCurrentTime();this.renderer.renderProgress(t/this.getDuration(),this.isPlaying()),this.emit("timeupdate",t);}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start();}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop();}),this.onMediaEvent("emptied",()=>{this.timer.stop();}),this.onMediaEvent("ended",()=>{this.emit("finish");}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime());}));}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(t,e)=>{this.options.interact&&(this.seekTo(t),this.emit("interaction",t*this.getDuration()),this.emit("click",t,e));}),this.renderer.on("dblclick",(t,e)=>{this.emit("dblclick",t,e);}),this.renderer.on("scroll",(t,e)=>{const n=this.getDuration();this.emit("scroll",t*n,e*n);}),this.renderer.on("render",()=>{this.emit("redraw");}));{let t;this.subscriptions.push(this.renderer.on("drag",e=>{this.options.interact&&(this.renderer.renderProgress(e),clearTimeout(t),t=setTimeout(()=>{this.seekTo(e);},this.isPlaying()?0:200),this.emit("interaction",e*this.getDuration()),this.emit("drag",e));}));}}initPlugins(){var t;!((t=this.options.plugins)===null||t===void 0)&&t.length&&this.options.plugins.forEach(e=>{this.registerPlugin(e);});}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(t=>t()),this.mediaSubscriptions=[];}setOptions(t){this.options=Object.assign({},this.options,t),this.renderer.setOptions(this.options),t.audioRate&&this.setPlaybackRate(t.audioRate),t.mediaControls!=null&&(this.getMediaElement().controls=t.mediaControls);}registerPlugin(t){return t.init(this),this.plugins.push(t),this.subscriptions.push(t.once("destroy",()=>{this.plugins=this.plugins.filter(e=>e!==t);})),t}getWrapper(){return this.renderer.getWrapper()}getScroll(){return this.renderer.getScroll()}getActivePlugins(){return this.plugins}loadPredecoded(){return H(this,void 0,void 0,function*(){this.options.peaks&&this.options.duration&&(this.decodedData=X.createBuffer(this.options.peaks,this.options.duration),yield Promise.resolve(),this.renderDecoded());})}renderDecoded(){return H(this,void 0,void 0,function*(){this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData));})}loadAudio(t,e,n,i){return H(this,void 0,void 0,function*(){if(this.emit("load",t),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!e&&!n){const r=o=>this.emit("loading",o);e=yield Bt.fetchBlob(t,r,this.options.fetchParams);}if(this.setSrc(t,e),i=(yield Promise.resolve(i||this.getDuration()))||(yield new Promise(r=>{this.onceMediaEvent("loadedmetadata",()=>r(this.getDuration()));}))||(yield Promise.resolve(0)),n)this.decodedData=X.createBuffer(n,i);else if(e){const r=yield e.arrayBuffer();this.decodedData=yield X.decode(r,this.options.sampleRate);}this.renderDecoded(),this.emit("ready",this.getDuration());})}load(t,e,n){return H(this,void 0,void 0,function*(){yield this.loadAudio(t,void 0,e,n);})}loadBlob(t,e,n){return H(this,void 0,void 0,function*(){yield this.loadAudio("blob",t,e,n);})}zoom(t){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(t),this.emit("zoom",t);}getDecodedData(){return this.decodedData}exportPeaks({channels:t=2,maxLength:e=8e3,precision:n=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const i=Math.min(t,this.decodedData.numberOfChannels),r=[];for(let o=0;o<i;o++){const a=this.decodedData.getChannelData(o),c=[],d=Math.round(a.length/e);for(let s=0;s<e;s++){const u=a.slice(s*d,(s+1)*d),v=Math.max(...u);c.push(Math.round(v*n)/n);}r.push(c);}return r}getDuration(){let t=super.getDuration()||0;return (t===0||t===1/0)&&this.decodedData&&(t=this.decodedData.duration),t}toggleInteraction(t){this.options.interact=t;}seekTo(t){const e=this.getDuration()*t;this.setTime(e);}playPause(){return H(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0);}skip(t){this.setTime(this.getCurrentTime()+t);}empty(){this.load("",[[0]],.001);}setMediaElement(t){this.unsubscribePlayerEvents(),super.setMediaElement(t),this.initPlayerEvents();}destroy(){this.emit("destroy"),this.plugins.forEach(t=>t.destroy()),this.subscriptions.forEach(t=>t()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy();}}function Dt(l){const t=l.numberOfChannels,e=l.length*t*2+44,n=new ArrayBuffer(e),i=new DataView(n);let r=0;const o=function(a,c,d){for(let s=0;s<d.length;s++)a.setUint8(c+s,d.charCodeAt(s));};o(i,r,"RIFF"),r+=4,i.setUint32(r,e-8,!0),r+=4,o(i,r,"WAVE"),r+=4,o(i,r,"fmt "),r+=4,i.setUint32(r,16,!0),r+=4,i.setUint16(r,1,!0),r+=2,i.setUint16(r,t,!0),r+=2,i.setUint32(r,l.sampleRate,!0),r+=4,i.setUint32(r,l.sampleRate*2*t,!0),r+=4,i.setUint16(r,t*2,!0),r+=2,i.setUint16(r,16,!0),r+=2,o(i,r,"data"),r+=4,i.setUint32(r,l.length*t*2,!0),r+=4;for(let a=0;a<l.length;a++)for(let c=0;c<t;c++){const d=Math.max(-1,Math.min(1,l.getChannelData(c)[a]));i.setInt16(r,d*32767,!0),r+=2;}return new Uint8Array(n)}const Ot=async(l,t,e,n)=>{const i=new AudioContext({sampleRate:n||l.sampleRate}),r=l.numberOfChannels,o=n||l.sampleRate;let a=l.length,c=0;t&&e&&(c=Math.round(t*o),a=Math.round(e*o)-c);const d=i.createBuffer(r,a,o);for(let s=0;s<r;s++){const u=l.getChannelData(s),v=d.getChannelData(s);for(let h=0;h<a;h++)v[h]=u[c+h];}return Dt(d)},it=(l,t)=>(t||(t=5),l/100*t||5);class lt{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener;}addEventListener(t,e,n){if(this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(e),n?.once){const i=()=>{this.removeEventListener(t,i),this.removeEventListener(t,e);};return this.addEventListener(t,i),i}return ()=>this.removeEventListener(t,e)}removeEventListener(t,e){var n;(n=this.listeners[t])===null||n===void 0||n.delete(e);}once(t,e){return this.on(t,e,{once:!0})}unAll(){this.listeners={};}emit(t,...e){this.listeners[t]&&this.listeners[t].forEach(n=>n(...e));}}class Pt extends lt{constructor(t){super(),this.subscriptions=[],this.options=t;}onInit(){}init(t){this.wavesurfer=t,this.onInit();}destroy(){this.emit("destroy"),this.subscriptions.forEach(t=>t());}}function V(l,t,e,n,i=5){let r=()=>{};if(!l)return r;const o=a=>{if(a.button===2)return;a.preventDefault(),a.stopPropagation(),l.style.touchAction="none";let c=a.clientX,d=a.clientY,s=!1;const u=A=>{A.preventDefault(),A.stopPropagation();const f=A.clientX,p=A.clientY;if(s||Math.abs(f-c)>=i||Math.abs(p-d)>=i){const{left:b,top:g}=l.getBoundingClientRect();s||(s=!0,e?.(c-b,d-g)),t(f-c,p-d,f-b,p-g),c=f,d=p;}},v=A=>{s&&(A.preventDefault(),A.stopPropagation());},h=()=>{l.style.touchAction="",s&&n?.(),r();};document.addEventListener("pointermove",u),document.addEventListener("pointerup",h),document.addEventListener("pointerleave",h),document.addEventListener("click",v,!0),r=()=>{document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",h),document.removeEventListener("pointerleave",h),setTimeout(()=>{document.removeEventListener("click",v,!0);},10);};};return l.addEventListener("pointerdown",o),()=>{r(),l.removeEventListener("pointerdown",o);}}class rt extends lt{constructor(t,e,n=0){var i,r,o,a,c,d,s;super(),this.totalDuration=e,this.numberOfChannels=n,this.minLength=0,this.maxLength=1/0,this.id=t.id||`region-${Math.random().toString(32).slice(2)}`,this.start=this.clampPosition(t.start),this.end=this.clampPosition((i=t.end)!==null&&i!==void 0?i:t.start),this.drag=(r=t.drag)===null||r===void 0||r,this.resize=(o=t.resize)===null||o===void 0||o,this.color=(a=t.color)!==null&&a!==void 0?a:"rgba(0, 0, 0, 0.1)",this.minLength=(c=t.minLength)!==null&&c!==void 0?c:this.minLength,this.maxLength=(d=t.maxLength)!==null&&d!==void 0?d:this.maxLength,this.channelIdx=(s=t.channelIdx)!==null&&s!==void 0?s:-1,this.element=this.initElement(),this.setContent(t.content),this.setPart(),this.renderPosition(),this.initMouseEvents();}clampPosition(t){return Math.max(0,Math.min(this.totalDuration,t))}setPart(){const t=this.start===this.end;this.element.setAttribute("part",`${t?"marker":"region"} ${this.id}`);}addResizeHandles(t){const e=document.createElement("div");e.setAttribute("data-resize","left"),e.setAttribute("style",`
        position: absolute;
        z-index: 2;
        width: 6px;
        height: 100%;
        top: 0;
        left: 0;
        border-left: 2px solid rgba(0, 0, 0, 0.5);
        border-radius: 2px 0 0 2px;
        cursor: ew-resize;
        word-break: keep-all;
      `),e.setAttribute("part","region-handle region-handle-left");const n=e.cloneNode();n.setAttribute("data-resize","right"),n.style.left="",n.style.right="0",n.style.borderRight=n.style.borderLeft,n.style.borderLeft="",n.style.borderRadius="0 2px 2px 0",n.setAttribute("part","region-handle region-handle-right"),t.appendChild(e),t.appendChild(n),V(e,i=>this.onResize(i,"start"),()=>null,()=>this.onEndResizing(),1),V(n,i=>this.onResize(i,"end"),()=>null,()=>this.onEndResizing(),1);}removeResizeHandles(t){const e=t.querySelector('[data-resize="left"]'),n=t.querySelector('[data-resize="right"]');e&&t.removeChild(e),n&&t.removeChild(n);}initElement(){const t=document.createElement("div"),e=this.start===this.end;let n=0,i=100;return this.channelIdx>=0&&this.channelIdx<this.numberOfChannels&&(i=100/this.numberOfChannels,n=i*this.channelIdx),t.setAttribute("style",`
      position: absolute;
      top: ${n}%;
      height: ${i}%;
      background-color: ${e?"none":this.color};
      border-left: ${e?"2px solid "+this.color:"none"};
      border-radius: 2px;
      box-sizing: border-box;
      transition: background-color 0.2s ease;
      cursor: ${this.drag?"grab":"default"};
      pointer-events: all;
    `),!e&&this.resize&&this.addResizeHandles(t),t}renderPosition(){const t=this.start/this.totalDuration,e=(this.totalDuration-this.end)/this.totalDuration;this.element.style.left=100*t+"%",this.element.style.right=100*e+"%";}initMouseEvents(){const{element:t}=this;t&&(t.addEventListener("click",e=>this.emit("click",e)),t.addEventListener("mouseenter",e=>this.emit("over",e)),t.addEventListener("mouseleave",e=>this.emit("leave",e)),t.addEventListener("dblclick",e=>this.emit("dblclick",e)),V(t,e=>this.onMove(e),()=>this.onStartMoving(),()=>this.onEndMoving()));}onStartMoving(){this.drag&&(this.element.style.cursor="grabbing");}onEndMoving(){this.drag&&(this.element.style.cursor="grab",this.emit("update-end"));}_onUpdate(t,e){if(!this.element.parentElement)return;const n=t/this.element.parentElement.clientWidth*this.totalDuration,i=e&&e!=="start"?this.start:this.start+n,r=e&&e!=="end"?this.end:this.end+n,o=r-i;i>=0&&r<=this.totalDuration&&i<=r&&o>=this.minLength&&o<=this.maxLength&&(this.start=i,this.end=r,this.renderPosition(),this.emit("update"));}onMove(t){this.drag&&this._onUpdate(t);}onResize(t,e){this.resize&&this._onUpdate(t,e);}onEndResizing(){this.resize&&this.emit("update-end");}_setTotalDuration(t){this.totalDuration=t,this.renderPosition();}play(){this.emit("play");}setContent(t){var e;if((e=this.content)===null||e===void 0||e.remove(),t){if(typeof t=="string"){this.content=document.createElement("div");const n=this.start===this.end;this.content.style.padding=`0.2em ${n?.2:.4}em`,this.content.textContent=t;}else this.content=t;this.content.setAttribute("part","region-content"),this.element.appendChild(this.content);}else this.content=void 0;}setOptions(t){var e,n;if(t.color&&(this.color=t.color,this.element.style.backgroundColor=this.color),t.drag!==void 0&&(this.drag=t.drag,this.element.style.cursor=this.drag?"grab":"default"),t.start!==void 0||t.end!==void 0){const i=this.start===this.end;this.start=this.clampPosition((e=t.start)!==null&&e!==void 0?e:this.start),this.end=this.clampPosition((n=t.end)!==null&&n!==void 0?n:i?this.start:this.end),this.renderPosition(),this.setPart();}if(t.content&&this.setContent(t.content),t.id&&(this.id=t.id,this.setPart()),t.resize!==void 0&&t.resize!==this.resize){const i=this.start===this.end;this.resize=t.resize,this.resize&&!i?this.addResizeHandles(this.element):this.removeResizeHandles(this.element);}}remove(){this.emit("remove"),this.element.remove(),this.element=null;}}class $ extends Pt{constructor(t){super(t),this.regions=[],this.regionsContainer=this.initRegionsContainer();}static create(t){return new $(t)}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");this.wavesurfer.getWrapper().appendChild(this.regionsContainer);let t=[];this.subscriptions.push(this.wavesurfer.on("timeupdate",e=>{const n=this.regions.filter(i=>i.start<=e&&i.end>=e);n.forEach(i=>{t.includes(i)||this.emit("region-in",i);}),t.forEach(i=>{n.includes(i)||this.emit("region-out",i);}),t=n;}));}initRegionsContainer(){const t=document.createElement("div");return t.setAttribute("style",`
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 3;
      pointer-events: none;
    `),t}getRegions(){return this.regions}avoidOverlapping(t){if(!t.content)return;const e=t.content,n=e.getBoundingClientRect().left,i=t.element.scrollWidth,r=this.regions.filter(o=>{if(o===t||!o.content)return !1;const a=o.content.getBoundingClientRect().left,c=o.element.scrollWidth;return n<a+c&&a<n+i}).map(o=>{var a;return ((a=o.content)===null||a===void 0?void 0:a.getBoundingClientRect().height)||0}).reduce((o,a)=>o+a,0);e.style.marginTop=`${r}px`;}saveRegion(t){this.regionsContainer.appendChild(t.element),this.avoidOverlapping(t),this.regions.push(t);const e=[t.on("update-end",()=>{this.avoidOverlapping(t),this.emit("region-updated",t);}),t.on("play",()=>{var n,i;(n=this.wavesurfer)===null||n===void 0||n.play(),(i=this.wavesurfer)===null||i===void 0||i.setTime(t.start);}),t.on("click",n=>{this.emit("region-clicked",t,n);}),t.on("dblclick",n=>{this.emit("region-double-clicked",t,n);}),t.once("remove",()=>{e.forEach(n=>n()),this.regions=this.regions.filter(n=>n!==t);})];this.subscriptions.push(...e),this.emit("region-created",t);}addRegion(t){var e,n;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const i=this.wavesurfer.getDuration(),r=(n=(e=this.wavesurfer)===null||e===void 0?void 0:e.getDecodedData())===null||n===void 0?void 0:n.numberOfChannels,o=new rt(t,i,r);return i?this.saveRegion(o):this.subscriptions.push(this.wavesurfer.once("ready",a=>{o._setTotalDuration(a),this.saveRegion(o);})),o}enableDragSelection(t){var e,n;const i=(n=(e=this.wavesurfer)===null||e===void 0?void 0:e.getWrapper())===null||n===void 0?void 0:n.querySelector("div");if(!i)return ()=>{};let r=null,o=0;return V(i,(a,c,d)=>{r&&r._onUpdate(a,d>o?"end":"start");},a=>{var c,d;if(o=a,!this.wavesurfer)return;const s=this.wavesurfer.getDuration(),u=(d=(c=this.wavesurfer)===null||c===void 0?void 0:c.getDecodedData())===null||d===void 0?void 0:d.numberOfChannels,v=this.wavesurfer.getWrapper().clientWidth,h=a/v*s,A=(a+5)/v*s;r=new rt(Object.assign(Object.assign({},t),{start:h,end:A}),s,u),this.regionsContainer.appendChild(r.element);},()=>{r&&(this.saveRegion(r),r=null);})}clearRegions(){this.regions.forEach(t=>t.remove());}destroy(){this.clearRegions(),super.destroy();}}const Tt=create_ssr_component((l,t,e,n)=>{let{currentVolume:i}=t;return t.currentVolume===void 0&&e.currentVolume&&i!==void 0&&e.currentVolume(i),`${i==0?`${validate_component(Ee,"VolumeMuted").$$render(l,{},{},{})}`:`${i<.5?`${validate_component(Ie,"VolumeLow").$$render(l,{},{},{})}`:`${i>=.5?`${validate_component(ye,"VolumeHigh").$$render(l,{},{},{})}`:""}`}`}`}),Ht={code:'.volume-slider.svelte-wuo8j5{-webkit-appearance:none;appearance:none;width:var(--size-20);accent-color:var(--color-accent);height:4px;cursor:pointer;outline:none;border-radius:15px;background-color:var(--neutral-400)}input[type="range"].svelte-wuo8j5::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;height:15px;width:15px;background-color:var(--color-accent);border-radius:50%;border:none;transition:0.2s ease-in-out}input[type="range"].svelte-wuo8j5::-moz-range-thumb{height:15px;width:15px;background-color:var(--color-accent);border-radius:50%;border:none;transition:0.2s ease-in-out}',map:'{"version":3,"file":"VolumeControl.svelte","sources":["VolumeControl.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { onMount } from \\"svelte\\";\\nimport WaveSurfer from \\"wavesurfer.js\\";\\nexport let currentVolume = 1;\\nexport let show_volume_slider = false;\\nexport let waveform;\\nlet volumeElement;\\nonMount(() => {\\n    adjustSlider();\\n});\\nconst adjustSlider = () => {\\n    let slider = volumeElement;\\n    if (!slider)\\n        return;\\n    slider.style.background = `linear-gradient(to right, var(--color-accent) ${currentVolume * 100}%, var(--neutral-400) ${currentVolume * 100}%)`;\\n};\\n$: currentVolume, adjustSlider();\\n<\/script>\\n\\n<input\\n\\tbind:this={volumeElement}\\n\\tid=\\"volume\\"\\n\\tclass=\\"volume-slider\\"\\n\\ttype=\\"range\\"\\n\\tmin=\\"0\\"\\n\\tmax=\\"1\\"\\n\\tstep=\\"0.01\\"\\n\\tvalue={currentVolume}\\n\\ton:focusout={() => (show_volume_slider = false)}\\n\\ton:input={(e) => {\\n\\t\\tif (e.target instanceof HTMLInputElement) {\\n\\t\\t\\tcurrentVolume = parseFloat(e.target.value);\\n\\t\\t\\twaveform?.setVolume(currentVolume);\\n\\t\\t}\\n\\t}}\\n/>\\n\\n<style>\\n\\t.volume-slider {\\n\\t\\t-webkit-appearance: none;\\n\\t\\tappearance: none;\\n\\t\\twidth: var(--size-20);\\n\\t\\taccent-color: var(--color-accent);\\n\\t\\theight: 4px;\\n\\t\\tcursor: pointer;\\n\\t\\toutline: none;\\n\\t\\tborder-radius: 15px;\\n\\t\\tbackground-color: var(--neutral-400);\\n\\t}\\n\\n\\tinput[type=\\"range\\"]::-webkit-slider-thumb {\\n\\t\\t-webkit-appearance: none;\\n\\t\\tappearance: none;\\n\\t\\theight: 15px;\\n\\t\\twidth: 15px;\\n\\t\\tbackground-color: var(--color-accent);\\n\\t\\tborder-radius: 50%;\\n\\t\\tborder: none;\\n\\t\\ttransition: 0.2s ease-in-out;\\n\\t}\\n\\n\\tinput[type=\\"range\\"]::-moz-range-thumb {\\n\\t\\theight: 15px;\\n\\t\\twidth: 15px;\\n\\t\\tbackground-color: var(--color-accent);\\n\\t\\tborder-radius: 50%;\\n\\t\\tborder: none;\\n\\t\\ttransition: 0.2s ease-in-out;\\n\\t}</style>\\n"],"names":[],"mappings":"AAqCC,4BAAe,CACd,kBAAkB,CAAE,IAAI,CACxB,UAAU,CAAE,IAAI,CAChB,KAAK,CAAE,IAAI,SAAS,CAAC,CACrB,YAAY,CAAE,IAAI,cAAc,CAAC,CACjC,MAAM,CAAE,GAAG,CACX,MAAM,CAAE,OAAO,CACf,OAAO,CAAE,IAAI,CACb,aAAa,CAAE,IAAI,CACnB,gBAAgB,CAAE,IAAI,aAAa,CACpC,CAEA,KAAK,CAAC,IAAI,CAAC,OAAO,eAAC,sBAAuB,CACzC,kBAAkB,CAAE,IAAI,CACxB,UAAU,CAAE,IAAI,CAChB,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,IAAI,CACX,gBAAgB,CAAE,IAAI,cAAc,CAAC,CACrC,aAAa,CAAE,GAAG,CAClB,MAAM,CAAE,IAAI,CACZ,UAAU,CAAE,IAAI,CAAC,WAClB,CAEA,KAAK,CAAC,IAAI,CAAC,OAAO,eAAC,kBAAmB,CACrC,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,IAAI,CACX,gBAAgB,CAAE,IAAI,cAAc,CAAC,CACrC,aAAa,CAAE,GAAG,CAClB,MAAM,CAAE,IAAI,CACZ,UAAU,CAAE,IAAI,CAAC,WAClB"}'},Kt=create_ssr_component((l,t,e,n)=>{let{currentVolume:i=1}=t,{show_volume_slider:r=!1}=t,{waveform:o}=t,a;return t.currentVolume===void 0&&e.currentVolume&&i!==void 0&&e.currentVolume(i),t.show_volume_slider===void 0&&e.show_volume_slider&&r!==void 0&&e.show_volume_slider(r),t.waveform===void 0&&e.waveform&&o!==void 0&&e.waveform(o),l.css.add(Ht),`<input id="volume" class="volume-slider svelte-wuo8j5" type="range" min="0" max="1" step="0.01"${add_attribute("value",i,0)}${add_attribute("this",a,0)}>`}),Qt={code:`.settings-wrapper.svelte-1joklbr.svelte-1joklbr{display:flex;justify-self:self-end;align-items:center;grid-area:editing}.text-button.svelte-1joklbr.svelte-1joklbr{border:1px solid var(--neutral-400);border-radius:var(--radius-sm);font-weight:300;font-size:var(--size-3);text-align:center;color:var(--neutral-400);height:var(--size-5);font-weight:bold;padding:0 5px;margin-left:5px}.text-button.svelte-1joklbr.svelte-1joklbr:hover,.text-button.svelte-1joklbr.svelte-1joklbr:focus{color:var(--color-accent);border-color:var(--color-accent)}.controls.svelte-1joklbr.svelte-1joklbr{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-areas:"controls playback editing";margin-top:5px;align-items:center;position:relative;flex-wrap:wrap;justify-content:space-between}.controls.svelte-1joklbr div.svelte-1joklbr{margin:var(--size-1) 0}@media(max-width: 600px){.controls.svelte-1joklbr.svelte-1joklbr{grid-template-columns:1fr 1fr;grid-template-rows:auto auto;grid-template-areas:"playback playback"
				"controls editing"}}@media(max-width: 319px){.controls.svelte-1joklbr.svelte-1joklbr{overflow-x:scroll}}.hidden.svelte-1joklbr.svelte-1joklbr{display:none}.control-wrapper.svelte-1joklbr.svelte-1joklbr{display:flex;justify-self:self-start;align-items:center;justify-content:space-between;grid-area:controls}.action.svelte-1joklbr.svelte-1joklbr{width:var(--size-5);color:var(--neutral-400);margin-left:var(--spacing-md)}.icon.svelte-1joklbr.svelte-1joklbr:hover,.icon.svelte-1joklbr.svelte-1joklbr:focus{color:var(--color-accent)}.play-pause-wrapper.svelte-1joklbr.svelte-1joklbr{display:flex;justify-self:center;grid-area:playback}.cc-button.svelte-1joklbr.svelte-1joklbr{width:var(--size-8)}@media(max-width: 600px){.play-pause-wrapper.svelte-1joklbr.svelte-1joklbr{margin:var(--spacing-md)}}.playback.svelte-1joklbr.svelte-1joklbr{border:1px solid var(--neutral-400);border-radius:var(--radius-sm);width:5.5ch;font-weight:300;font-size:var(--size-3);text-align:center;color:var(--neutral-400);height:var(--size-5);font-weight:bold}.playback.svelte-1joklbr.svelte-1joklbr:hover,.playback.svelte-1joklbr.svelte-1joklbr:focus{color:var(--color-accent);border-color:var(--color-accent)}.rewind.svelte-1joklbr.svelte-1joklbr,.skip.svelte-1joklbr.svelte-1joklbr{margin:0 10px;color:var(--neutral-400)}.play-pause-button.svelte-1joklbr.svelte-1joklbr{width:var(--size-8);display:flex;align-items:center;justify-content:center;color:var(--neutral-400);fill:var(--neutral-400)}.volume.svelte-1joklbr.svelte-1joklbr{position:relative;display:flex;justify-content:center;margin-right:var(--spacing-xl);width:var(--size-5)}`,map:`{"version":3,"file":"WaveformControls.svelte","sources":["WaveformControls.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { Play, Pause, Forward, Backward, ClosedCaption, Undo, Trim } from \\"@gradio/icons\\";\\nimport { get_skip_rewind_amount } from \\"../shared/utils\\";\\nimport WaveSurfer from \\"wavesurfer.js\\";\\nimport RegionsPlugin, {} from \\"wavesurfer.js/dist/plugins/regions.js\\";\\nimport VolumeLevels from \\"./VolumeLevels.svelte\\";\\nimport VolumeControl from \\"./VolumeControl.svelte\\";\\nexport let waveform;\\nexport let audio_duration;\\nexport let i18n;\\nexport let playing;\\nexport let show_redo = false;\\nexport let interactive = false;\\nexport let handle_trim_audio;\\nexport let mode = \\"\\";\\nexport let container;\\nexport let handle_reset_value;\\nexport let waveform_options = {};\\nexport let trim_region_settings = {};\\nexport let show_volume_slider = false;\\nexport let editable = true;\\nexport let subtitles_toggle = true;\\nexport let show_subtitles = false;\\nexport let trimDuration = 0;\\nlet playbackSpeeds = [0.5, 1, 1.5, 2];\\nlet playbackSpeed = playbackSpeeds[1];\\nlet trimRegion = null;\\nlet activeRegion = null;\\nlet leftRegionHandle;\\nlet rightRegionHandle;\\nlet activeHandle = \\"\\";\\nlet currentVolume = 1;\\n$: trimRegion = container && waveform ? waveform.registerPlugin(RegionsPlugin.create()) : null;\\n$: trimRegion?.on(\\"region-out\\", (region) => {\\n    region.play();\\n});\\n$: trimRegion?.on(\\"region-updated\\", (region) => {\\n    trimDuration = region.end - region.start;\\n});\\n$: trimRegion?.on(\\"region-clicked\\", (region, e) => {\\n    e.stopPropagation();\\n    activeRegion = region;\\n    region.play();\\n});\\nconst addTrimRegion = () => {\\n    if (!trimRegion)\\n        return;\\n    activeRegion = trimRegion?.addRegion({\\n        start: audio_duration / 4,\\n        end: audio_duration / 2,\\n        ...trim_region_settings\\n    });\\n    trimDuration = activeRegion.end - activeRegion.start;\\n};\\n$: if (activeRegion) {\\n    const shadowRoot = container.children[0].shadowRoot;\\n    rightRegionHandle = shadowRoot.querySelector('[data-resize=\\"right\\"]');\\n    leftRegionHandle = shadowRoot.querySelector('[data-resize=\\"left\\"]');\\n    if (leftRegionHandle && rightRegionHandle) {\\n        leftRegionHandle.setAttribute(\\"role\\", \\"button\\");\\n        rightRegionHandle.setAttribute(\\"role\\", \\"button\\");\\n        leftRegionHandle?.setAttribute(\\"aria-label\\", \\"Drag to adjust start time\\");\\n        rightRegionHandle?.setAttribute(\\"aria-label\\", \\"Drag to adjust end time\\");\\n        leftRegionHandle?.setAttribute(\\"tabindex\\", \\"0\\");\\n        rightRegionHandle?.setAttribute(\\"tabindex\\", \\"0\\");\\n        leftRegionHandle.addEventListener(\\"focus\\", () => {\\n            if (trimRegion)\\n                activeHandle = \\"left\\";\\n        });\\n        rightRegionHandle.addEventListener(\\"focus\\", () => {\\n            if (trimRegion)\\n                activeHandle = \\"right\\";\\n        });\\n    }\\n}\\nconst trimAudio = () => {\\n    if (waveform && trimRegion) {\\n        if (activeRegion) {\\n            const start = activeRegion.start;\\n            const end = activeRegion.end;\\n            handle_trim_audio(start, end);\\n            mode = \\"\\";\\n            activeRegion = null;\\n        }\\n    }\\n};\\nconst clearRegions = () => {\\n    trimRegion?.getRegions().forEach((region) => {\\n        region.remove();\\n    });\\n    trimRegion?.clearRegions();\\n};\\nconst toggleTrimmingMode = () => {\\n    clearRegions();\\n    if (mode === \\"edit\\") {\\n        mode = \\"\\";\\n    }\\n    else {\\n        mode = \\"edit\\";\\n        addTrimRegion();\\n    }\\n};\\nconst toggleSubtitles = () => {\\n    subtitles_toggle = !subtitles_toggle;\\n};\\nconst adjustRegionHandles = (handle, key) => {\\n    let newStart;\\n    let newEnd;\\n    if (!activeRegion)\\n        return;\\n    if (handle === \\"left\\") {\\n        if (key === \\"ArrowLeft\\") {\\n            newStart = activeRegion.start - 0.05;\\n            newEnd = activeRegion.end;\\n        }\\n        else {\\n            newStart = activeRegion.start + 0.05;\\n            newEnd = activeRegion.end;\\n        }\\n    }\\n    else {\\n        if (key === \\"ArrowLeft\\") {\\n            newStart = activeRegion.start;\\n            newEnd = activeRegion.end - 0.05;\\n        }\\n        else {\\n            newStart = activeRegion.start;\\n            newEnd = activeRegion.end + 0.05;\\n        }\\n    }\\n    activeRegion.setOptions({\\n        start: newStart,\\n        end: newEnd\\n    });\\n    trimDuration = activeRegion.end - activeRegion.start;\\n};\\n$: trimRegion && window.addEventListener(\\"keydown\\", (e) => {\\n    if (e.key === \\"ArrowLeft\\") {\\n        adjustRegionHandles(activeHandle, \\"ArrowLeft\\");\\n    }\\n    else if (e.key === \\"ArrowRight\\") {\\n        adjustRegionHandles(activeHandle, \\"ArrowRight\\");\\n    }\\n});\\n<\/script>\\n\\n<div class=\\"controls\\" data-testid=\\"waveform-controls\\">\\n\\t<div class=\\"control-wrapper\\">\\n\\t\\t<button\\n\\t\\t\\tclass=\\"action icon volume\\"\\n\\t\\t\\tstyle:color={show_volume_slider\\n\\t\\t\\t\\t? \\"var(--color-accent)\\"\\n\\t\\t\\t\\t: \\"var(--neutral-400)\\"}\\n\\t\\t\\taria-label=\\"Adjust volume\\"\\n\\t\\t\\ton:click={() => (show_volume_slider = !show_volume_slider)}\\n\\t\\t>\\n\\t\\t\\t<VolumeLevels {currentVolume} />\\n\\t\\t</button>\\n\\n\\t\\t{#if show_volume_slider}\\n\\t\\t\\t<VolumeControl bind:currentVolume bind:show_volume_slider {waveform} />\\n\\t\\t{/if}\\n\\n\\t\\t<button\\n\\t\\t\\tclass:hidden={show_volume_slider}\\n\\t\\t\\tclass=\\"playback icon\\"\\n\\t\\t\\taria-label={\`Adjust playback speed to \${\\n\\t\\t\\t\\tplaybackSpeeds[\\n\\t\\t\\t\\t\\t(playbackSpeeds.indexOf(playbackSpeed) + 1) % playbackSpeeds.length\\n\\t\\t\\t\\t]\\n\\t\\t\\t}x\`}\\n\\t\\t\\ton:click={() => {\\n\\t\\t\\t\\tplaybackSpeed =\\n\\t\\t\\t\\t\\tplaybackSpeeds[\\n\\t\\t\\t\\t\\t\\t(playbackSpeeds.indexOf(playbackSpeed) + 1) % playbackSpeeds.length\\n\\t\\t\\t\\t\\t];\\n\\n\\t\\t\\t\\twaveform?.setPlaybackRate(playbackSpeed);\\n\\t\\t\\t}}\\n\\t\\t>\\n\\t\\t\\t<span>{playbackSpeed}x</span>\\n\\t\\t</button>\\n\\t</div>\\n\\n\\t<div class=\\"play-pause-wrapper\\">\\n\\t\\t<button\\n\\t\\t\\tclass=\\"rewind icon\\"\\n\\t\\t\\taria-label={\`Skip backwards by \${get_skip_rewind_amount(\\n\\t\\t\\t\\taudio_duration,\\n\\t\\t\\t\\twaveform_options.skip_length\\n\\t\\t\\t)} seconds\`}\\n\\t\\t\\ton:click={() =>\\n\\t\\t\\t\\twaveform?.skip(\\n\\t\\t\\t\\t\\tget_skip_rewind_amount(audio_duration, waveform_options.skip_length) *\\n\\t\\t\\t\\t\\t\\t-1\\n\\t\\t\\t\\t)}\\n\\t\\t>\\n\\t\\t\\t<Backward />\\n\\t\\t</button>\\n\\t\\t<button\\n\\t\\t\\tclass=\\"play-pause-button icon\\"\\n\\t\\t\\ton:click={() => waveform?.playPause()}\\n\\t\\t\\taria-label={playing ? i18n(\\"audio.pause\\") : i18n(\\"audio.play\\")}\\n\\t\\t>\\n\\t\\t\\t{#if playing}\\n\\t\\t\\t\\t<Pause />\\n\\t\\t\\t{:else}\\n\\t\\t\\t\\t<Play />\\n\\t\\t\\t{/if}\\n\\t\\t</button>\\n\\t\\t<button\\n\\t\\t\\tclass=\\"skip icon\\"\\n\\t\\t\\taria-label=\\"Skip forward by {get_skip_rewind_amount(\\n\\t\\t\\t\\taudio_duration,\\n\\t\\t\\t\\twaveform_options.skip_length\\n\\t\\t\\t)} seconds\\"\\n\\t\\t\\ton:click={() =>\\n\\t\\t\\t\\twaveform?.skip(\\n\\t\\t\\t\\t\\tget_skip_rewind_amount(audio_duration, waveform_options.skip_length)\\n\\t\\t\\t\\t)}\\n\\t\\t>\\n\\t\\t\\t<Forward />\\n\\t\\t</button>\\n\\t</div>\\n\\n\\t<div class=\\"settings-wrapper\\">\\n\\t\\t{#if show_subtitles}\\n\\t\\t\\t<button\\n\\t\\t\\t\\tclass=\\"action icon cc-button\\"\\n\\t\\t\\t\\tdata-testid=\\"subtitles-toggle\\"\\n\\t\\t\\t\\tstyle=\\"color: {subtitles_toggle\\n\\t\\t\\t\\t\\t? 'var(--color-accent)'\\n\\t\\t\\t\\t\\t: 'var(--neutral-400)'}\\"\\n\\t\\t\\t\\ton:click={toggleSubtitles}\\n\\t\\t\\t>\\n\\t\\t\\t\\t<ClosedCaption /></button\\n\\t\\t\\t>\\n\\t\\t{/if}\\n\\t\\t{#if editable && interactive}\\n\\t\\t\\t{#if show_redo && mode === \\"\\"}\\n\\t\\t\\t\\t<button\\n\\t\\t\\t\\t\\tclass=\\"action icon\\"\\n\\t\\t\\t\\t\\taria-label=\\"Reset audio\\"\\n\\t\\t\\t\\t\\ton:click={() => {\\n\\t\\t\\t\\t\\t\\thandle_reset_value();\\n\\t\\t\\t\\t\\t\\tclearRegions();\\n\\t\\t\\t\\t\\t\\tmode = \\"\\";\\n\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<Undo />\\n\\t\\t\\t\\t</button>\\n\\t\\t\\t{/if}\\n\\n\\t\\t\\t{#if mode === \\"\\"}\\n\\t\\t\\t\\t<button\\n\\t\\t\\t\\t\\tclass=\\"action icon\\"\\n\\t\\t\\t\\t\\taria-label=\\"Trim audio to selection\\"\\n\\t\\t\\t\\t\\ton:click={toggleTrimmingMode}\\n\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t<Trim />\\n\\t\\t\\t\\t</button>\\n\\t\\t\\t{:else}\\n\\t\\t\\t\\t<button class=\\"text-button\\" on:click={trimAudio}>Trim</button>\\n\\t\\t\\t\\t<button class=\\"text-button\\" on:click={toggleTrimmingMode}>Cancel</button\\n\\t\\t\\t\\t>\\n\\t\\t\\t{/if}\\n\\t\\t{/if}\\n\\t</div>\\n</div>\\n\\n<style>\\n\\t.settings-wrapper {\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-self: self-end;\\n\\t\\talign-items: center;\\n\\t\\tgrid-area: editing;\\n\\t}\\n\\t.text-button {\\n\\t\\tborder: 1px solid var(--neutral-400);\\n\\t\\tborder-radius: var(--radius-sm);\\n\\t\\tfont-weight: 300;\\n\\t\\tfont-size: var(--size-3);\\n\\t\\ttext-align: center;\\n\\t\\tcolor: var(--neutral-400);\\n\\t\\theight: var(--size-5);\\n\\t\\tfont-weight: bold;\\n\\t\\tpadding: 0 5px;\\n\\t\\tmargin-left: 5px;\\n\\t}\\n\\n\\t.text-button:hover,\\n\\t.text-button:focus {\\n\\t\\tcolor: var(--color-accent);\\n\\t\\tborder-color: var(--color-accent);\\n\\t}\\n\\n\\t.controls {\\n\\t\\tdisplay: grid;\\n\\t\\tgrid-template-columns: 1fr 1fr 1fr;\\n\\t\\tgrid-template-areas: \\"controls playback editing\\";\\n\\t\\tmargin-top: 5px;\\n\\t\\talign-items: center;\\n\\t\\tposition: relative;\\n\\t\\tflex-wrap: wrap;\\n\\t\\tjustify-content: space-between;\\n\\t}\\n\\t.controls div {\\n\\t\\tmargin: var(--size-1) 0;\\n\\t}\\n\\n\\t@media (max-width: 600px) {\\n\\t\\t.controls {\\n\\t\\t\\tgrid-template-columns: 1fr 1fr;\\n\\t\\t\\tgrid-template-rows: auto auto;\\n\\t\\t\\tgrid-template-areas:\\n\\t\\t\\t\\t\\"playback playback\\"\\n\\t\\t\\t\\t\\"controls editing\\";\\n\\t\\t}\\n\\t}\\n\\n\\t@media (max-width: 319px) {\\n\\t\\t.controls {\\n\\t\\t\\toverflow-x: scroll;\\n\\t\\t}\\n\\t}\\n\\n\\t.hidden {\\n\\t\\tdisplay: none;\\n\\t}\\n\\n\\t.control-wrapper {\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-self: self-start;\\n\\t\\talign-items: center;\\n\\t\\tjustify-content: space-between;\\n\\t\\tgrid-area: controls;\\n\\t}\\n\\n\\t.action {\\n\\t\\twidth: var(--size-5);\\n\\t\\tcolor: var(--neutral-400);\\n\\t\\tmargin-left: var(--spacing-md);\\n\\t}\\n\\t.icon:hover,\\n\\t.icon:focus {\\n\\t\\tcolor: var(--color-accent);\\n\\t}\\n\\t.play-pause-wrapper {\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-self: center;\\n\\t\\tgrid-area: playback;\\n\\t}\\n\\t.cc-button {\\n\\t\\twidth: var(--size-8);\\n\\t}\\n\\n\\t@media (max-width: 600px) {\\n\\t\\t.play-pause-wrapper {\\n\\t\\t\\tmargin: var(--spacing-md);\\n\\t\\t}\\n\\t}\\n\\t.playback {\\n\\t\\tborder: 1px solid var(--neutral-400);\\n\\t\\tborder-radius: var(--radius-sm);\\n\\t\\twidth: 5.5ch;\\n\\t\\tfont-weight: 300;\\n\\t\\tfont-size: var(--size-3);\\n\\t\\ttext-align: center;\\n\\t\\tcolor: var(--neutral-400);\\n\\t\\theight: var(--size-5);\\n\\t\\tfont-weight: bold;\\n\\t}\\n\\n\\t.playback:hover,\\n\\t.playback:focus {\\n\\t\\tcolor: var(--color-accent);\\n\\t\\tborder-color: var(--color-accent);\\n\\t}\\n\\n\\t.rewind,\\n\\t.skip {\\n\\t\\tmargin: 0 10px;\\n\\t\\tcolor: var(--neutral-400);\\n\\t}\\n\\n\\t.play-pause-button {\\n\\t\\twidth: var(--size-8);\\n\\t\\tdisplay: flex;\\n\\t\\talign-items: center;\\n\\t\\tjustify-content: center;\\n\\t\\tcolor: var(--neutral-400);\\n\\t\\tfill: var(--neutral-400);\\n\\t}\\n\\n\\t.volume {\\n\\t\\tposition: relative;\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-content: center;\\n\\t\\tmargin-right: var(--spacing-xl);\\n\\t\\twidth: var(--size-5);\\n\\t}</style>\\n"],"names":[],"mappings":"AA8QC,+CAAkB,CACjB,OAAO,CAAE,IAAI,CACb,YAAY,CAAE,QAAQ,CACtB,WAAW,CAAE,MAAM,CACnB,SAAS,CAAE,OACZ,CACA,0CAAa,CACZ,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,aAAa,CAAC,CACpC,aAAa,CAAE,IAAI,WAAW,CAAC,CAC/B,WAAW,CAAE,GAAG,CAChB,SAAS,CAAE,IAAI,QAAQ,CAAC,CACxB,UAAU,CAAE,MAAM,CAClB,KAAK,CAAE,IAAI,aAAa,CAAC,CACzB,MAAM,CAAE,IAAI,QAAQ,CAAC,CACrB,WAAW,CAAE,IAAI,CACjB,OAAO,CAAE,CAAC,CAAC,GAAG,CACd,WAAW,CAAE,GACd,CAEA,0CAAY,MAAM,CAClB,0CAAY,MAAO,CAClB,KAAK,CAAE,IAAI,cAAc,CAAC,CAC1B,YAAY,CAAE,IAAI,cAAc,CACjC,CAEA,uCAAU,CACT,OAAO,CAAE,IAAI,CACb,qBAAqB,CAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAClC,mBAAmB,CAAE,2BAA2B,CAChD,UAAU,CAAE,GAAG,CACf,WAAW,CAAE,MAAM,CACnB,QAAQ,CAAE,QAAQ,CAClB,SAAS,CAAE,IAAI,CACf,eAAe,CAAE,aAClB,CACA,wBAAS,CAAC,kBAAI,CACb,MAAM,CAAE,IAAI,QAAQ,CAAC,CAAC,CACvB,CAEA,MAAO,YAAY,KAAK,CAAE,CACzB,uCAAU,CACT,qBAAqB,CAAE,GAAG,CAAC,GAAG,CAC9B,kBAAkB,CAAE,IAAI,CAAC,IAAI,CAC7B,mBAAmB,CAClB;AACJ,IAAI,kBACF,CACD,CAEA,MAAO,YAAY,KAAK,CAAE,CACzB,uCAAU,CACT,UAAU,CAAE,MACb,CACD,CAEA,qCAAQ,CACP,OAAO,CAAE,IACV,CAEA,8CAAiB,CAChB,OAAO,CAAE,IAAI,CACb,YAAY,CAAE,UAAU,CACxB,WAAW,CAAE,MAAM,CACnB,eAAe,CAAE,aAAa,CAC9B,SAAS,CAAE,QACZ,CAEA,qCAAQ,CACP,KAAK,CAAE,IAAI,QAAQ,CAAC,CACpB,KAAK,CAAE,IAAI,aAAa,CAAC,CACzB,WAAW,CAAE,IAAI,YAAY,CAC9B,CACA,mCAAK,MAAM,CACX,mCAAK,MAAO,CACX,KAAK,CAAE,IAAI,cAAc,CAC1B,CACA,iDAAoB,CACnB,OAAO,CAAE,IAAI,CACb,YAAY,CAAE,MAAM,CACpB,SAAS,CAAE,QACZ,CACA,wCAAW,CACV,KAAK,CAAE,IAAI,QAAQ,CACpB,CAEA,MAAO,YAAY,KAAK,CAAE,CACzB,iDAAoB,CACnB,MAAM,CAAE,IAAI,YAAY,CACzB,CACD,CACA,uCAAU,CACT,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,aAAa,CAAC,CACpC,aAAa,CAAE,IAAI,WAAW,CAAC,CAC/B,KAAK,CAAE,KAAK,CACZ,WAAW,CAAE,GAAG,CAChB,SAAS,CAAE,IAAI,QAAQ,CAAC,CACxB,UAAU,CAAE,MAAM,CAClB,KAAK,CAAE,IAAI,aAAa,CAAC,CACzB,MAAM,CAAE,IAAI,QAAQ,CAAC,CACrB,WAAW,CAAE,IACd,CAEA,uCAAS,MAAM,CACf,uCAAS,MAAO,CACf,KAAK,CAAE,IAAI,cAAc,CAAC,CAC1B,YAAY,CAAE,IAAI,cAAc,CACjC,CAEA,qCAAO,CACP,mCAAM,CACL,MAAM,CAAE,CAAC,CAAC,IAAI,CACd,KAAK,CAAE,IAAI,aAAa,CACzB,CAEA,gDAAmB,CAClB,KAAK,CAAE,IAAI,QAAQ,CAAC,CACpB,OAAO,CAAE,IAAI,CACb,WAAW,CAAE,MAAM,CACnB,eAAe,CAAE,MAAM,CACvB,KAAK,CAAE,IAAI,aAAa,CAAC,CACzB,IAAI,CAAE,IAAI,aAAa,CACxB,CAEA,qCAAQ,CACP,QAAQ,CAAE,QAAQ,CAClB,OAAO,CAAE,IAAI,CACb,eAAe,CAAE,MAAM,CACvB,YAAY,CAAE,IAAI,YAAY,CAAC,CAC/B,KAAK,CAAE,IAAI,QAAQ,CACpB"}`},Ut=create_ssr_component((l,t,e,n)=>{let{waveform:i}=t,{audio_duration:r}=t,{i18n:o}=t,{playing:a}=t,{show_redo:c=!1}=t,{interactive:d=!1}=t,{handle_trim_audio:s}=t,{mode:u=""}=t,{container:v}=t,{handle_reset_value:h}=t,{waveform_options:A={}}=t,{trim_region_settings:f={}}=t,{show_volume_slider:p=!1}=t,{editable:b=!0}=t,{subtitles_toggle:g=!0}=t,{show_subtitles:_=!1}=t,{trimDuration:m=0}=t,C=[.5,1,1.5,2],E=C[1],x=null,k=null,B,R,M="",K=1;const W=(w,P)=>{let L,D;k&&(w==="left"?P==="ArrowLeft"?(L=k.start-.05,D=k.end):(L=k.start+.05,D=k.end):P==="ArrowLeft"?(L=k.start,D=k.end-.05):(L=k.start,D=k.end+.05),k.setOptions({start:L,end:D}),m=k.end-k.start);};t.waveform===void 0&&e.waveform&&i!==void 0&&e.waveform(i),t.audio_duration===void 0&&e.audio_duration&&r!==void 0&&e.audio_duration(r),t.i18n===void 0&&e.i18n&&o!==void 0&&e.i18n(o),t.playing===void 0&&e.playing&&a!==void 0&&e.playing(a),t.show_redo===void 0&&e.show_redo&&c!==void 0&&e.show_redo(c),t.interactive===void 0&&e.interactive&&d!==void 0&&e.interactive(d),t.handle_trim_audio===void 0&&e.handle_trim_audio&&s!==void 0&&e.handle_trim_audio(s),t.mode===void 0&&e.mode&&u!==void 0&&e.mode(u),t.container===void 0&&e.container&&v!==void 0&&e.container(v),t.handle_reset_value===void 0&&e.handle_reset_value&&h!==void 0&&e.handle_reset_value(h),t.waveform_options===void 0&&e.waveform_options&&A!==void 0&&e.waveform_options(A),t.trim_region_settings===void 0&&e.trim_region_settings&&f!==void 0&&e.trim_region_settings(f),t.show_volume_slider===void 0&&e.show_volume_slider&&p!==void 0&&e.show_volume_slider(p),t.editable===void 0&&e.editable&&b!==void 0&&e.editable(b),t.subtitles_toggle===void 0&&e.subtitles_toggle&&g!==void 0&&e.subtitles_toggle(g),t.show_subtitles===void 0&&e.show_subtitles&&_!==void 0&&e.show_subtitles(_),t.trimDuration===void 0&&e.trimDuration&&m!==void 0&&e.trimDuration(m),l.css.add(Qt);let z,j,F=l.head;do{if(z=!0,l.head=F,x=v&&i?i.registerPlugin($.create()):null,x?.on("region-out",w=>{w.play();}),x?.on("region-updated",w=>{m=w.end-w.start;}),x?.on("region-clicked",(w,P)=>{P.stopPropagation(),k=w,w.play();}),k){const w=v.children[0].shadowRoot;R=w.querySelector('[data-resize="right"]'),B=w.querySelector('[data-resize="left"]'),B&&R&&(B.setAttribute("role","button"),R.setAttribute("role","button"),B?.setAttribute("aria-label","Drag to adjust start time"),R?.setAttribute("aria-label","Drag to adjust end time"),B?.setAttribute("tabindex","0"),R?.setAttribute("tabindex","0"),B.addEventListener("focus",()=>{x&&(M="left");}),R.addEventListener("focus",()=>{x&&(M="right");}));}x&&window.addEventListener("keydown",w=>{w.key==="ArrowLeft"?W(M,"ArrowLeft"):w.key==="ArrowRight"&&W(M,"ArrowRight");}),j=`<div class="controls svelte-1joklbr" data-testid="waveform-controls"><div class="control-wrapper svelte-1joklbr"><button class="action icon volume svelte-1joklbr" aria-label="Adjust volume"${add_styles({color:p?"var(--color-accent)":"var(--neutral-400)"})}>${validate_component(Tt,"VolumeLevels").$$render(l,{currentVolume:K},{},{})}</button> ${p?`${validate_component(Kt,"VolumeControl").$$render(l,{waveform:i,currentVolume:K,show_volume_slider:p},{currentVolume:w=>{K=w,z=!1;},show_volume_slider:w=>{p=w,z=!1;}},{})}`:""} <button class="${["playback icon svelte-1joklbr",p?"hidden":""].join(" ").trim()}"${add_attribute("aria-label",`Adjust playback speed to ${C[(C.indexOf(E)+1)%C.length]}x`,0)}><span>${escape(E)}x</span></button></div> <div class="play-pause-wrapper svelte-1joklbr"><button class="rewind icon svelte-1joklbr"${add_attribute("aria-label",`Skip backwards by ${it(r,A.skip_length)} seconds`,0)}>${validate_component(Kt$1,"Backward").$$render(l,{},{},{})}</button> <button class="play-pause-button icon svelte-1joklbr"${add_attribute("aria-label",o(a?"audio.pause":"audio.play"),0)}>${a?`${validate_component(de,"Pause").$$render(l,{},{},{})}`:`${validate_component(ce,"Play").$$render(l,{},{},{})}`}</button> <button class="skip icon svelte-1joklbr" aria-label="${"Skip forward by "+escape(it(r,A.skip_length),!0)+" seconds"}">${validate_component(Jt,"Forward").$$render(l,{},{},{})}</button></div> <div class="settings-wrapper svelte-1joklbr">${_?`<button class="action icon cc-button svelte-1joklbr" data-testid="subtitles-toggle" style="${"color: "+escape(g?"var(--color-accent)":"var(--neutral-400)",!0)}">${validate_component(Tt$1,"ClosedCaption").$$render(l,{},{},{})}</button>`:""} ${b&&d?`${c&&u===""?`<button class="action icon svelte-1joklbr" aria-label="Reset audio">${validate_component(xe,"Undo").$$render(l,{},{},{})}</button>`:""} ${u===""?`<button class="action icon svelte-1joklbr" aria-label="Trim audio to selection">${validate_component(me,"Trim").$$render(l,{},{},{})}</button>`:'<button class="text-button svelte-1joklbr" data-svelte-h="svelte-1brf00d">Trim</button> <button class="text-button svelte-1joklbr" data-svelte-h="svelte-1r0ma01">Cancel</button>'}`:""}</div> </div>`;}while(!z);return j}),Vt={code:".component-wrapper.svelte-1vm10g7{padding:var(--size-3);width:100%}::part(wrapper){margin-bottom:var(--size-2)}.timestamps.svelte-1vm10g7{display:flex;justify-content:space-between;align-items:center;width:100%;padding:var(--size-1) 0}#time.svelte-1vm10g7{color:var(--neutral-400)}#duration.svelte-1vm10g7{color:var(--neutral-400)}#trim-duration.svelte-1vm10g7{color:var(--color-accent);margin-right:var(--spacing-sm)}.waveform-container.svelte-1vm10g7{display:flex;align-items:center;justify-content:center;width:var(--size-full)}#waveform.svelte-1vm10g7{width:100%;height:100%;position:relative}.standard-player.svelte-1vm10g7{width:100%;padding:var(--size-2)}.subtitle-display.svelte-1vm10g7{color:var(--text-secondary);font-size:var(--text-lg);text-align:center;max-width:600px;line-height:1.3;min-height:var(--size-4);font-family:var(--font-sans);font-weight:normal;margin:var(--size-2) auto;padding:var(--size-1) var(--size-2);border-radius:2px;transition:opacity 0.2s ease-in-out}.hidden.svelte-1vm10g7,.subtitle-display.svelte-1vm10g7:empty{display:none}",map:'{"version":3,"file":"AudioPlayer.svelte","sources":["AudioPlayer.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { onMount } from \\"svelte\\";\\nimport { Music } from \\"@gradio/icons\\";\\nimport { format_time } from \\"@gradio/utils\\";\\nimport WaveSurfer from \\"wavesurfer.js\\";\\nimport { skip_audio, process_audio } from \\"../shared/utils\\";\\nimport WaveformControls from \\"../shared/WaveformControls.svelte\\";\\nimport { Empty } from \\"@gradio/atoms\\";\\nimport { createEventDispatcher } from \\"svelte\\";\\nimport Hls from \\"hls.js\\";\\nexport let value = null;\\nexport let subtitles = null;\\n$: url = value?.url;\\nexport let label;\\nexport let i18n;\\nexport let dispatch_blob = () => Promise.resolve();\\nexport let interactive = false;\\nexport let editable = true;\\nexport let trim_region_settings = {};\\nexport let waveform_settings;\\nexport let waveform_options;\\nexport let mode = \\"\\";\\nexport let loop;\\nexport let handle_reset_value = () => {\\n};\\nlet container;\\nlet waveform;\\nlet playing = false;\\nlet subtitle_container;\\nlet timeRef;\\nlet durationRef;\\nlet audio_duration;\\nlet trimDuration = 0;\\nlet show_volume_slider = false;\\nlet audio_player;\\nlet stream_active = false;\\nlet subtitles_toggle = true;\\nlet subtitle_event_handlers = [];\\nconst dispatch = createEventDispatcher();\\n$: use_waveform = waveform_options.show_recording_waveform && !value?.is_stream;\\nconst create_waveform = () => {\\n    waveform = WaveSurfer.create({\\n        container,\\n        ...waveform_settings\\n    });\\n    if (subtitles && waveform) {\\n        if (subtitles_toggle) {\\n            add_subtitles_to_waveform(waveform, subtitles);\\n        }\\n        else {\\n            hide_subtitles();\\n        }\\n    }\\n    if (value?.url && waveform) {\\n        waveform.load(value?.url);\\n    }\\n    waveform?.on(\\"decode\\", (duration) => {\\n        audio_duration = duration;\\n        durationRef && (durationRef.textContent = format_time(duration));\\n    });\\n    waveform?.on(\\"timeupdate\\", (currentTime) => timeRef && (timeRef.textContent = format_time(currentTime)));\\n    waveform?.on(\\"ready\\", () => {\\n        if (!waveform_settings.autoplay) {\\n            waveform?.stop();\\n        }\\n        else {\\n            waveform?.play();\\n        }\\n    });\\n    waveform?.on(\\"finish\\", () => {\\n        if (loop) {\\n            waveform?.play();\\n        }\\n        else {\\n            playing = false;\\n            dispatch(\\"stop\\");\\n        }\\n    });\\n    waveform?.on(\\"pause\\", () => {\\n        playing = false;\\n        dispatch(\\"pause\\");\\n    });\\n    waveform?.on(\\"play\\", () => {\\n        playing = true;\\n        dispatch(\\"play\\");\\n    });\\n    waveform?.on(\\"load\\", () => {\\n        dispatch(\\"load\\");\\n    });\\n};\\n$: if (use_waveform && container !== void 0 && container !== null) {\\n    if (waveform !== void 0)\\n        waveform.destroy();\\n    container.innerHTML = \\"\\";\\n    create_waveform();\\n    playing = false;\\n}\\nconst handle_trim_audio = async (start, end) => {\\n    mode = \\"\\";\\n    const decodedData = waveform?.getDecodedData();\\n    if (decodedData)\\n        await process_audio(decodedData, start, end, waveform_settings.sampleRate).then(async (trimmedBlob) => {\\n            await dispatch_blob([trimmedBlob], \\"change\\");\\n            waveform?.destroy();\\n            container.innerHTML = \\"\\";\\n        });\\n    dispatch(\\"edit\\");\\n};\\nasync function load_audio(data) {\\n    stream_active = false;\\n    if (waveform_options.show_recording_waveform) {\\n        waveform?.load(data);\\n    }\\n    else if (audio_player) {\\n        audio_player.src = data;\\n    }\\n}\\n$: url && load_audio(url);\\n$: if (subtitles && waveform) {\\n    if (subtitles_toggle) {\\n        add_subtitles_to_waveform(waveform, subtitles);\\n    }\\n    else {\\n        hide_subtitles();\\n    }\\n}\\nfunction load_stream(value2) {\\n    if (!value2 || !value2.is_stream || !value2.url)\\n        return;\\n    if (Hls.isSupported() && !stream_active) {\\n        const hls = new Hls({\\n            maxBufferLength: 1,\\n            maxMaxBufferLength: 1,\\n            lowLatencyMode: true\\n        });\\n        hls.loadSource(value2.url);\\n        hls.attachMedia(audio_player);\\n        hls.on(Hls.Events.MANIFEST_PARSED, function () {\\n            if (waveform_settings.autoplay)\\n                audio_player.play();\\n        });\\n        hls.on(Hls.Events.ERROR, function (event, data) {\\n            console.error(\\"HLS error:\\", event, data);\\n            if (data.fatal) {\\n                switch (data.type) {\\n                    case Hls.ErrorTypes.NETWORK_ERROR:\\n                        console.error(\\"Fatal network error encountered, trying to recover\\");\\n                        hls.startLoad();\\n                        break;\\n                    case Hls.ErrorTypes.MEDIA_ERROR:\\n                        console.error(\\"Fatal media error encountered, trying to recover\\");\\n                        hls.recoverMediaError();\\n                        break;\\n                    default:\\n                        console.error(\\"Fatal error, cannot recover\\");\\n                        hls.destroy();\\n                        break;\\n                }\\n            }\\n        });\\n        stream_active = true;\\n    }\\n    else if (!stream_active) {\\n        audio_player.src = value2.url;\\n        if (waveform_settings.autoplay)\\n            audio_player.play();\\n        stream_active = true;\\n    }\\n}\\n$: if (audio_player && value?.is_stream) {\\n    load_stream(value);\\n}\\nonMount(() => {\\n    window.addEventListener(\\"keydown\\", (e) => {\\n        if (!waveform || show_volume_slider)\\n            return;\\n        if (e.key === \\"ArrowRight\\" && mode !== \\"edit\\") {\\n            skip_audio(waveform, 0.1);\\n        }\\n        else if (e.key === \\"ArrowLeft\\" && mode !== \\"edit\\") {\\n            skip_audio(waveform, -0.1);\\n        }\\n    });\\n});\\nasync function add_subtitles_to_waveform(wavesurfer, subtitle_data) {\\n    clear_subtitles();\\n    try {\\n        let subtitles2;\\n        if (Array.isArray(subtitle_data)) {\\n            subtitles2 = subtitle_data;\\n        }\\n        else {\\n            const response = await fetch(subtitle_data);\\n            const subtitle_content = await response.text();\\n            subtitles2 = parse_subtitles(subtitle_content);\\n        }\\n        if (subtitles2.length > 0) {\\n            let current_subtitle = \\"\\";\\n            if (subtitle_container) {\\n                subtitle_container.style.display = \\"\\";\\n                const audioProcessHandler = (time) => {\\n                    const subtitle = subtitles2.find((s) => time >= s.start && time <= s.end);\\n                    if (subtitle && subtitle.text !== current_subtitle) {\\n                        current_subtitle = subtitle.text;\\n                        subtitle_container.textContent = current_subtitle;\\n                    }\\n                    else if (!subtitle && current_subtitle !== \\"\\") {\\n                        current_subtitle = \\"\\";\\n                        subtitle_container.textContent = \\"\\";\\n                    }\\n                };\\n                wavesurfer.on(\\"audioprocess\\", audioProcessHandler);\\n                subtitle_event_handlers.push(() => {\\n                    wavesurfer.un(\\"audioprocess\\", audioProcessHandler);\\n                });\\n            }\\n        }\\n    }\\n    catch (error) {\\n    }\\n}\\nfunction hide_subtitles() {\\n    if (subtitle_container) {\\n        subtitle_container.style.display = \\"none\\";\\n    }\\n}\\nfunction clear_subtitles() {\\n    if (subtitle_container) {\\n        subtitle_container.textContent = \\"\\";\\n    }\\n    subtitle_event_handlers.forEach((handler) => handler());\\n    subtitle_event_handlers = [];\\n}\\nfunction parse_subtitles(subtitle_content) {\\n    const lines = subtitle_content.split(\\"\\\\n\\");\\n    const subtitles2 = [];\\n    for (let i = 0; i < lines.length; i++) {\\n        const line = lines[i].trim();\\n        if (line.includes(\\" --> \\")) {\\n            const [start_time, end_time] = line.split(\\" --> \\");\\n            const start = parse_time_to_seconds(start_time);\\n            const end = parse_time_to_seconds(end_time);\\n            let text = \\"\\";\\n            for (let j = i + 1; j < lines.length && lines[j].trim() !== \\"\\"; j++) {\\n                if (text)\\n                    text += \\" \\";\\n                text += lines[j].trim();\\n            }\\n            if (text) {\\n                subtitles2.push({ start, end, text });\\n            }\\n        }\\n    }\\n    return subtitles2;\\n}\\nfunction parse_time_to_seconds(time_str) {\\n    const parts = time_str.split(\\":\\");\\n    if (parts.length === 3) {\\n        const hours = parseInt(parts[0]);\\n        const minutes = parseInt(parts[1]);\\n        const seconds = parseFloat(parts[2]);\\n        return hours * 3600 + minutes * 60 + seconds;\\n    }\\n    return 0;\\n}\\n<\/script>\\n\\n<audio\\n\\tclass=\\"standard-player\\"\\n\\tclass:hidden={use_waveform}\\n\\tcontrols\\n\\tautoplay={waveform_settings.autoplay}\\n\\ton:load\\n\\tbind:this={audio_player}\\n\\ton:ended={() => dispatch(\\"stop\\")}\\n\\ton:play={() => dispatch(\\"play\\")}\\n\\tpreload=\\"metadata\\"\\n/>\\n{#if value === null}\\n\\t<Empty size=\\"small\\">\\n\\t\\t<Music />\\n\\t</Empty>\\n{:else if use_waveform}\\n\\t<div\\n\\t\\tclass=\\"component-wrapper\\"\\n\\t\\tdata-testid={label ? \\"waveform-\\" + label : \\"unlabelled-audio\\"}\\n\\t>\\n\\t\\t<div class=\\"waveform-container\\">\\n\\t\\t\\t<div\\n\\t\\t\\t\\tid=\\"waveform\\"\\n\\t\\t\\t\\tbind:this={container}\\n\\t\\t\\t\\tstyle:height={container ? null : \\"58px\\"}\\n\\t\\t\\t/>\\n\\t\\t</div>\\n\\n\\t\\t<div class=\\"timestamps\\">\\n\\t\\t\\t<time bind:this={timeRef} id=\\"time\\">0:00</time>\\n\\t\\t\\t<div>\\n\\t\\t\\t\\t{#if mode === \\"edit\\" && trimDuration > 0}\\n\\t\\t\\t\\t\\t<time id=\\"trim-duration\\">{format_time(trimDuration)}</time>\\n\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t<time bind:this={durationRef} id=\\"duration\\">0:00</time>\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\n\\t\\t<div\\n\\t\\t\\tbind:this={subtitle_container}\\n\\t\\t\\tclass=\\"subtitle-display\\"\\n\\t\\t\\tdata-testid=\\"subtitle-display\\"\\n\\t\\t></div>\\n\\n\\t\\t<WaveformControls\\n\\t\\t\\t{container}\\n\\t\\t\\t{waveform}\\n\\t\\t\\t{playing}\\n\\t\\t\\t{audio_duration}\\n\\t\\t\\t{i18n}\\n\\t\\t\\t{interactive}\\n\\t\\t\\t{handle_trim_audio}\\n\\t\\t\\tbind:mode\\n\\t\\t\\tbind:trimDuration\\n\\t\\t\\tbind:show_volume_slider\\n\\t\\t\\tbind:subtitles_toggle\\n\\t\\t\\tshow_redo={interactive}\\n\\t\\t\\t{handle_reset_value}\\n\\t\\t\\t{waveform_options}\\n\\t\\t\\t{trim_region_settings}\\n\\t\\t\\t{editable}\\n\\t\\t\\tshow_subtitles={subtitles !== null}\\n\\t\\t/>\\n\\t</div>\\n{/if}\\n\\n<style>\\n\\t.component-wrapper {\\n\\t\\tpadding: var(--size-3);\\n\\t\\twidth: 100%;\\n\\t}\\n\\n\\t:global(::part(wrapper)) {\\n\\t\\tmargin-bottom: var(--size-2);\\n\\t}\\n\\n\\t.timestamps {\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-content: space-between;\\n\\t\\talign-items: center;\\n\\t\\twidth: 100%;\\n\\t\\tpadding: var(--size-1) 0;\\n\\t}\\n\\n\\t#time {\\n\\t\\tcolor: var(--neutral-400);\\n\\t}\\n\\n\\t#duration {\\n\\t\\tcolor: var(--neutral-400);\\n\\t}\\n\\n\\t#trim-duration {\\n\\t\\tcolor: var(--color-accent);\\n\\t\\tmargin-right: var(--spacing-sm);\\n\\t}\\n\\t.waveform-container {\\n\\t\\tdisplay: flex;\\n\\t\\talign-items: center;\\n\\t\\tjustify-content: center;\\n\\t\\twidth: var(--size-full);\\n\\t}\\n\\n\\t#waveform {\\n\\t\\twidth: 100%;\\n\\t\\theight: 100%;\\n\\t\\tposition: relative;\\n\\t}\\n\\n\\t.standard-player {\\n\\t\\twidth: 100%;\\n\\t\\tpadding: var(--size-2);\\n\\t}\\n\\n\\t.subtitle-display {\\n\\t\\tcolor: var(--text-secondary);\\n\\t\\tfont-size: var(--text-lg);\\n\\t\\ttext-align: center;\\n\\t\\tmax-width: 600px;\\n\\t\\tline-height: 1.3;\\n\\t\\tmin-height: var(--size-4);\\n\\t\\tfont-family: var(--font-sans);\\n\\t\\tfont-weight: normal;\\n\\t\\tmargin: var(--size-2) auto;\\n\\t\\tpadding: var(--size-1) var(--size-2);\\n\\t\\tborder-radius: 2px;\\n\\t\\ttransition: opacity 0.2s ease-in-out;\\n\\t}\\n\\n\\t.hidden,\\n\\t.subtitle-display:empty {\\n\\t\\tdisplay: none;\\n\\t}</style>\\n"],"names":[],"mappings":"AA6UC,iCAAmB,CAClB,OAAO,CAAE,IAAI,QAAQ,CAAC,CACtB,KAAK,CAAE,IACR,CAEQ,eAAiB,CACxB,aAAa,CAAE,IAAI,QAAQ,CAC5B,CAEA,0BAAY,CACX,OAAO,CAAE,IAAI,CACb,eAAe,CAAE,aAAa,CAC9B,WAAW,CAAE,MAAM,CACnB,KAAK,CAAE,IAAI,CACX,OAAO,CAAE,IAAI,QAAQ,CAAC,CAAC,CACxB,CAEA,oBAAM,CACL,KAAK,CAAE,IAAI,aAAa,CACzB,CAEA,wBAAU,CACT,KAAK,CAAE,IAAI,aAAa,CACzB,CAEA,6BAAe,CACd,KAAK,CAAE,IAAI,cAAc,CAAC,CAC1B,YAAY,CAAE,IAAI,YAAY,CAC/B,CACA,kCAAoB,CACnB,OAAO,CAAE,IAAI,CACb,WAAW,CAAE,MAAM,CACnB,eAAe,CAAE,MAAM,CACvB,KAAK,CAAE,IAAI,WAAW,CACvB,CAEA,wBAAU,CACT,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACZ,QAAQ,CAAE,QACX,CAEA,+BAAiB,CAChB,KAAK,CAAE,IAAI,CACX,OAAO,CAAE,IAAI,QAAQ,CACtB,CAEA,gCAAkB,CACjB,KAAK,CAAE,IAAI,gBAAgB,CAAC,CAC5B,SAAS,CAAE,IAAI,SAAS,CAAC,CACzB,UAAU,CAAE,MAAM,CAClB,SAAS,CAAE,KAAK,CAChB,WAAW,CAAE,GAAG,CAChB,UAAU,CAAE,IAAI,QAAQ,CAAC,CACzB,WAAW,CAAE,IAAI,WAAW,CAAC,CAC7B,WAAW,CAAE,MAAM,CACnB,MAAM,CAAE,IAAI,QAAQ,CAAC,CAAC,IAAI,CAC1B,OAAO,CAAE,IAAI,QAAQ,CAAC,CAAC,IAAI,QAAQ,CAAC,CACpC,aAAa,CAAE,GAAG,CAClB,UAAU,CAAE,OAAO,CAAC,IAAI,CAAC,WAC1B,CAEA,sBAAO,CACP,gCAAiB,MAAO,CACvB,OAAO,CAAE,IACV"}'};function Gt(l){const t=l.split(`
`),e=[];for(let n=0;n<t.length;n++){const i=t[n].trim();if(i.includes(" --> ")){const[r,o]=i.split(" --> "),a=ot(r),c=ot(o);let d="";for(let s=n+1;s<t.length&&t[s].trim()!=="";s++)d&&(d+=" "),d+=t[s].trim();d&&e.push({start:a,end:c,text:d});}}return e}function ot(l){const t=l.split(":");if(t.length===3){const e=parseInt(t[0]),n=parseInt(t[1]),i=parseFloat(t[2]);return e*3600+n*60+i}return 0}const Yt=create_ssr_component((l,t,e,n)=>{let i,r,{value:o=null}=t,{subtitles:a=null}=t,{label:c}=t,{i18n:d}=t,{dispatch_blob:s=()=>Promise.resolve()}=t,{interactive:u=!1}=t,{editable:v=!0}=t,{trim_region_settings:h={}}=t,{waveform_settings:A}=t,{waveform_options:f}=t,{mode:p=""}=t,{loop:b}=t,{handle_reset_value:g=()=>{}}=t,_,m,C=!1,E,x,k,B,R=0,M=!1,K,W=!0,z=[];const j=createEventDispatcher(),F=()=>{m=J.create({container:_,...A}),a&&m&&W&&L(m,a),o?.url&&m&&m.load(o?.url),m?.on("decode",y=>{B=y;}),m?.on("timeupdate",y=>x),m?.on("ready",()=>{A.autoplay?m?.play():m?.stop();}),m?.on("finish",()=>{b?m?.play():(C=!1,j("stop"));}),m?.on("pause",()=>{C=!1,j("pause");}),m?.on("play",()=>{C=!0,j("play");}),m?.on("load",()=>{j("load");});},w$1=async(y,Q)=>{p="";const O=m?.getDecodedData();O&&await Ot(O,y,Q,A.sampleRate).then(async q=>{await s([q],"change"),m?.destroy(),_.innerHTML="";}),j("edit");};async function P(y){f.show_recording_waveform&&m?.load(y);}async function L(y,Q){D();try{let O;if(Array.isArray(Q))O=Q;else {const ct=await(await fetch(Q)).text();O=Gt(ct);}if(O.length>0){let q="";}}catch{}}function D(){z.forEach(y=>y()),z=[];}t.value===void 0&&e.value&&o!==void 0&&e.value(o),t.subtitles===void 0&&e.subtitles&&a!==void 0&&e.subtitles(a),t.label===void 0&&e.label&&c!==void 0&&e.label(c),t.i18n===void 0&&e.i18n&&d!==void 0&&e.i18n(d),t.dispatch_blob===void 0&&e.dispatch_blob&&s!==void 0&&e.dispatch_blob(s),t.interactive===void 0&&e.interactive&&u!==void 0&&e.interactive(u),t.editable===void 0&&e.editable&&v!==void 0&&e.editable(v),t.trim_region_settings===void 0&&e.trim_region_settings&&h!==void 0&&e.trim_region_settings(h),t.waveform_settings===void 0&&e.waveform_settings&&A!==void 0&&e.waveform_settings(A),t.waveform_options===void 0&&e.waveform_options&&f!==void 0&&e.waveform_options(f),t.mode===void 0&&e.mode&&p!==void 0&&e.mode(p),t.loop===void 0&&e.loop&&b!==void 0&&e.loop(b),t.handle_reset_value===void 0&&e.handle_reset_value&&g!==void 0&&e.handle_reset_value(g),l.css.add(Vt);let T,tt,dt=l.head;do T=!0,l.head=dt,i=o?.url,r=f.show_recording_waveform&&!o?.is_stream,r&&_!==void 0&&_!==null&&(m!==void 0&&m.destroy(),_.innerHTML="",F(),C=!1),i&&P(i),a&&m&&W&&L(m,a),tt=`<audio class="${["standard-player svelte-1vm10g7",r?"hidden":""].join(" ").trim()}" controls ${A.autoplay?"autoplay":""} preload="metadata"${add_attribute("this",K,0)}></audio> ${o===null?`${validate_component(_t,"Empty").$$render(l,{size:"small"},{},{default:()=>`${validate_component(ie,"Music").$$render(l,{},{},{})}`})}`:`${r?`<div class="component-wrapper svelte-1vm10g7"${add_attribute("data-testid",c?"waveform-"+c:"unlabelled-audio",0)}><div class="waveform-container svelte-1vm10g7"><div id="waveform" class="svelte-1vm10g7"${add_styles({height:"58px"})}${add_attribute("this",_,0)}></div></div> <div class="timestamps svelte-1vm10g7"><time id="time" class="svelte-1vm10g7"${add_attribute("this",x,0)} data-svelte-h="svelte-lp3mlp">0:00</time> <div>${p==="edit"&&R>0?`<time id="trim-duration" class="svelte-1vm10g7">${escape(w(R))}</time>`:""} <time id="duration" class="svelte-1vm10g7"${add_attribute("this",k,0)} data-svelte-h="svelte-1jd0owv">0:00</time></div></div> <div class="subtitle-display svelte-1vm10g7" data-testid="subtitle-display"${add_attribute("this",E,0)}></div> ${validate_component(Ut,"WaveformControls").$$render(l,{container:_,waveform:m,playing:C,audio_duration:B,i18n:d,interactive:u,handle_trim_audio:w$1,show_redo:u,handle_reset_value:g,waveform_options:f,trim_region_settings:h,editable:v,show_subtitles:a!==null,mode:p,trimDuration:R,show_volume_slider:M,subtitles_toggle:W},{mode:y=>{p=y,T=!1;},trimDuration:y=>{R=y,T=!1;},show_volume_slider:y=>{M=y,T=!1;},subtitles_toggle:y=>{W=y,T=!1;}},{})}</div>`:""}`}`;while(!T);return tt}),$t=Yt;

export { $t as $ };
//# sourceMappingURL=AudioPlayer-DvJHu-67.js.map
